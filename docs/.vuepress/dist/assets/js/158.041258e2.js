(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{761:function(a,t,n){"use strict";n.r(t);var e=n(27),s=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"js集成nabox指南"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#js集成nabox指南"}},[a._v("#")]),a._v(" JS集成Nabox指南")]),a._v(" "),t("h2",{attrs:{id:"简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[a._v("#")]),a._v(" 简介")]),a._v(" "),t("p",[a._v("该文档提供给Dapp接入Nabox钱包使用，Nabox提供支付、离线组装合约调用、查询钱包信息等接口能力。")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("安卓实例对象：NaboxPay\n已有方法：\n-naboxPay  （发起钱包支付）\n-getDefaultAddress （获取当前默认钱包地址）\n-getAddressBalance （获取钱包余额）\n-transferOffline（离线组装转账交易）\n-contractCallOffline（离线组装合约交易）\n-switchingUsers（APP底部唤起当前钱包列表）\n-authorization（APP底部唤起当前钱包列表,进行输入密码授权，返回keystore-加密私钥）\n\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('JS代码：\n/**\n * NaboxJSBridge方法必须在H5作为一个全局方法暴露出去\n * app处理完事物后会通过调用NaboxJSBridge方法的appPayResponse函数将处理后的数据传给H5\n * 所以在H5端要将NaboxJSBridge方法作为全局方法挂在window下面\n *\n * 返回值\t描述\n *  requestCode:\n *     ok\t成功\n *     notfound\t 未找到NaboxApp\n *     cancel\t支付过程中用户取消\n *     fail\t失败\n */\nvar NaboxJSBridge = {\n\t_callBack : null,\n\n\t/**\n\t * 返回callBack{\n\t *     requestCode:ok\n\t *     txHash:  当返回成功时，有txHash值\n\t *     payAddress: 支付人\n\t * }\n\t * @param params\n\t * @param callBack\n\t */\n\tappRequest : function(method, params,callBack) {\n\t\tvar paramStr =  JSON.stringify(params);\n\t\tif (NaboxPay == undefined) {\n\t\t\tcallBack({"request_code":"notfound"})\n\t\t}\n\t\tthis._callBack = callBack;\n\t\tif ("naboxPay" == method){\n\t\t\tNaboxPay.naboxPay(paramStr);\n\t\t}\n\t\tif ("transferOffline" == method) {\n\t\t\tNaboxPay.transferOffline(paramStr);\n\t\t}\n\t\tif ("contractCallOffline" == method) {\n\t\t\tNaboxPay.contractCallOffline(paramStr);\n\t\t}\n\t\tif ("switchingUsers" == method){\n\t\t\tNaboxPay.switchingUsers();\n\t\t}\n        if ("getDefaultAddress" == method){\n            NaboxPay.getDefaultAddress(); \n        }\n        if ("getAddressBalance" == method){\n            NaboxPay.getAddressBalance(paramStr); \n        }\n        if("authorization" == method){\n            NaboxPay.authorization();\n        }\n\t},\n\t/**\n\t * 返回callBack{\n\t *     requestCode:ok\n\t *     address: Nabox当前默认钱包地址\n\t * }\n\t * @param params\n\t * @param callBack\n\t */\n\tgetDefaultAddress : function(callBack) {\n\t\tif (NaboxPay == undefined) {\n\t\t\tcallBack({"request_code":"notfound"})\n\t\t}\n\t\tthis._callBack = callBack;\n\t\tNaboxPay.getDefaultAddress();\n\t},\n\n\tappPayResponse : function(data) {\n\t\tif (this._callBack != undefined) {\n\t\t\tthis._callBack(data)\n\t\t}\n\t},\n\n\tinvoke : function(method,params,callBack) {\n\t\tif (method == undefined) {\n\t\t\treturn ;\n\t\t}\n\t\tif ("appPayResponse" == method) {\n\t\t\tthis.appPayResponse(params);\n\t\t} else {\n            this.appRequest(method,params, callBack);\n        }\n\t}\n\n};\n')])])]),t("h2",{attrs:{id:"接口说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接口说明"}},[a._v("#")]),a._v(" 接口说明")]),a._v(" "),t("h3",{attrs:{id:"naboxpay"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#naboxpay"}},[a._v("#")]),a._v(" naboxPay")]),a._v(" "),t("p",[a._v("唤起Nabox钱包向商户发起转账,由Nabox直接广播交易")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('NaboxJSBridge.invoke(\n    "naboxPay",//调用方法\n    //业务数据\n    {\n        "shopId":"15669589240005", //商户id，由nabox分配，对应商户地址\n        "payAmount":10000,//转账金额,单位Na\n        "remark":"{\'orderNo\':\'asdasdasdasd\'}"//转账备注\n    },\n    function(data){\n    });\n')])])]),t("h3",{attrs:{id:"接口返回格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接口返回格式"}},[a._v("#")]),a._v(" 接口返回格式")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("正常返回\n//example\n{      \n     requestCode:ok\n     txHash:  当返回成功时，有txHash值\n     payAddress: 支付人\n}\n异常返回\n//example\n{\n     requestCode:fail\n}\n")])])]),t("h3",{attrs:{id:"getdefaultaddress"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#getdefaultaddress"}},[a._v("#")]),a._v(" getDefaultAddress")]),a._v(" "),t("p",[a._v("获取Nabox钱包当前默认钱包地址")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('NaboxJSBridge.invoke(\n    "getDefaultAddress",//调用方法\n    //业务数据\n    null,\n    function(data){\n    });\n')])])]),t("h3",{attrs:{id:"接口返回格式-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接口返回格式-2"}},[a._v("#")]),a._v(" 接口返回格式")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("正常返回\n//example\n{      \n     requestCode:ok\n     address:  //nabox钱包当前默认钱包地址\n}\n异常返回\n//example\n{\n     requestCode:fail\n}\n")])])]),t("h3",{attrs:{id:"getaddressbalance"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#getaddressbalance"}},[a._v("#")]),a._v(" getAddressBalance")]),a._v(" "),t("p",[a._v("获取钱包余额信息，默认查询NULS资产")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('NaboxJSBridge.invoke(\n    "getAddressBalance",//调用方法\n    //业务数据\n    {\n       address: //查询钱包地址，必填\n       contractAddress:// 合约地址，如果需要查询TOKEN资产填写资产合约地址，非必填\n    },\n    function(data){\n    }); //回调函数\n')])])]),t("h3",{attrs:{id:"接口返回格式-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接口返回格式-3"}},[a._v("#")]),a._v(" 接口返回格式")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("正常返回\n//example\n{      \n     requestCode:ok\n     address:  //钱包地址\n     symbol：  //资产单位缩写如NULS、CB\n     decimals: //支持的小数位数\n     totalBalance://资产总额，返回最小单位number，例如地址有1NULS，NULS的decimals=8则该参数返回100000000\n     balance://可用资产,同上\n}\n异常返回\n//example\n{\n     requestCode:fail\n}\n")])])]),t("h3",{attrs:{id:"transferoffline"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#transferoffline"}},[a._v("#")]),a._v(" transferOffline")]),a._v(" "),t("p",[a._v("离线组装转账并进行签名")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('NaboxJSBridge.invoke(\n    "transferOffline",//调用方法\n    //业务数据\n    {\n        "shopId":"15669589240005", //商户id，由nabox分配，对应商户地址\n        "payAmount":10000,//转账金额转，单位是Na(1NULS=100000000Na)\n        "remark":"{\'orderNo\':\'asdasdasdasd\'}"//转账备注\n    },\n    function(data){\n    });\n')])])]),t("h3",{attrs:{id:"接口返回格式-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接口返回格式-4"}},[a._v("#")]),a._v(" 接口返回格式")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('正常返回\n//example\n{      \n     requestCode:ok\n     txHex: "",// 交易完整序列化16进制字符串数据，可以由游戏自行广播\n     txHash:""//交易的hash值\n}\n异常返回\n//example\n{\n     requestCode:fail\n}\n')])])]),t("h3",{attrs:{id:"contractcalloffline"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#contractcalloffline"}},[a._v("#")]),a._v(" contractCallOffline")]),a._v(" "),t("p",[a._v("离线组装调用合约方法并进行签名")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('NaboxJSBridge.invoke(\n    "contractCallOffline",//调用方法\n    //业务数据\n    {\n        "shopId":"15669589240005", //商户id，由nabox分配，对应合约地址，必填\n        "value":10000,//转给合约的金额，单位NULS，没有填0\n        "methodName":"buy",//合约方法名称，必填\n        "methodDesc":"",//合约方法描述，若合约内方法没有重载，则此参数可以为空\n        "args":[1,"tNULSeBaMvw2QtYPhLjgCFuBQefpXDczAdd49C"], //参数列表，必填\n        "argsType":["Long","String"],// 参数类型列表，必填\n        "sender":"tNULSeBaMvw2QtYPhLjgCFuBQefpXDczAdd49C"//调用人地址，，必填\n    },\n    function(data){\n    });\n')])])]),t("h3",{attrs:{id:"接口返回格式-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接口返回格式-5"}},[a._v("#")]),a._v(" 接口返回格式")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('正常返回\n//example\n{      \n     requestCode:ok\n     txHex: "",// 合约交易完整序列化16进制字符串数据，可以由游戏自行广播\n     txHash:""//合约交易的hash值\n}\n异常返回\n//example\n{\n     requestCode:fail\n}\n')])])]),t("h3",{attrs:{id:"switchingusers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#switchingusers"}},[a._v("#")]),a._v(" switchingUsers")]),a._v(" "),t("p",[a._v("唤起APP当前钱包列表进行选择")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('NaboxJSBridge.invoke(\n    "switchingUsers",//调用方法\n    //业务数据\n    null,\n    function(data){\n    });\n')])])]),t("h3",{attrs:{id:"接口返回格式-6"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接口返回格式-6"}},[a._v("#")]),a._v(" 接口返回格式")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('正常返回\n//example\n{      \n     requestCode:ok,\n     address: "" //选中钱包地址\n    \n}\n异常返回\n//example\n{\n     requestCode:fail\n}\n')])])]),t("h3",{attrs:{id:"authorization"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#authorization"}},[a._v("#")]),a._v(" authorization")]),a._v(" "),t("p",[a._v("唤起APP当前钱包列表进行选择")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('NaboxJSBridge.invoke(\n    "authorization",//调用方法\n    //业务数据\n    null,\n    function(data){\n    });\n')])])]),t("h3",{attrs:{id:"接口返回格式-7"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接口返回格式-7"}},[a._v("#")]),a._v(" 接口返回格式")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("正常返回\n//example\n{      \n     requestCode:ok,\n     address:, //选中地址\n     alias:,   //钱包名称\n     encryptedPrivateKey://加密后的私钥\n     pubKey:  //公钥\n}\n异常返回\n//example\n{\n     requestCode:fail\n}\n")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);