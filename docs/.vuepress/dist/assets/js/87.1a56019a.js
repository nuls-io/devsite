(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{907:function(t,e,a){"use strict";a.r(e);var s=a(0),r=Object(s.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[t._v("[TOC]")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("p",[t._v("Usually, when a hash is computed within Satellite-chain, it is computed twice. Most of the time "),a("a",{attrs:{href:"http://en.wikipedia.org/wiki/SHA-2",target:"_blank",rel:"noopener noreferrer"}},[t._v("SHA-256"),a("OutboundLink")],1),t._v(" hashes are used, however "),a("a",{attrs:{href:"http://en.wikipedia.org/wiki/RIPEMD",target:"_blank",rel:"noopener noreferrer"}},[t._v("RIPEMD-160"),a("OutboundLink")],1),t._v(" is also used when a shorter hash is desirable (for example when creating a NULS address).")]),t._v(" "),a("p",[t._v('Example of double-SHA-256 encoding of string "nuls":')]),t._v(" "),t._m(3),a("p",[t._v("For NULS addresses (RIPEMD-160) this would give:")]),t._v(" "),t._m(4),t._m(5),t._v(" "),t._m(6),t._v(" "),a("p",[t._v("If, when forming a row in the tree (other than the root of the tree), it would have an odd number of elements, the final double-hash is duplicated to ensure that the row has an even number of hashes.")]),t._v(" "),a("p",[t._v("First form the bottom row of the tree with the ordered double-SHA-256 hashes of the byte streams of the transactions in the block.")]),t._v(" "),a("p",[t._v("Then the row above it consists of half that number of hashes. Each entry is the double-SHA-256 of the 64-byte concatenation of the corresponding two hashes below it in the tree.")]),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),a("p",[t._v("where")]),t._v(" "),t._m(10),t._m(11),t._v(" "),t._m(12),t._v(" "),a("p",[t._v("A NULS address is in fact the hash of a ECDSA public key, computed this way:")]),t._v(" "),t._m(13),a("p",[t._v("非nuls体系的地址格式如下：")]),t._v(" "),a("p",[t._v("例如：比特币地址，在地址之前追加两个字节的chainId，之后跟随比特币的原始地址，地址解析方式根据链配置决定")]),t._v(" "),t._m(14),t._m(15),t._v(" "),a("p",[t._v("Satellite-chain uses custom messaging for communication over the TCP protocol.")]),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),a("p",[t._v("The message consists of a 24-byte header and payload.")]),t._v(" "),t._m(18),t._m(19),t._v(" "),a("p",[t._v("The main role of the header is to indicate the payload length, verify data integrity, and solve TCP sticky packets.")]),t._v(" "),t._m(20),t._v(" "),a("p",[t._v("[^MagicNumber]: MagicNumber In addition to being validated as a valid check, it is also used for the division of the main network and test.")]),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),a("p",[t._v("Variable-length integers that can be encoded based on the values expressed to save space.")]),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),a("p",[t._v("A variable-length byte stream consisting of a variable-length buffer. The string is encoded in UTF8.")]),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),a("p",[t._v("Variable-length buffer, consistent with the VarString implementation.")]),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),a("p",[t._v("6-byte number.")]),t._v(" "),t._m(29),t._v(" "),a("p",[t._v("When a network address is needed somewhere, this structure is used.")]),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),a("p",[t._v("交易特性")]),t._v(" "),t._m(35),a("p",[t._v("coinData结构")]),t._v(" "),t._m(36),a("p",[t._v("CoinForm结构[40]")]),t._v(" "),t._m(37),a("p",[t._v("CoinTo结构[44]")]),t._v(" "),t._m(38),a("p",[t._v("手续费")]),t._v(" "),t._m(39),t._m(40),t._v(" "),a("p",[t._v("参考各个模块")])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"protocol-design"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#protocol-design","aria-hidden":"true"}},[this._v("#")]),this._v(" Protocol design")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"common-standards"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#common-standards","aria-hidden":"true"}},[this._v("#")]),this._v(" Common standards")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"hashes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hashes","aria-hidden":"true"}},[this._v("#")]),this._v(" Hashes")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("nuls\n96cc377699e3289875d6d40da436110d692e823eb8900ae13a7107cb36c7310c (first round of sha-256)\n7e0590c37ab91aacabdac1bedec9ff6acd609215d019e489cc0a5dcf38b7b055(second round of sha-256)\n\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("nuls\n96cc377699e3289875d6d40da436110d692e823eb8900ae13a7107cb36c7310c (first round is sha-256)\nf8e8d1c6f1511c356effad8b986b0aa439a88c44(with ripemd-160)\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"merkle-trees"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#merkle-trees","aria-hidden":"true"}},[this._v("#")]),this._v(" Merkle Trees")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Merkle trees are binary trees of hashes. Merkle trees in NULS use a "),e("strong",[this._v("double")]),this._v(" SHA-256, the SHA-256 hash of the SHA-256 hash of something.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("This procedure repeats recursively until we reach a row consisting of just a single double-hash. This is the "),e("strong",[this._v("Merkle root")]),this._v(" of the tree.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("For example, imagine a block with three transactions "),e("em",[this._v("a")]),this._v(", "),e("em",[this._v("b")]),this._v(" and "),e("em",[this._v("c")]),this._v(". The Merkle tree is:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("d1 = dhash(a)\nd2 = dhash(b)\nd3 = dhash(c)\nd4 = dhash(c)            # a, b, c are 3. that's an odd number, so we take the c twice\n\nd5 = dhash(d1 concat d2)\nd6 = dhash(d3 concat d4)\n\nd7 = dhash(d5 concat d6)\n\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("dhash(a) = sha256(sha256(a))\n\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("em",[this._v("d7")]),this._v(" is the Merkle root of the 3 transactions in this block.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"addresses"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#addresses","aria-hidden":"true"}},[this._v("#")]),this._v(" Addresses")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("ChainId = 2 byte,The ID of the chain in which the account belongs.\naddressType = 1 byte,The type of the account,Example: 1 general account, 2 contract account……\npkh = 20 byte , RIPEMD-160(SHA-256(public key))\nxor = 1 byte, XOR(chainId+addressType+pkh)\naddress = Base58Encode(chainId+addressType+pkh+xor)\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("address = Base58Encode(chainId+原始地址长度+原始地址+xor)\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"message-structre"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#message-structre","aria-hidden":"true"}},[this._v("#")]),this._v(" Message Structre")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Digital binary stream using little endian。")]),this._v(" "),e("li",[this._v("Floating point numbers convert to integers and transfer by little endian")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"message"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#message","aria-hidden":"true"}},[this._v("#")]),this._v(" Message")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("*---------------------------------------------------------------*\n|       Header(24 Byte)         |            Payload            |\n*---------------------------------------------------------------*\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"message-header"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#message-header","aria-hidden":"true"}},[this._v("#")]),this._v(" message header")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",[t._v("Len")]),t._v(" "),a("th",[t._v("Fields")]),t._v(" "),a("th",[t._v("Data Type")]),t._v(" "),a("th",[t._v("Remark")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("4")]),t._v(" "),a("td",[t._v("MagicNumber")]),t._v(" "),a("td",[t._v("uint32")]),t._v(" "),a("td",[t._v("Packet valid flag")])]),t._v(" "),a("tr",[a("td",[t._v("12")]),t._v(" "),a("td",[t._v("command")]),t._v(" "),a("td",[t._v("char[12]")]),t._v(" "),a("td",[t._v("ASCII string identifying the packet content, NULL padded")])]),t._v(" "),a("tr",[a("td",[t._v("4")]),t._v(" "),a("td",[t._v("PayloadLength")]),t._v(" "),a("td",[t._v("uint32")]),t._v(" "),a("td",[t._v("Length of payload in number of bytes")])]),t._v(" "),a("tr",[a("td",[t._v("4")]),t._v(" "),a("td",[t._v("checksum")]),t._v(" "),a("td",[t._v("uint32")]),t._v(" "),a("td",[t._v("First 4 bytes of  sha256(sha256(payload))")])]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"common-structre"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#common-structre","aria-hidden":"true"}},[this._v("#")]),this._v(" Common Structre")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"varint"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#varint","aria-hidden":"true"}},[this._v("#")]),this._v(" VarInt")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",[t._v("Value")]),t._v(" "),a("th",[t._v("Len")]),t._v(" "),a("th",[t._v("Structure")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("< 0xfd")]),t._v(" "),a("td",[t._v("1")]),t._v(" "),a("td",[t._v("uint8")])]),t._v(" "),a("tr",[a("td",[t._v("<= 0xffff")]),t._v(" "),a("td",[t._v("3")]),t._v(" "),a("td",[t._v("0xfd + uint16")])]),t._v(" "),a("tr",[a("td",[t._v("<= 0xffffffff")]),t._v(" "),a("td",[t._v("5")]),t._v(" "),a("td",[t._v("0xfe + uint32")])]),t._v(" "),a("tr",[a("td",[t._v("> 0xffffffff")]),t._v(" "),a("td",[t._v("9")]),t._v(" "),a("td",[t._v("0xff + uint64")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"varstring"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#varstring","aria-hidden":"true"}},[this._v("#")]),this._v(" VarString")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",[t._v("Len")]),t._v(" "),a("th",[t._v("Fields")]),t._v(" "),a("th",[t._v("Data Type")]),t._v(" "),a("th",[t._v("Remark")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("?")]),t._v(" "),a("td",[t._v("length")]),t._v(" "),a("td",[t._v("VarInt")]),t._v(" "),a("td",[t._v("Length of the string")])]),t._v(" "),a("tr",[a("td",[t._v("length")]),t._v(" "),a("td",[t._v("value")]),t._v(" "),a("td",[t._v("uint8[length]")]),t._v(" "),a("td",[t._v("The string itself")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"varbyte"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#varbyte","aria-hidden":"true"}},[this._v("#")]),this._v(" VarByte")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",[t._v("Len")]),t._v(" "),a("th",[t._v("Fields")]),t._v(" "),a("th",[t._v("Data Type")]),t._v(" "),a("th",[t._v("Remark")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("?")]),t._v(" "),a("td",[t._v("length")]),t._v(" "),a("td",[t._v("VarInt")]),t._v(" "),a("td",[t._v("Length of payload in number of bytes")])]),t._v(" "),a("tr",[a("td",[t._v("length")]),t._v(" "),a("td",[t._v("data")]),t._v(" "),a("td",[t._v("byte[length]")]),t._v(" "),a("td",[t._v("payload")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"int48"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#int48","aria-hidden":"true"}},[this._v("#")]),this._v(" Int48")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"network-address"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#network-address","aria-hidden":"true"}},[this._v("#")]),this._v(" Network address")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",[t._v("Len")]),t._v(" "),a("th",[t._v("Fields")]),t._v(" "),a("th",[t._v("Data type")]),t._v(" "),a("th",[t._v("Remark")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("16")]),t._v(" "),a("td",[t._v("IPv6/4")]),t._v(" "),a("td",[t._v("char[16]")]),t._v(" "),a("td",[t._v("IPv6/4 address. Network byte order.  The IPv4 address is written into the message as a 16 byte")])]),t._v(" "),a("tr",[a("td",[t._v("2")]),t._v(" "),a("td",[t._v("port1")]),t._v(" "),a("td",[t._v("uint16")]),t._v(" "),a("td",[t._v("port number, network byte order")])]),t._v(" "),a("tr",[a("td",[t._v("2")]),t._v(" "),a("td",[t._v("port2")]),t._v(" "),a("td",[t._v("uint16")]),t._v(" "),a("td",[t._v("port number,for cross-chain module")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"block-headers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#block-headers","aria-hidden":"true"}},[this._v("#")]),this._v(" Block_headers")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",[t._v("Len")]),t._v(" "),a("th",[t._v("Fields")]),t._v(" "),a("th",[t._v("Data Type")]),t._v(" "),a("th",[t._v("Remark")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("4")]),t._v(" "),a("td",[t._v("version")]),t._v(" "),a("td",[t._v("uint32")]),t._v(" "),a("td",[t._v("version bumber")])]),t._v(" "),a("tr",[a("td",[t._v("32")]),t._v(" "),a("td",[t._v("preHash")]),t._v(" "),a("td",[t._v("byte[32]")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("32")]),t._v(" "),a("td",[t._v("merkleRoot")]),t._v(" "),a("td",[t._v("byte[32]")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("？")]),t._v(" "),a("td",[t._v("stateRoot")]),t._v(" "),a("td",[t._v("VarByte")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("4")]),t._v(" "),a("td",[t._v("time")]),t._v(" "),a("td",[t._v("uint32")]),t._v(" "),a("td",[t._v("second")])]),t._v(" "),a("tr",[a("td",[t._v("2")]),t._v(" "),a("td",[t._v("txCount")]),t._v(" "),a("td",[t._v("uint16")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("？")]),t._v(" "),a("td",[t._v("extends")]),t._v(" "),a("td",[t._v("VarByte")]),t._v(" "),a("td",[t._v("本字段内容不同的链可设置不同的约束")])]),t._v(" "),a("tr",[a("td",[t._v("?")]),t._v(" "),a("td",[t._v("signature")]),t._v(" "),a("td",[t._v("Varbyte")]),t._v(" "),a("td")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"transactions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#transactions","aria-hidden":"true"}},[this._v("#")]),this._v(" Transactions")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",[t._v("Len")]),t._v(" "),a("th",[t._v("Fields")]),t._v(" "),a("th",[t._v("Data Type")]),t._v(" "),a("th",[t._v("Remark")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("2")]),t._v(" "),a("td",[t._v("type")]),t._v(" "),a("td",[t._v("uint16")]),t._v(" "),a("td",[t._v("交易类型")])]),t._v(" "),a("tr",[a("td",[t._v("4")]),t._v(" "),a("td",[t._v("time")]),t._v(" "),a("td",[t._v("uint32")]),t._v(" "),a("td",[t._v("时间，精确到秒")])]),t._v(" "),a("tr",[a("td",[t._v("？")]),t._v(" "),a("td",[t._v("txData")]),t._v(" "),a("td",[t._v("VarByte")]),t._v(" "),a("td",[t._v("业务数据")])]),t._v(" "),a("tr",[a("td",[t._v("？")]),t._v(" "),a("td",[t._v("coinData")]),t._v(" "),a("td",[t._v("VarByte")]),t._v(" "),a("td",[t._v("资产数据")])]),t._v(" "),a("tr",[a("td",[t._v("？")]),t._v(" "),a("td",[t._v("remark")]),t._v(" "),a("td",[t._v("VarString")]),t._v(" "),a("td",[t._v("备注")])]),t._v(" "),a("tr",[a("td",[t._v("？")]),t._v(" "),a("td",[t._v("sig")]),t._v(" "),a("td",[t._v("VarByte")]),t._v(" "),a("td",[t._v("只包含签名，不包含pubkey")])]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td"),t._v(" "),a("td"),t._v(" "),a("td")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("多账户转出\n多账户转入\n多资产转账\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("froms://List<CoinForm>格式，\ntos://List<CoinTo>格式\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("address:  //byte[24] 账户地址\nassetsChainId://uint16 资产发行链的id\nassetsId: //uint16 资产id\namount：  //uint128，转出数量\nnonce  ： //byte[8] 交易顺序号，前一笔交易的hash的前8个字节\nlocked ： //byte 是否是锁定状态(locktime:-1),1代表锁定，0代表非锁定\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("address:  //byte[24],目标地址\nassetsChainId://uint16 资产发行链的id\nassetsId: //uint16 资产id\namount :  //uint128，转账金额\nlockTime：//uint32,解锁高度或解锁时间，-1为永久锁定\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("forms-tos剩余的部分就是手续费（模型中支持多种资产缴纳手续费，约束条件由经济模型设计决定）\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"message-types"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#message-types","aria-hidden":"true"}},[this._v("#")]),this._v(" Message Types")])}],!1,null,null,null);r.options.__file="generalProtocol.md";e.default=r.exports}}]);