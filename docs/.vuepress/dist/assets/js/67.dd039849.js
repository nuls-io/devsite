(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{316:function(e,t,n){e.exports=n.p+"assets/img/clip_image002.425eb96f.jpg"},929:function(e,t,n){"use strict";n.r(t);var a=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"build-chain"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-chain","aria-hidden":"true"}},[e._v("#")]),e._v(" Build Chain")]),e._v(" "),a("h2",{attrs:{id:"development-environment-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#development-environment-setup","aria-hidden":"true"}},[e._v("#")]),e._v(" Development environment setup")]),e._v(" "),a("p",[e._v("NULS2.0 is an open and non-restricted language underlying platform for blockchain. This paper only refers to the core business modules of blockchain to write the Java environment building process.")]),e._v(" "),a("p",[e._v("1 Environment to prepare")]),e._v(" "),a("ul",[a("li",[e._v("install the JDK")]),e._v(" "),a("li",[e._v("install Maven")]),e._v(" "),a("li",[e._v("install the IntelliJ IDEA development tools")]),e._v(" "),a("li",[e._v("install git")])]),e._v(" "),a("p",[e._v("2 Clone source code")]),e._v(" "),a("p",[e._v("git clone "),a("a",{attrs:{href:"mailto:git@github.com"}},[e._v("git@github.com")]),e._v(":nuls-io/nuls_2.0.git")]),e._v(" "),a("p",[e._v("3 IDEA imports all maven projects in nuls_2.0")]),e._v(" "),a("p",[e._v("4 Build your own maven project")]),e._v(" "),a("p",[e._v("5 Run all the modules that need to be started")]),e._v(" "),a("h2",{attrs:{id:"using-nuls2-0-core-module-to-build-the-basic-chain"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-nuls2-0-core-module-to-build-the-basic-chain","aria-hidden":"true"}},[e._v("#")]),e._v(" Using NULS2.0 core module to build the basic chain")]),e._v(" "),a("p",[e._v("NULS is a global open source blockchain underlying infrastructure. Making the blockchain simpler is the mission of NULS. This article will describe how to use the NULS core module to quickly build a basic blockchain.")]),e._v(" "),a("p",[e._v("NULS does not limit the attributes of the blockchain. Using the NULS underlying layer, you can build a private chain, a coalition chain, and a public chain. You can build a coin blockchain or build a currency-free blockchain.")]),e._v(" "),a("h3",{attrs:{id:"_1-understanding-the-microservice-architecture-of-nuls-2-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-understanding-the-microservice-architecture-of-nuls-2-0","aria-hidden":"true"}},[e._v("#")]),e._v(" 1 Understanding the Microservice Architecture of NULS 2.0")]),e._v(" "),a("p",[a("img",{attrs:{src:n(316),alt:"img"}})]),e._v(" "),a("p",[e._v("NULS 2.0 is built on a micro-service architecture with built-in blockchain core business modules, including accounts, transactions, blocks, consensus, etc. When we build a basic blockchain based on NULS 2.0, we will be based on the NULS 2.0 blockchain. The basic functional layer is extended.")]),e._v(" "),a("p",[e._v('Because NULS2.0 already contains the basic functions of the blockchain, when developing its own blockchain, it only needs to organize its own unique business functions, abstract the corresponding protocol, and develop the function into a module inserted into NULS2. 0 can be. For example: Suppose we want to implement a "Notepad Chain". On the basis of NULS, we need to design a "Notepad" business transaction, such as a note transaction, delete a note transaction, our business module needs to do, in this The business logic code is added to the module, and the verification, processing, and rollback functions of the two transactions are implemented, and then the transaction information is reported to the transaction management module to process the transaction related logic.')]),e._v(" "),a("p",[e._v("Understand how to expand the blockchain function, you can design your own functional modules according to the following steps.")]),e._v(" "),a("h3",{attrs:{id:"_2-modify-basic-configuration-information"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-modify-basic-configuration-information","aria-hidden":"true"}},[e._v("#")]),e._v(" 2 Modify basic configuration information")]),e._v(" "),a("p",[e._v("To run a blockchain, you need a lot of basic configuration. Each blockchain must have its own configuration parameters. When building a new blockchain, the first thing is to configure its own operating parameters.")]),e._v(" "),a("p",[e._v("The startup script of NULS2.0 supports the way to send configuration files to start the blockchain. The usage is as follows: sh start.sh -c modules.ncf")]),e._v(" "),a("p",[e._v("The modules.ncf can be configured with parameters of each module. The developer can modify the running parameters according to the situation of the own chain. The specific operating parameters are preset as follows:")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("section")]),e._v(" "),a("th",[e._v("param")]),e._v(" "),a("th",[e._v("name")]),e._v(" "),a("th",[e._v("remark")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("common")]),e._v(" "),a("td",[e._v("chain.id")]),e._v(" "),a("td",[e._v("This chain id")]),e._v(" "),a("td",[e._v("Uint16, NULS main network is 1, test network is 2")])]),e._v(" "),a("tr",[a("td",[e._v("common")]),e._v(" "),a("td",[e._v("address.prefix")]),e._v(" "),a("td",[e._v("address prefix")]),e._v(" "),a("td",[e._v("size letters + numbers, 2-5 characters")])]),e._v(" "),a("tr",[a("td",[e._v("common")]),e._v(" "),a("td",[e._v("data.root.dir")]),e._v(" "),a("td",[e._v("Data Storage Path")]),e._v(" "),a("td",[e._v("For all modules to be stored in the same directory, special paths can be configured in any module if needed")])]),e._v(" "),a("tr",[a("td",[e._v("common")]),e._v(" "),a("td",[e._v("encoding")]),e._v(" "),a("td",[e._v("Encoding method")]),e._v(" "),a("td",[e._v("Default UTF-8, not recommended to modify")])]),e._v(" "),a("tr",[a("td",[e._v("common")]),e._v(" "),a("td",[e._v("asset.id")]),e._v(" "),a("td",[e._v("Original Master Asset Code")]),e._v(" "),a("td",[e._v("NULS 1")])]),e._v(" "),a("tr",[a("td",[e._v("common")]),e._v(" "),a("td",[e._v("log.root.dir")]),e._v(" "),a("td",[e._v("Log Root")]),e._v(" "),a("td",[e._v("Log files for each module")])]),e._v(" "),a("tr",[a("td",[e._v("common")]),e._v(" "),a("td",[e._v("log.level")]),e._v(" "),a("td",[e._v("log level")]),e._v(" "),a("td",[e._v("log print level debug/info/warn/error.")])]),e._v(" "),a("tr",[a("td",[e._v("block")]),e._v(" "),a("td",[e._v("data.folder")]),e._v(" "),a("td",[e._v("data subfolder")]),e._v(" "),a("td",[e._v("used to store block module data, placed under #{data.root.dir}")])]),e._v(" "),a("tr",[a("td",[e._v("Block")]),e._v(" "),a("td",[e._v("block.max.size")]),e._v(" "),a("td",[e._v("Block size max")]),e._v(" "),a("td",[e._v("Block size limit, avoid too large blocks too high to participate in the threshold")])]),e._v(" "),a("tr",[a("td",[e._v("block")]),e._v(" "),a("td",[e._v("block.interval")]),e._v(" "),a("td",[e._v("Block Interval")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("block")]),e._v(" "),a("td",[e._v("max.rollback")]),e._v(" "),a("td",[e._v("Maximum rollback quantity")]),e._v(" "),a("td",[e._v("When this number is exceeded, the system will stop rolling back to avoid major problems")])]),e._v(" "),a("tr",[a("td",[e._v("block")]),e._v(" "),a("td",[e._v("header.extend.max.size")]),e._v(" "),a("td",[e._v("Extended Maximum size")]),e._v(" "),a("td",[e._v("Size Limits for Extended Fields in Block Headers")])]),e._v(" "),a("tr",[a("td",[e._v("block")]),e._v(" "),a("td",[e._v("genesis.block.json.path")]),e._v(" "),a("td",[e._v("Genesis Block Description File")]),e._v(" "),a("td",[e._v("Genesis Block Description File")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("data.folder")]),e._v(" "),a("td",[e._v("data subfolder")]),e._v(" "),a("td",[e._v("used to store consensus module data, placed under #{data.root.dir}")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("packing.interval")]),e._v(" "),a("td",[e._v("Blocking interval")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("inflation.token.count")]),e._v(" "),a("td",[e._v("Annual Issues")]),e._v(" "),a("td",[e._v("The number of additional issuances used to reward nodes via coinbase transactions")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("block.max.size")]),e._v(" "),a("td",[e._v("Block size")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("seed.addresses")]),e._v(" "),a("td",[e._v("Consensus Seed Address")]),e._v(" "),a("td",[e._v('Multiple Addresses Separated by ","')])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("packing.address.pwd")]),e._v(" "),a("td",[e._v("Address Password")]),e._v(" "),a("td",[e._v("Password for the packaged address")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("agent.deposit.min")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("Minimum Margin Quantity When Creating Nodes")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("agent.deposit.max")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("Maximum Margin Quantity When Creating Nodes")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("commission.rate.max")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("The maximum commission rate, no more than 100")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("commission.rate.min")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("Commission Ratio Minimum")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("deposit.min")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("Single commission minimum amount")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("agent.total.deposit.max")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("Maximum amount of nodes to accept delegates")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("packing.token.min")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("When the node's delegate reaches this value, it starts to block")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("red.punish.lock.time")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("Red Card Lock Time")])]),e._v(" "),a("tr",[a("td",[e._v("consensus")]),e._v(" "),a("td",[e._v("agent.stop.lock.time")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("Stop Node Lock Time")])]),e._v(" "),a("tr",[a("td",[e._v("network")]),e._v(" "),a("td",[e._v("data.folder")]),e._v(" "),a("td",[e._v("data subfolder")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("network")]),e._v(" "),a("td",[e._v("seeds")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v('Seed nodes, separated by ","')])]),e._v(" "),a("tr",[a("td",[e._v("network")]),e._v(" "),a("td",[e._v("magic.number")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("Magic numbers for isolating other networks")])]),e._v(" "),a("tr",[a("td",[e._v("network")]),e._v(" "),a("td",[e._v("port")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("port")])]),e._v(" "),a("tr",[a("td",[e._v("network")]),e._v(" "),a("td",[e._v("nuls.seed")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("NULS2.0 seed node configuration when cross-chaining is required")])]),e._v(" "),a("tr",[a("td",[e._v("network")]),e._v(" "),a("td",[e._v("cross.listener.port")]),e._v(" "),a("td"),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("network")]),e._v(" "),a("td",[e._v("nuls.magic.number")]),e._v(" "),a("td"),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("contract")]),e._v(" "),a("td",[e._v("nrc20.file.path")]),e._v(" "),a("td"),e._v(" "),a("td",[e._v("NRC20 protocol description json file path")])]),e._v(" "),a("tr",[a("td",[e._v("tx")]),e._v(" "),a("td",[e._v("data.folder")]),e._v(" "),a("td",[e._v("data subfolder")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("Ledger")]),e._v(" "),a("td",[e._v("data.folder")]),e._v(" "),a("td",[e._v("data subfolder")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("api")]),e._v(" "),a("td",[e._v("mongodb.ip")]),e._v(" "),a("td",[e._v("mongodb address")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("api")]),e._v(" "),a("td",[e._v("mongodb.port")]),e._v(" "),a("td",[e._v("mongodbport")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("api")]),e._v(" "),a("td",[e._v("rpc.listener.ips")]),e._v(" "),a("td",[e._v("rpc listener ip")]),e._v(" "),a("td",[e._v("can configure multiple")])]),e._v(" "),a("tr",[a("td",[e._v("api")]),e._v(" "),a("td",[e._v("rpc.port")]),e._v(" "),a("td",[e._v("rpc listening port")]),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("api")]),e._v(" "),a("td",[e._v("req.allow.per.s")]),e._v(" "),a("td",[e._v("Concurrency Limits")]),e._v(" "),a("td")])])]),e._v(" "),a("p",[e._v("The table lists the most common configuration items, not all. After the alpha version and the beta version, the team will sort out the list of available configurations for all NULS 2.0 for the majority of blockchain developers to configure their own areas. Blockchain.")]),e._v(" "),a("blockquote",[a("p",[e._v("[^Note]: Since the NULS2.0-alpha version does not complete the docking of Nulstar, the individual parameters may be modified later, which is subject to the final online version.")])]),e._v(" "),a("p",[e._v("### 3 Packaging and booting")]),e._v(" "),a("p",[e._v("After the configuration items of the chain have been modified, you can directly refer to Part 4 of this document: [Packing and Booting] (#Packing and Booting)")]),e._v(" "),a("h2",{attrs:{id:"building-a-blockchain-containing-business-modules"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#building-a-blockchain-containing-business-modules","aria-hidden":"true"}},[e._v("#")]),e._v(" Building a blockchain containing business modules")]),e._v(" "),a("p",[e._v("After building your own blockchain using the modular infrastructure of NULS 2.0, you need to develop a business module and integrate it into the base chain to achieve your own unique business. The following sections can provide some guidance on how to develop a business module of your own.")]),e._v(" "),a("h3",{attrs:{id:"_1-business-module-description"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-business-module-description","aria-hidden":"true"}},[e._v("#")]),e._v(" 1 Business Module Description")]),e._v(" "),a("h4",{attrs:{id:"_1-1-what-is-a-business-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-what-is-a-business-module","aria-hidden":"true"}},[e._v("#")]),e._v(" 1.1 What is a business module?")]),e._v(" "),a("p",[e._v("A functional module with a custom service based on the bottom of the blockchain. The module can be a microservice module that can communicate with other modules according to the NULS2.0 module protocol, or can be an independent, only through the RPC interface. External application for basic module communication.")]),e._v(" "),a("p",[e._v("The service module does not add or modify the protocol, only extends the basic protocol, and implements its own business through the extension of the protocol.")]),e._v(" "),a("h4",{attrs:{id:"_1-2-how-to-extend-the-agreement"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-how-to-extend-the-agreement","aria-hidden":"true"}},[e._v("#")]),e._v(" 1.2 How to extend the agreement")]),e._v(" "),a("p",[e._v("NULS provides two ways to extend the protocol. The two methods are similar, as follows:")]),e._v(" "),a("ul",[a("li",[e._v("Expand by remark field of transfer transaction")])]),e._v(" "),a("p",[e._v("Serialize the data you want to wind up into a byte array and place it in the remark field of the transfer transaction. Place your own magic number at the very beginning of the byte array to distinguish other transfer transactions. Monitor the transfer transactions in all blocks in your own application, and parse and process the business when you find remarks that start with your own magic number.")]),e._v(" "),a("ul",[a("li",[e._v("Expanded through established business expansion transactions")])]),e._v(" "),a("p",[e._v("NULS provides a specific transaction type for business expansion. The transaction can freely fill in txData, serialize the data to be chained, into a byte array, and put it into the txData of the transfer transaction. Place your own magic numbers in front of the byte array to distinguish between transactions that are not of interest. Monitor the business extension transactions in all blocks in your own application, and find txData with its own module number for parsing and business processing.")]),e._v(" "),a("p",[a("strong",[e._v("Example:")])]),e._v(" "),a("p",[e._v("Suppose now that an application is to be implemented, the application's business is: private notepad, the core business is that each address can store the encrypted note text on the blockchain, and can be decrypted and viewed at any time.")]),e._v(" "),a("p",[e._v("1 functional design")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("1. Add a note: Encrypt the note content and send the encrypted data to the chain;\n\n2. Parse the block data extraction note data: obtain the data of the application from the blockchain, and store the data to the local database;\n\n3. Decrypt view: Get records from the database, decrypt, display decryption results\n\n4. Delete the note: the app is deleted locally, and the data in the blockchain is not deleted.\n")])])]),a("p",[e._v("2 blockchain interaction")]),e._v(" "),a("p",[e._v("The above function design needs to interact with the blockchain is 1 new note and 2 parsing block data extraction note data.")]),e._v(" "),a("ul",[a("li",[e._v("The implementation of the first function is as follows:")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('First design the data format as follows\n\n{\n\n  Address:"", / / ​​note owner\n\n  Time:"", / / ​​note time point\n\n  Content:""//Encrypted note content\n\n}\n\nAccording to the data format, assemble the uplink data: address+time+content;\n\nDetermine the magic number of the app, assuming 12345678.\n\nThen assemble the DataTransaction (business extension transaction), set the value of txData to the spliced ​​byte array of 12345678, address, time, content. After paying a sufficient fee, sign the transaction and broadcast the transaction to the network.\n')])])]),a("ul",[a("li",[e._v("The implementation of the second function is as follows:")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Listen to all the blocks, find the 'business expansion transaction' to analyze, first parse to txData, first determine whether it has started 12345678,\nIf not, discard the transaction. If yes, continue to parse and determine if address+time+content was successfully obtained (to avoid data confusion caused by repeated magic numbers)\nIf the data is successfully parsed, store the data in a local database\n")])])]),a("p",[e._v("3 other business implementation")]),e._v(" "),a("p",[e._v("All services that do not need to interact with the blockchain can be designed through conventional application methods, so that a simple blockchain application is completed.")]),e._v(" "),a("blockquote",[a("p",[e._v("Developing applications using business extensions is a simple, fast and efficient way. NULS's support for business expansion is full and friendly, and it is hoped that more and more people will join the NULS ecosystem.")])]),e._v(" "),a("h3",{attrs:{id:"_2-demand-analysis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-demand-analysis","aria-hidden":"true"}},[e._v("#")]),e._v(" 2 Demand Analysis")]),e._v(" "),a("p",[e._v("Before you start developing modules, you must first identify a few issues:")]),e._v(" "),a("ul",[a("li",[e._v("What kind of functions do you need?")]),e._v(" "),a("li",[e._v("Is it necessary to add modules to achieve business needs? Can it be implemented in an easier way with existing features?")]),e._v(" "),a("li",[e._v("In which way is this module implemented?")]),e._v(" "),a("li",[e._v("Ways to extend the basic protocol: no longer add new protocols, expand your own business based on the basic agreement to meet your own needs.")]),e._v(" "),a("li",[e._v("Add a new protocol method: you need to add a new protocol, the business logic corresponding to the new protocol, in order to meet your own needs.")]),e._v(" "),a("li",[e._v("Modify the basic chain: The above two can not achieve their own business, you need to modify the basic module to meet your own needs.")])]),e._v(" "),a("h3",{attrs:{id:"_3-module-design"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-module-design","aria-hidden":"true"}},[e._v("#")]),e._v(" 3 Module Design")]),e._v(" "),a("p",[e._v("After you have identified your needs, you need to design your own modules. The module design depends on the overall design of NULS2.0. When designing its own module, it can focus on designing its own business, and other parts are implemented according to the basic module.")]),e._v(" "),a("p",[e._v("So how do you design your own business? for example:")]),e._v(" "),a("h4",{attrs:{id:"_3-1-ways-to-extend-the-basic-protocol"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-ways-to-extend-the-basic-protocol","aria-hidden":"true"}},[e._v("#")]),e._v(" 3.1 Ways to extend the basic protocol:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Case I: Our need is just to store some key information in the chain without complicated logic processing.\nFor example, we just want to store a contract related information in the chain, and can be queried at any time in the chain. At this time, we actually don't have to develop any modules. Nuls2.0 provides a transaction (DataTransaction) for storing data. The user only needs to convert the data into a byte array and store it in the txData field or remark field of the transaction. After the broadcast transaction to the whole network, the data can be successful. Winding up. Through the query trading interface provided by nuls2.0, you can query the relevant data of transactions and transactions at any time. Such other business functions can be designed and developed in the form of general software.\n\nCase II: Our needs need to store some key information on the chain and require simple logic processing.\nIn general, we recommend users to consider using smart contracts to develop DAPP, such as simple quiz games.\n")])])]),a("h4",{attrs:{id:"_3-2-how-to-add-a-new-agreement"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-how-to-add-a-new-agreement","aria-hidden":"true"}},[e._v("#")]),e._v(" 3.2 How to add a new agreement")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("If our requirements are complex and have related logic processes, we must do so by adding new protocols.\nHere we use the nuls poc consensus mechanism to give examples\nFunctional design: first organize the functions to be provided according to the requirements, and design new protocols according to the functions.\nThe business functions of the nuls poc consensus mechanism are:\n1. The user can create a consensus node by sending a request for the consensus node transaction, and lock the 2-20 million nuls. After the node meets the block condition, it can participate in the package and get the block reward.\n2. Users can participate in the consensus by sending at least 2000 nuls by sending a transaction that joins the consignment consensus, and get a block reward.\n3. The user can unlock the nuls locked by the consignment consensus by sending a transaction that cancels the entrusted consensus. After canceling the entrustment, the reward will not be continued.\n4. The user can send the transaction to let the node exit the consensus. After exiting, all the nuls on the node will be unlocked, and the node will no longer participate in the block.\n\nProtocol design: including protocol serialization and deserialization, transaction validator, transaction confirmation processor, transaction rollback processor, need to pay attention to avoid conflicts with the underlying protocol.\n4 protocols of the poc consensus mechanism: create consensus node transactions, commission transactions, cancel commission transactions, node exit consensus transactions\nTransaction Verifier: Each protocol will have an associated business verifier. When the node receives a new transaction or receives a new block, it will execute the verifier, and the failed transaction will be rejected.\nFor example, create a consensus node:\n1) The account that creates the node cannot create the consensus node multiple times;\n2) The margin is between 20,000 and 200,000 nuls;\n3) Whether the account has a red card record;\nStorage design: Stores business data in the protocol as formatted data for providing user functions.\nFor example, after creating a consensus node, the bottom layer stores the transaction data of the created node, and also stores related information of the node, such as the name of the consensus node, the current total amount of the consensus node, the credit value of the consensus node, etc.\n\nInterface design: RPC interface that needs to be provided externally\nFor example: query consensus node information, query consensus delegation information, etc.\n\nOther: Other internal processing mechanisms are implemented within the module itself according to different business needs. For example, the core processing of the poc consensus is in the ConsensusProcess.\n")])])]),a("h4",{attrs:{id:"_3-3-how-to-modify-the-base-chain"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-how-to-modify-the-base-chain","aria-hidden":"true"}},[e._v("#")]),e._v(" 3.3 How to modify the base chain")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("This method differs from the second method only in that it involves the modification of the basic chain. When modifying, you need to fully understand the services of the basic chain. After adapting your own services, you need to perform sufficient tests.\nThe modified method can be the way to replace the module: get the source code of the base chain module, modify it, and then release its own module to replace the original base module.\n")])])]),a("h3",{attrs:{id:"_4-module-implementation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-module-implementation","aria-hidden":"true"}},[e._v("#")]),e._v(" 4 Module implementation")]),e._v(" "),a("p",[e._v("First of all, the module consists of the following two parts. For the first part, the official version only provides the Java version of lib, and will continue to provide C++, Go and other language versions.")]),e._v(" "),a("p",[e._v("1 nuls-service-base-lib (baselib):")]),e._v(" "),a("p",[e._v("Common, all modules have the same functionality, providing basic communication, interface format, general code, etc. If the developer uses a language that does not provide baselib, you need to develop baselib yourself.")]),e._v(" "),a("p",[e._v("2 module-self:")]),e._v(" "),a("p",[e._v("The module itself needs to make its own implementation in the following ways:")]),e._v(" "),a("ul",[a("li",[e._v("Module management")])]),e._v(" "),a("p",[e._v("1. Start and stop the script: Provide the module's start and stop scripts in your own module, and ensure that any timing to execute the start and stop scripts will not have a significant impact on the business and data.")]),e._v(" "),a("p",[e._v("2. After the startup, the state management is firstly connected to the Nulstar (microservice manager) through the startup parameters, reporting the information of the module itself, obtaining the information of the dependent module, attempting to communicate with the dependent module, and completing the initialization of the module during this period. And change the state of your own module. After all the modules that are dependent are ready, start running the business of your own module.")]),e._v(" "),a("p",[e._v("3. After the dependent module status changes, the module should be processed according to the changed status.")]),e._v(" "),a("ul",[a("li",[e._v("Agreement related")])]),e._v(" "),a("p",[e._v("After a new transaction is created in the module, it is necessary to register its own protocol information with the transaction management module each time the module is started, and report the transaction verifier, confirmation processor, and rollback processor information.")]),e._v(" "),a("ul",[a("li",[e._v("Network message")])]),e._v(" "),a("p",[e._v("After the new module adds the network protocol, the network module needs to subscribe to the message of the network that it needs, so that the network module can send the message to the message processor of the module after receiving the message.")]),e._v(" "),a("ul",[a("li",[e._v("data storage")])]),e._v(" "),a("p",[e._v("NULS2.0 does not impose any restrictions on data storage, and can freely design and implement its own data storage function according to its own business needs.")]),e._v(" "),a("ul",[a("li",[e._v("Function realization")])]),e._v(" "),a("p",[e._v("If there are other functions that need to be implemented, you can develop according to your own habits or industry standard specifications. NULS2.0 does not impose any restrictions.")]),e._v(" "),a("ul",[a("li",[e._v("Function interface")])]),e._v(" "),a("p",[e._v("According to the product design, the implementation of the function interface, NULS2.0 will provide a unified interface call mode, and will support access methods such as JSONRPC2.0/restFul/CMD/WebSocket.")]),e._v(" "),a("ul",[a("li",[e._v("Logging")])]),e._v(" "),a("p",[e._v("In principle, NULS2.0 does not limit the logging mode of the expansion module. However, it is recommended to collect all the logs into one root directory by referring to the basic chain, which is convenient for backup and viewing.")]),e._v(" "),a("p",[e._v("Summary: The extension of the business module can refer to the underlying infrastructure chain. All modules are equal in the architecture of NULS2.0. If you are unclear, you can learn or copy the solution of the basic module by looking at the basic module code. The follow-up will continue to open up some of the project's extension modules, so that developers can learn from it, making the development module more and more simple.")]),e._v(" "),a("h3",{attrs:{id:"_5-defining-your-own-agreement"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-defining-your-own-agreement","aria-hidden":"true"}},[e._v("#")]),e._v(" 5 Defining your own agreement")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("The principle of the design agreement: data is streamlined, do not add redundant data in the protocol, and reduce the data size as much as possible.")])]),e._v(" "),a("li",[a("p",[e._v("Network messages: message formats, serialization methods, deserialization methods, computational data size methods, subscription interfaces, and logical processors.")])]),e._v(" "),a("li",[a("p",[e._v("Trading: transaction format, serialization method, deserialization method, calculation data size method, validator, processor, rollback processor, etc.")])])]),e._v(" "),a("h3",{attrs:{id:"_6-debugging"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-debugging","aria-hidden":"true"}},[e._v("#")]),e._v(" 6 Debugging")]),e._v(" "),a("p",[e._v("After the design and development work is completed, it is inevitable to test. This part does not include the unit test part of the development process. Only the methods and precautions of the integration test are explained here.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("1 Start all modules through NULSTAR to see if their new modules can be started and stopped normally.\n\n2 Test whether the transaction of the newly added module can be sent, and whether various interfaces can be called normally;\n\n3 The main network test, whether the block can be packaged normally, whether the new transaction can be confirmed or rolled back;\n\n4 check the transaction verification logic is rigorous, do not appear security loopholes;\n\n5 Test whether the business of its own module is correct and complete.\n")])])]),a("p",[e._v("After all the tests are completed, you can enter the packaging and startup phase.")]),e._v(" "),a("h2",{attrs:{id:"packing-and-launching"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#packing-and-launching","aria-hidden":"true"}},[e._v("#")]),e._v(" Packing and launching")]),e._v(" "),a("h3",{attrs:{id:"_1-packaging"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-packaging","aria-hidden":"true"}},[e._v("#")]),e._v(" 1 Packaging")]),e._v(" "),a("p",[e._v("NULS2.0 has its own code packaging mechanism. Because it involves different languages ​​and different development environments, we have developed a unique packaging specification. Please ensure that the new development module follows the packaging specification and has provided the dependencies, scripts, etc. required by the specification. Components and testing the packaging process")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Cd /home/nuls2/nuls_2.0\n./package.sh -m\n")])])]),a("p",[e._v("After confirming that there is no problem, complete the development of the blockchain, you can hand over the packaged package to the relevant parties for public testing. After testing for a period of time, no problem can be found, you can formally assemble the blockchain network and start your own business. .")]),e._v(" "),a("h3",{attrs:{id:"_2-startup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-startup","aria-hidden":"true"}},[e._v("#")]),e._v(" 2 Startup")]),e._v(" "),a("ul",[a("li",[e._v("Compiled successfully will generate the following path file")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/home/nuls2/nuls_2.0/RELEASE/bin\n")])])]),a("ul",[a("li",[e._v("Execute the following command to start all modules in batches with one click")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("Cd /home/nuls2/nuls_2.0/RELEASE/bin\n./start.sh -c ./moudle.json (specify the moudle.json configuration file to start)\n")])])]),a("ul",[a("li",[e._v("linux command jps view all module processes:")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" ./start.sh --jre $JAVA_HOME --managerurl 192.168.1.124:8887/ws\n ```\n\n- View module startup status\n\n")])])]),a("p",[e._v("./checkstatus.sh")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("\n- Stop Engineering Module:\n")])])]),a("p",[e._v("Kill process number (the process number corresponds to the process of the mykernel module displayed by jps)")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code")])])])}],o=n(0),s=Object(o.a)({},function(){this.$createElement;this._self._c;return this._m(0)},a,!1,null,null,null);s.options.__file="howToUseNulsBuildChain.md";t.default=s.exports}}]);