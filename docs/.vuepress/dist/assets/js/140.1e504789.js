(window.webpackJsonp=window.webpackJsonp||[]).push([[140],{928:function(e,t,a){"use strict";a.r(t);var n=a(0),r=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"ways-of-creating-random-numbers-for-nuls"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ways-of-creating-random-numbers-for-nuls","aria-hidden":"true"}},[e._v("#")]),e._v(" Ways of creating random numbers for NULS")]),e._v(" "),a("blockquote",[a("p",[e._v("References:")]),e._v(" "),a("p",[e._v("[Solidity Pitfalls: Random Number Generation for Ethereum]\n(https://www.sitepoint.com/solidity-pitfalls-random-number-generation-for-ethereum/)")]),e._v(" "),a("p",[e._v("[Predicting Random Numbers in Ethereum Smart Contracts]\n(https://blog.positive.com/predicting-random-numbers-in-ethereum-smart-contracts-e5358c6b8620)")])]),e._v(" "),a("h3",{attrs:{id:"_1-linear-congruential-generator-lcg-algorithm-to-generate-pseudorandom-numbers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-linear-congruential-generator-lcg-algorithm-to-generate-pseudorandom-numbers","aria-hidden":"true"}},[e._v("#")]),e._v(" 1. "),a("code",[e._v("Linear Congruential Generator (LCG)")]),e._v(": algorithm to generate pseudorandom numbers")]),e._v(" "),a("p",[e._v("The NULS smart contract SDK provides a way to create random numbers. It takes the current block's miner address, contract address, contract invoker address, and current block’s timestamp as random factors, and uses the algorithm "),a("code",[e._v("linear congruential generator (LCG)")]),e._v(" to generate pseudorandom numbers")]),e._v(" "),a("p",[e._v("Invoking like this:")]),e._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[e._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("nuls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("contract"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("sdk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Utils"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("pseudoRandom")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("/**\n * add a random factor\n */")]),e._v("\nio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("nuls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("contract"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("sdk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Utils"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("pseudoRandom")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("long")]),e._v(" seed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),a("p",[e._v("--")]),e._v(" "),a("h3",{attrs:{id:"_2-using-the-blockhash-of-the-future-block"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-using-the-blockhash-of-the-future-block","aria-hidden":"true"}},[e._v("#")]),e._v(" 2. Using the "),a("code",[e._v("BlockHash")]),e._v(" of the future block")]),e._v(" "),a("p",[e._v("Taking lottery as an example, it needs to invoke contract transactions twice - close the lottery and pick the winner.")]),e._v(" "),a("p",[e._v("Once the lottery is closed, record the current block height H1 and generate a number N. Pick the winner when the height of the future block reaches "),a("code",[e._v("H1+N")]),e._v("。")]),e._v(" "),a("p",[e._v("When picking the winner, add up the recorded block height H1 and block number in interval (0~80] (to be determined) to the block height H2, and take the "),a("code",[e._v("BlockHash")]),e._v(" of the block H2 as a random seed.")]),e._v(" "),a("p",[e._v("ETH cannot use this way for the following reasons:\n"),a("img",{attrs:{src:"https://cdn-images-1.medium.com/max/1600/1*eyNTfWTkmM-3YuMca-1H0A.png",alt:""}})]),e._v(" "),a("p",[e._v("--")]),e._v(" "),a("h3",{attrs:{id:"_3-random-seeds-limited-to-participants"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-random-seeds-limited-to-participants","aria-hidden":"true"}},[e._v("#")]),e._v(" 3. Random seeds limited to participants")]),e._v(" "),a("p",[e._v("In the case of lottery, we need more arbitrary data for picking our winner. When we determine the winner, we can use the addresses of the players that have entered our lottery smart contract as random factors to generate random numbers.")]),e._v(" "),a("p",[e._v("--")]),e._v(" "),a("h3",{attrs:{id:"_4-commit-reveal"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-commit-reveal","aria-hidden":"true"}},[e._v("#")]),e._v(" 4. commit-reveal")]),e._v(" "),a("p",[e._v("Also take the lottery as an example.")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("The contract sets aside awards for the random number.")])]),e._v(" "),a("li",[a("p",[e._v("Each user generates own secret random number N.")])]),e._v(" "),a("li",[a("p",[e._v("Users can hash their N and address to generate the hash value of their secret random numbers: String hash = sha3(N + Msg.sender()).")])])]),e._v(" "),a("p",[e._v("Note: step 2 and 3 should be performed locally, for instance, the user submits N to the lottery application, which performs the hash operation.")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("Users submit their hash to the smart contract.")])]),e._v(" "),a("li",[a("p",[e._v("Submission is open until the number of blocks reaches a certain value, or until enough participants join.")])]),e._v(" "),a("li",[a("p",[e._v("Once the submission is closed, it’s time to pick the winner.")])]),e._v(" "),a("li",[a("p",[e._v("Each user submits their random number N to the smart contract.")])]),e._v(" "),a("li",[a("p",[e._v("The contract verifies sha3 (N + Msg.sender()) to match the original submission.")])]),e._v(" "),a("li",[a("p",[e._v("If the user fails to submit a valid N in time, his deposit will be forfeited.")])]),e._v(" "),a("li",[a("p",[e._v("Perform XOR operation on all-verified N to get random numbers.")])]),e._v(" "),a("li",[a("p",[e._v("These numbers are used to determine the winners --\x3e (N % numUsers).")])])])])}],!1,null,null,null);r.options.__file="randomImplementations.md";t.default=r.exports}}]);