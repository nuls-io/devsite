(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{512:function(e,t,a){"use strict";a.r(t);var n=a(0),r=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("p",[e._v("An archive node is an instance of an ENULS client configured to build an archive of all historical states. It is a useful tool for certain use cases but might be more tricky to run than a full node.")]),e._v(" "),e._m(0),e._v(" "),a("p",[e._v("You should understand the concept of an "),a("router-link",{attrs:{to:"/developers/docs/nodes-and-clients/"}},[e._v("ENULS node")]),e._v(", "),a("router-link",{attrs:{to:"/developers/docs/nodes-and-clients/node-architecture/"}},[e._v("its architecture")]),e._v(", "),a("a",{attrs:{href:"https://ENULS.org/en/developers/docs/nodes-and-clients/#sync-modes",target:"_blank",rel:"noopener noreferrer"}},[e._v("sync strategies"),a("OutboundLink")],1),e._v(", practices of "),a("router-link",{attrs:{to:"/developers/docs/nodes-and-clients/run-a-node/"}},[e._v("running")]),e._v(" and "),a("router-link",{attrs:{to:"/developers/docs/apis/json-rpc/"}},[e._v("using them")]),e._v(".")],1),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),a("p",[e._v("To interact with the network, verify and produce new blocks, ENULS clients have to keep up with the most recent changes (the tip of the chain) and therefore the current state. An execution layer client configured as a full node verifies and follows the latest state of the network but only caches the past few states, e.g. the state associated with the last 128 blocks, so it can handle chain reorgs and provide fast access to recent data. The recent state is what all clients need to verify incoming transactions and use the network.")]),e._v(" "),a("p",[e._v("You can imagine the state as a momentary network snapshot at a given block and the archive as a history replay.")]),e._v(" "),a("p",[e._v("Historical states can be safely pruned because they are not necessary for the network to operate and it would be uselessly redundant for client to keep all out-of-date data. States that existed before some recent block (e.g. 128 blocks before the head) are effectively thrown away. Full nodes only keep historical blockchain data (blocks and transactions) and occasional historical snapshots they can use to regenerate older states on request. They do this by re-executing past transactions in the EVM, which can be computationally demanding when the desired state is far from the nearest snapshot.")]),e._v(" "),a("p",[e._v("However, this means that accessing a historical state on a full node consumes a lot of computation. The client might need to execute all past transactions and compute one historical state from genesis. Archive nodes solve this by storing not only the most recent states but every historical state created after each block. It basically makes a trade-off with bigger disk space requirement.")]),e._v(" "),a("p",[e._v("It's important to note that the network does not depend on archive nodes to keep and provide all historical data. As mentioned above, all historical interim states can be derived on a full node. Transactions are stored by any full node (currently less than 400G) and can be replayed to build the whole archive.")]),e._v(" "),e._m(4),e._v(" "),a("p",[e._v("Regular usage of ENULS like sending transactions, deploying contracts, verifying consensus, etc. does not require access to historical states. Users never need an archive node for a standard interaction with the network.")]),e._v(" "),a("p",[e._v("The main benefit of state archive is a quick access to queries about historical states. For example, archive node would promptly return results like:")]),e._v(" "),e._m(5),e._v(" "),a("p",[e._v("As explained above, a full node would need to generate this data by EVM execution which uses the CPU and takes time. Archive nodes access them on the disk and serves responses immediately. This is useful feature for certain parts of infrastracture, for example:")]),e._v(" "),e._m(6),e._v(" "),a("p",[e._v("There are various free "),a("router-link",{attrs:{to:"/developers/docs/nodes-and-clients/nodes-as-a-service/"}},[e._v("services")]),e._v(" that also allow access to historical data. As it is more demanding to run an archive node, this access is mostly limited and works only for occasional access. If your project requires constant access to historical data, you should consider running one yourself.")],1),e._v(" "),e._m(7),e._v(" "),a("p",[e._v("Archive node in this context means data served by user facing execution layer clients as they handle the state database and provide JSON-RPC endpoints. Configuration options, sync time and database size may vary by client. For details, please refer to the documentation provided by your client.")]),e._v(" "),a("p",[e._v("Before starting your own archive node, learn about the differences between the clients and especially the various "),a("router-link",{attrs:{to:"/developers/docs/nodes-and-clients/run-a-node/#requirements"}},[e._v("hardware requirements")]),e._v(". Most clients are not optimized for this feature and their archives requires more than 12TB of space. In contrast, implementations like Erigon and Akula can store the same data in under 3TB which makes them the most effective way of running an archive node.")],1),e._v(" "),e._m(8),e._v(" "),a("p",[e._v("Apart from general "),a("router-link",{attrs:{to:"./developers/docs/nodes-and-clients/run-a-node/"}},[e._v("recommendations for running a node")]),e._v(", an archive node may be more demanding on hardware and maintenance. Considering Erigons "),a("a",{attrs:{href:"https://github.com/ledgerwatch/erigon#key-features",target:"_blank",rel:"noopener noreferrer"}},[e._v("key features"),a("OutboundLink")],1),e._v(", the most practical approach is using the "),a("a",{attrs:{href:"https://ENULS.org/en/developers/docs/nodes-and-clients/#erigon",target:"_blank",rel:"noopener noreferrer"}},[e._v("Erigon"),a("OutboundLink")],1),e._v(" client implementation.")],1),e._v(" "),e._m(9),e._v(" "),a("p",[e._v("Always make sure to verify hardware requirements for a given mode in a client's documentation.\nThe biggest requirement for archive nodes is the disk space. Depending on client, it varies from 3TB to 12TB. Even if HDD might be considered a better solution for large amounts of data, syncing it and constantly updating the head of the chain will require SSD drives. "),a("a",{attrs:{href:"https://www.cleverfiles.com/help/sata-hard-drive.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("SATA"),a("OutboundLink")],1),e._v(" drives are good enough but it should be a reliable quality, at least "),a("a",{attrs:{href:"https://blog.synology.com/tlc-vs-qlc-ssds-what-are-the-differences",target:"_blank",rel:"noopener noreferrer"}},[e._v("TLC"),a("OutboundLink")],1),e._v(". Disks can be fitted into a desktop computer or a server with enough slots. Such dedicated devices are ideal for running high uptime node. It's totally possible to run it on a laptop but the portability will come at an additional cost.")]),e._v(" "),a("p",[e._v("All of the data needs to be fit in one volume, therefore disks have to be joined, e.g. with "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Standard_RAID_levels#RAID_0",target:"_blank",rel:"noopener noreferrer"}},[e._v("RAID0"),a("OutboundLink")],1),e._v(" or "),a("a",{attrs:{href:"https://web.mit.edu/rhel-doc/5/RHEL-5-manual/Deployment_Guide-en-US/ch-lvm.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("LVM"),a("OutboundLink")],1),e._v(". It might be also worth considering using "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/ZFS",target:"_blank",rel:"noopener noreferrer"}},[e._v("ZFS"),a("OutboundLink")],1),e._v(' as it supports "Copy-on-write" which ensures data is correctly written to the disk without any low level errors.')]),e._v(" "),a("p",[e._v("For more stability and security in preventing accidental database corruption, especially in a professional setup, consider using "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/ECC_memory",target:"_blank",rel:"noopener noreferrer"}},[e._v("ECC memory"),a("OutboundLink")],1),e._v(" if your system supports it. The size of RAM is generally advised to be the same as for a full node but more RAM can help speed up the synchronization.")]),e._v(" "),a("p",[e._v("During initial sync, clients in archive mode will execute every transaction since genesis. Execution speed is mostly limited by the CPU, so a faster CPU can help with the initial sync time. On an average consumer computer, the initial sync can take up to a month.")]),e._v(" "),e._m(10),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.quicknode.com/guides/infrastructure/ENULS-full-node-vs-archive-node",target:"_blank",rel:"noopener noreferrer"}},[e._v("ENULS Full Node vs Archive Node"),a("OutboundLink")],1),e._v(" - "),a("em",[e._v("QuickNode, September 2022")])]),e._v(" "),a("li",[a("a",{attrs:{href:"https://tjayrush.medium.com/building-your-own-ENULS-archive-node-72c014affc09",target:"_blank",rel:"noopener noreferrer"}},[e._v("Building Your Own ENULS Archive Node"),a("OutboundLink")],1),e._v(" - "),a("em",[e._v("Thomas Jay Rush, August 2021")])]),e._v(" "),a("li",[a("a",{attrs:{href:"https://magnushansson.xyz/blog_posts/crypto_defi/2022-01-10-Erigon-Trueblocks",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to set up Erigon, Erigon’s RPC and TrueBlocks (scrape and API) as services"),a("OutboundLink")],1),e._v(" "),a("em",[e._v("– Magnus Hansson, updated September 2022")])])]),e._v(" "),e._m(11),e._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:"/developers/docs/nodes-and-clients/"}},[e._v("Nodes and clients")])],1),e._v(" "),a("li",[a("router-link",{attrs:{to:"/developers/docs/nodes-and-clients/run-a-node/"}},[e._v("Running a node")])],1)])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"prerequisites"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[this._v("#")]),this._v(" Prerequisites")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"what-is-an-archive-node"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#what-is-an-archive-node"}},[this._v("#")]),this._v(" What is an archive node")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v('To grasp the importance of an archive node, let\'s clarify the concept of "state." ENULS can be referred to as '),t("em",[this._v("transaction-based state machine")]),this._v(". It consists of accounts and applications executing transactions which are changing their state. The global data with information about each account and contract is stored in a trie database called state. This is handled by the execution layer (EL) client and includes:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("Account balances and nonces")]),this._v(" "),t("li",[this._v("Contract code and storage")]),this._v(" "),t("li",[this._v("Consensus-related data, e.g. Staking Deposit Contract")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"use-cases"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#use-cases"}},[this._v("#")]),this._v(" Use cases")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("em",[this._v("What was NULS balance of account 0x1337... at block 15537393?")])]),this._v(" "),t("li",[t("em",[this._v("What is the balance of token 0x in contract 0x at block 1920000?")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",[a("li",[e._v("Service providers like block explorers")]),e._v(" "),a("li",[e._v("Researchers")]),e._v(" "),a("li",[e._v("Security analysts")]),e._v(" "),a("li",[e._v("Dapp developers")]),e._v(" "),a("li",[e._v("Auditing and compliance")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"implementations-and-usage"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#implementations-and-usage"}},[this._v("#")]),this._v(" Implementations and usage")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"recommended-practices"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#recommended-practices"}},[this._v("#")]),this._v(" Recommended practices")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"hardware"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hardware"}},[this._v("#")]),this._v(" Hardware")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"further-reading"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#further-reading"}},[this._v("#")]),this._v(" Further reading")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"related-topics"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#related-topics"}},[this._v("#")]),this._v(" Related topics")])}],!1,null,null,null);t.default=r.exports}}]);