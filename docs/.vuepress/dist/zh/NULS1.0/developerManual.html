<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>开发手册 | NULS</title>
    <meta name="description" content="NULS">
    <link rel="icon" href="/icon.png">
    
    <link rel="preload" href="/assets/css/0.styles.3751d6d5.css" as="style"><link rel="preload" href="/assets/js/app.15dd29f7.js" as="script"><link rel="preload" href="/assets/js/149.6671cebe.js" as="script"><link rel="prefetch" href="/assets/js/10.2cc8f5c2.js"><link rel="prefetch" href="/assets/js/100.d3a152d6.js"><link rel="prefetch" href="/assets/js/101.2a081cb7.js"><link rel="prefetch" href="/assets/js/102.a47ba456.js"><link rel="prefetch" href="/assets/js/103.d5ac9751.js"><link rel="prefetch" href="/assets/js/104.7595a7fc.js"><link rel="prefetch" href="/assets/js/105.828dda8f.js"><link rel="prefetch" href="/assets/js/106.e754f194.js"><link rel="prefetch" href="/assets/js/107.775c5175.js"><link rel="prefetch" href="/assets/js/108.8b1f0e7f.js"><link rel="prefetch" href="/assets/js/109.2f3b3253.js"><link rel="prefetch" href="/assets/js/11.b0ceb74e.js"><link rel="prefetch" href="/assets/js/110.aa04c678.js"><link rel="prefetch" href="/assets/js/111.f62d78bb.js"><link rel="prefetch" href="/assets/js/112.69acd927.js"><link rel="prefetch" href="/assets/js/113.888160f3.js"><link rel="prefetch" href="/assets/js/114.29e41199.js"><link rel="prefetch" href="/assets/js/115.d2ee5369.js"><link rel="prefetch" href="/assets/js/116.51fc87d4.js"><link rel="prefetch" href="/assets/js/117.4c9dc648.js"><link rel="prefetch" href="/assets/js/118.83070636.js"><link rel="prefetch" href="/assets/js/119.665c7995.js"><link rel="prefetch" href="/assets/js/12.02dfbd69.js"><link rel="prefetch" href="/assets/js/120.214bbe7a.js"><link rel="prefetch" href="/assets/js/121.bf9971ed.js"><link rel="prefetch" href="/assets/js/122.7560b52a.js"><link rel="prefetch" href="/assets/js/123.1d267c1f.js"><link rel="prefetch" href="/assets/js/124.f5bbb448.js"><link rel="prefetch" href="/assets/js/125.376b8644.js"><link rel="prefetch" href="/assets/js/126.f44dfff9.js"><link rel="prefetch" href="/assets/js/127.4bfabc7b.js"><link rel="prefetch" href="/assets/js/128.f1386192.js"><link rel="prefetch" href="/assets/js/129.bc8e43b2.js"><link rel="prefetch" href="/assets/js/13.6ff2f0d4.js"><link rel="prefetch" href="/assets/js/130.cacc4ae3.js"><link rel="prefetch" href="/assets/js/131.84d456ba.js"><link rel="prefetch" href="/assets/js/132.2aae8ca6.js"><link rel="prefetch" href="/assets/js/133.1a312ad1.js"><link rel="prefetch" href="/assets/js/134.703ce965.js"><link rel="prefetch" href="/assets/js/135.8cee3887.js"><link rel="prefetch" href="/assets/js/136.b36f5811.js"><link rel="prefetch" href="/assets/js/137.eda59c8e.js"><link rel="prefetch" href="/assets/js/138.551346e5.js"><link rel="prefetch" href="/assets/js/139.3a3f1471.js"><link rel="prefetch" href="/assets/js/14.fa820f23.js"><link rel="prefetch" href="/assets/js/140.1e504789.js"><link rel="prefetch" href="/assets/js/141.4bf908a3.js"><link rel="prefetch" href="/assets/js/142.618b966f.js"><link rel="prefetch" href="/assets/js/143.36491f90.js"><link rel="prefetch" href="/assets/js/144.76d9a156.js"><link rel="prefetch" href="/assets/js/145.be4615d5.js"><link rel="prefetch" href="/assets/js/146.a073f6bd.js"><link rel="prefetch" href="/assets/js/147.fec28542.js"><link rel="prefetch" href="/assets/js/148.1a4b00b2.js"><link rel="prefetch" href="/assets/js/15.1f656e2a.js"><link rel="prefetch" href="/assets/js/150.75db4652.js"><link rel="prefetch" href="/assets/js/151.b3ee235e.js"><link rel="prefetch" href="/assets/js/152.63fb9894.js"><link rel="prefetch" href="/assets/js/153.852b7cff.js"><link rel="prefetch" href="/assets/js/154.dbd3a07d.js"><link rel="prefetch" href="/assets/js/155.6f6f946b.js"><link rel="prefetch" href="/assets/js/156.8e16b0e8.js"><link rel="prefetch" href="/assets/js/157.8dbfeb43.js"><link rel="prefetch" href="/assets/js/158.919c857b.js"><link rel="prefetch" href="/assets/js/159.09925f42.js"><link rel="prefetch" href="/assets/js/16.aa19419e.js"><link rel="prefetch" href="/assets/js/160.797785d9.js"><link rel="prefetch" href="/assets/js/161.4d34eb09.js"><link rel="prefetch" href="/assets/js/162.94099c67.js"><link rel="prefetch" href="/assets/js/163.9f984d63.js"><link rel="prefetch" href="/assets/js/164.9e26163d.js"><link rel="prefetch" href="/assets/js/165.c8de855f.js"><link rel="prefetch" href="/assets/js/166.d8e0213d.js"><link rel="prefetch" href="/assets/js/167.778d1b2a.js"><link rel="prefetch" href="/assets/js/168.6ad455d7.js"><link rel="prefetch" href="/assets/js/169.f26a480a.js"><link rel="prefetch" href="/assets/js/17.4eef6f4e.js"><link rel="prefetch" href="/assets/js/170.9f0e1298.js"><link rel="prefetch" href="/assets/js/171.fc4a1cfb.js"><link rel="prefetch" href="/assets/js/172.d5c28bec.js"><link rel="prefetch" href="/assets/js/173.2cfc6896.js"><link rel="prefetch" href="/assets/js/174.6ac11f1d.js"><link rel="prefetch" href="/assets/js/175.ff16c02e.js"><link rel="prefetch" href="/assets/js/176.5d7156d4.js"><link rel="prefetch" href="/assets/js/177.89dacd78.js"><link rel="prefetch" href="/assets/js/178.a59d32eb.js"><link rel="prefetch" href="/assets/js/179.a6c468fe.js"><link rel="prefetch" href="/assets/js/18.f6c2f0b8.js"><link rel="prefetch" href="/assets/js/180.ebd647d5.js"><link rel="prefetch" href="/assets/js/181.872ce38a.js"><link rel="prefetch" href="/assets/js/182.0db6d70c.js"><link rel="prefetch" href="/assets/js/183.963128a1.js"><link rel="prefetch" href="/assets/js/184.b537b1fa.js"><link rel="prefetch" href="/assets/js/185.30696c6b.js"><link rel="prefetch" href="/assets/js/186.0ad2973d.js"><link rel="prefetch" href="/assets/js/187.ada551ca.js"><link rel="prefetch" href="/assets/js/188.0bf963be.js"><link rel="prefetch" href="/assets/js/189.39991fc7.js"><link rel="prefetch" href="/assets/js/19.c066ca9d.js"><link rel="prefetch" href="/assets/js/190.7453b0ea.js"><link rel="prefetch" href="/assets/js/191.6f8d2b48.js"><link rel="prefetch" href="/assets/js/192.ffa7a0ae.js"><link rel="prefetch" href="/assets/js/193.6b5187de.js"><link rel="prefetch" href="/assets/js/194.33c85b12.js"><link rel="prefetch" href="/assets/js/195.6ce6baa9.js"><link rel="prefetch" href="/assets/js/196.b7f7795d.js"><link rel="prefetch" href="/assets/js/197.56c70085.js"><link rel="prefetch" href="/assets/js/198.2b4a23bb.js"><link rel="prefetch" href="/assets/js/199.07618bd4.js"><link rel="prefetch" href="/assets/js/2.434158f1.js"><link rel="prefetch" href="/assets/js/20.5171c565.js"><link rel="prefetch" href="/assets/js/200.cd38ef32.js"><link rel="prefetch" href="/assets/js/201.63a35536.js"><link rel="prefetch" href="/assets/js/202.8463e76c.js"><link rel="prefetch" href="/assets/js/203.c2eff4d8.js"><link rel="prefetch" href="/assets/js/204.1b6a7ee2.js"><link rel="prefetch" href="/assets/js/205.84d64836.js"><link rel="prefetch" href="/assets/js/21.db5c56e6.js"><link rel="prefetch" href="/assets/js/22.498863f8.js"><link rel="prefetch" href="/assets/js/23.9f1f092a.js"><link rel="prefetch" href="/assets/js/24.2dd53084.js"><link rel="prefetch" href="/assets/js/25.0460bbcd.js"><link rel="prefetch" href="/assets/js/26.cac7fce9.js"><link rel="prefetch" href="/assets/js/27.d07d1fcb.js"><link rel="prefetch" href="/assets/js/28.af448362.js"><link rel="prefetch" href="/assets/js/29.014f7be8.js"><link rel="prefetch" href="/assets/js/3.944c2fb9.js"><link rel="prefetch" href="/assets/js/30.71024fdc.js"><link rel="prefetch" href="/assets/js/31.a1d400ee.js"><link rel="prefetch" href="/assets/js/32.f6916684.js"><link rel="prefetch" href="/assets/js/33.7a11d236.js"><link rel="prefetch" href="/assets/js/34.2e902b60.js"><link rel="prefetch" href="/assets/js/35.77cbe800.js"><link rel="prefetch" href="/assets/js/36.b4a03b7d.js"><link rel="prefetch" href="/assets/js/37.835e1993.js"><link rel="prefetch" href="/assets/js/38.d905a078.js"><link rel="prefetch" href="/assets/js/39.9a0ea84a.js"><link rel="prefetch" href="/assets/js/4.10b50b1a.js"><link rel="prefetch" href="/assets/js/40.6894dc38.js"><link rel="prefetch" href="/assets/js/41.9abdd72f.js"><link rel="prefetch" href="/assets/js/42.791cbfec.js"><link rel="prefetch" href="/assets/js/43.b4204359.js"><link rel="prefetch" href="/assets/js/44.79523177.js"><link rel="prefetch" href="/assets/js/45.52dab45f.js"><link rel="prefetch" href="/assets/js/46.d45f0044.js"><link rel="prefetch" href="/assets/js/47.66798c19.js"><link rel="prefetch" href="/assets/js/48.2f7186f9.js"><link rel="prefetch" href="/assets/js/49.eeb6792f.js"><link rel="prefetch" href="/assets/js/5.54beffe8.js"><link rel="prefetch" href="/assets/js/50.76124638.js"><link rel="prefetch" href="/assets/js/51.b430df64.js"><link rel="prefetch" href="/assets/js/52.dc55c14c.js"><link rel="prefetch" href="/assets/js/53.336f003c.js"><link rel="prefetch" href="/assets/js/54.5f4ba8e6.js"><link rel="prefetch" href="/assets/js/55.07cb4238.js"><link rel="prefetch" href="/assets/js/56.051d4b4e.js"><link rel="prefetch" href="/assets/js/57.bd3f6e79.js"><link rel="prefetch" href="/assets/js/58.220ce9c8.js"><link rel="prefetch" href="/assets/js/59.896c6030.js"><link rel="prefetch" href="/assets/js/6.0c2e36a1.js"><link rel="prefetch" href="/assets/js/60.c437b838.js"><link rel="prefetch" href="/assets/js/61.f607b3ec.js"><link rel="prefetch" href="/assets/js/62.a2eb63e8.js"><link rel="prefetch" href="/assets/js/63.7b74ed20.js"><link rel="prefetch" href="/assets/js/64.ab1a2432.js"><link rel="prefetch" href="/assets/js/65.23af0670.js"><link rel="prefetch" href="/assets/js/66.2cf2b73c.js"><link rel="prefetch" href="/assets/js/67.dd039849.js"><link rel="prefetch" href="/assets/js/68.c1f2396d.js"><link rel="prefetch" href="/assets/js/69.f64d6dc5.js"><link rel="prefetch" href="/assets/js/7.66c6371d.js"><link rel="prefetch" href="/assets/js/70.1b8f30ff.js"><link rel="prefetch" href="/assets/js/71.6abde1ee.js"><link rel="prefetch" href="/assets/js/72.a80f16f5.js"><link rel="prefetch" href="/assets/js/73.6690fcbd.js"><link rel="prefetch" href="/assets/js/74.d7f82bfd.js"><link rel="prefetch" href="/assets/js/75.fc906157.js"><link rel="prefetch" href="/assets/js/76.106a4524.js"><link rel="prefetch" href="/assets/js/77.ad77edec.js"><link rel="prefetch" href="/assets/js/78.10c7b197.js"><link rel="prefetch" href="/assets/js/79.08097c6d.js"><link rel="prefetch" href="/assets/js/8.b37e7034.js"><link rel="prefetch" href="/assets/js/80.c33bd3c0.js"><link rel="prefetch" href="/assets/js/81.c1c8227b.js"><link rel="prefetch" href="/assets/js/82.042ca332.js"><link rel="prefetch" href="/assets/js/83.371427a4.js"><link rel="prefetch" href="/assets/js/84.95658ce6.js"><link rel="prefetch" href="/assets/js/85.e4365ba5.js"><link rel="prefetch" href="/assets/js/86.c5ed5194.js"><link rel="prefetch" href="/assets/js/87.1a56019a.js"><link rel="prefetch" href="/assets/js/88.a0664933.js"><link rel="prefetch" href="/assets/js/89.365bb774.js"><link rel="prefetch" href="/assets/js/9.c34e88ed.js"><link rel="prefetch" href="/assets/js/90.2330af89.js"><link rel="prefetch" href="/assets/js/91.25be9d8a.js"><link rel="prefetch" href="/assets/js/92.7fca59f6.js"><link rel="prefetch" href="/assets/js/93.5d25de24.js"><link rel="prefetch" href="/assets/js/94.52f3f774.js"><link rel="prefetch" href="/assets/js/95.3da9bca5.js"><link rel="prefetch" href="/assets/js/96.24b73c87.js"><link rel="prefetch" href="/assets/js/97.cd2d42fb.js"><link rel="prefetch" href="/assets/js/98.a520e926.js"><link rel="prefetch" href="/assets/js/99.22c2d988.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3751d6d5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zh/" class="home-link router-link-active"><!----> <span class="site-name">NULS</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zh/learn/" class="nav-link">了解NULS</a></div><div class="nav-item"><a href="/zh/NULS1.0/" class="nav-link router-link-active">NULS1.0</a></div><div class="nav-item"><a href="/zh/NULS2.0/" class="nav-link">NULS2.0</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/NULS1.0/developerManual.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/zh/NULS1.0/developerManual.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <a href="https://github.com/nuls-io/devsite" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zh/learn/" class="nav-link">了解NULS</a></div><div class="nav-item"><a href="/zh/NULS1.0/" class="nav-link router-link-active">NULS1.0</a></div><div class="nav-item"><a href="/zh/NULS2.0/" class="nav-link">NULS2.0</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/NULS1.0/developerManual.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/zh/NULS1.0/developerManual.html" class="nav-link router-link-exact-active router-link-active">简体中文</a></li></ul></div></div> <a href="https://github.com/nuls-io/devsite" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>启动NULS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>底层</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>智能合约</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/zh/NULS1.0/startSmartContract.html" class="sidebar-link">快速入门</a></li><li><a href="/zh/NULS1.0/developerManual.html" class="active sidebar-link">开发手册</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/NULS1.0/developerManual.html#_1-简介" class="sidebar-link">1. 简介</a></li><li class="sidebar-sub-header"><a href="/zh/NULS1.0/developerManual.html#_2-开发环境" class="sidebar-link">2. 开发环境</a></li><li class="sidebar-sub-header"><a href="/zh/NULS1.0/developerManual.html#_3-nuls智能合约规范与语法" class="sidebar-link">3. NULS智能合约规范与语法</a></li><li class="sidebar-sub-header"><a href="/zh/NULS1.0/developerManual.html#_4-nuls智能合约简单示例" class="sidebar-link">4. NULS智能合约简单示例</a></li><li class="sidebar-sub-header"><a href="/zh/NULS1.0/developerManual.html#_5-nuls-contract-sdk" class="sidebar-link">5. NULS Contract SDK</a></li><li class="sidebar-sub-header"><a href="/zh/NULS1.0/developerManual.html#_6-智能合约主要的rpc接口" class="sidebar-link">6. 智能合约主要的RPC接口</a></li><li class="sidebar-sub-header"><a href="/zh/NULS1.0/developerManual.html#_7-示例" class="sidebar-link">7. 示例</a></li></ul></li><li><a href="/zh/NULS1.0/GUIForSmartContract.html" class="sidebar-link">智能合约钱包操作手册</a></li><li><a href="/zh/NULS1.0/ideaPlugin.html" class="sidebar-link">IDEA插件</a></li><li><a href="/zh/NULS1.0/NRC-20TokenStandard.html" class="sidebar-link">NRC-20合约标准</a></li><li><a href="/zh/NULS1.0/smartContractFee.html" class="sidebar-link">手续费</a></li><li><a href="/zh/NULS1.0/randomImplementations.html" class="sidebar-link">随机数的几种实现方式</a></li><li><a href="/zh/NULS1.0/randomRPC.html" class="sidebar-link">钱包增加随机种子</a></li><li><a href="/zh/NULS1.0/guessTheSize.html" class="sidebar-link">猜大小游戏客户端操作手册</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>开发者工具</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="开发手册"><a href="#开发手册" aria-hidden="true" class="header-anchor">#</a> 开发手册</h1> <h2 id="_1-简介"><a href="#_1-简介" aria-hidden="true" class="header-anchor">#</a> 1. 简介</h2> <p>NULS智能合约使用Java进行开发，合约运行在NULS虚拟机中。合约开发不能使用所有的Java特性，在第3节列出具体限制。</p> <h2 id="_2-开发环境"><a href="#_2-开发环境" aria-hidden="true" class="header-anchor">#</a> 2. 开发环境</h2> <h3 id="_2-1-安装nuls钱包"><a href="#_2-1-安装nuls钱包" aria-hidden="true" class="header-anchor">#</a> 2.1 安装NULS钱包</h3> <h3 id="_2-2-安装jdk-8"><a href="#_2-2-安装jdk-8" aria-hidden="true" class="header-anchor">#</a> 2.2 安装JDK 8</h3> <h3 id="_2-3-安装intellij-idea"><a href="#_2-3-安装intellij-idea" aria-hidden="true" class="header-anchor">#</a> 2.3 安装IntelliJ IDEA</h3> <p>Nuls智能合约使用的开发工具为IntelliJ IDEA。</p> <h3 id="_2-4-安装nuls智能合约插件"><a href="#_2-4-安装nuls智能合约插件" aria-hidden="true" class="header-anchor">#</a> 2.4 安装NULS智能合约插件</h3> <p><a href="https://nuls-usa-west.oss-us-west-1.aliyuncs.com/plugins/Docs%26plugin.zip" target="_blank" rel="noopener noreferrer">点击下载插件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>NULS智能合约插件提供的主要功能：</p> <ul><li>新建NULS合约工程</li> <li>提示不支持的Java特性、Java类、Java方法</li> <li>编译、打包、部署合约</li> <li>展示、调用合约方法。</li></ul> <h2 id="_3-nuls智能合约规范与语法"><a href="#_3-nuls智能合约规范与语法" aria-hidden="true" class="header-anchor">#</a> 3. NULS智能合约规范与语法</h2> <p>Nuls智能合约语法是Java语法的一个子集，在Java语法上做了一些限制。</p> <h3 id="_3-1-nuls智能合约规范"><a href="#_3-1-nuls智能合约规范" aria-hidden="true" class="header-anchor">#</a> 3.1 NULS智能合约规范</h3> <blockquote><p><strong><em>合约主类必须实现Contract接口，一个智能合约只能有一个类实现Contract接口，其他类和接口都是为这个合约提供功能的。</em></strong></p></blockquote> <h3 id="_3-2-关键字"><a href="#_3-2-关键字" aria-hidden="true" class="header-anchor">#</a> 3.2 关键字</h3> <p>下面列出Java关键字，其中将标注NULS智能合约不支持的关键字</p> <p>访问控制</p> <ul><li>public</li> <li>protected</li> <li>private</li></ul> <p>定义类、接口、抽象类和实现接口、继承类的关键字、实例化对象</p> <ul><li>class</li> <li>interface</li> <li>abstract</li> <li>implements</li> <li>extends</li> <li>new</li></ul> <p>包的关键字</p> <ul><li>import</li> <li>package</li></ul> <p>数据类型的关键字</p> <ul><li>byte</li> <li>char</li> <li>boolean</li> <li>short</li> <li>int</li> <li>float</li> <li>long</li> <li>double</li> <li>void</li> <li>null</li> <li>true</li> <li>false</li></ul> <p>条件循环（流程控制）</p> <ul><li>if</li> <li>else</li> <li>while</li> <li>for</li> <li>switch</li> <li>case</li> <li>default</li> <li>do</li> <li>break</li> <li>continue</li> <li>return</li> <li>instanceof</li></ul> <p>错误处理</p> <ul><li>catch</li> <li>try</li> <li>finally</li> <li>throw</li> <li>throws</li></ul> <p>修饰方法、类、属性和变量</p> <ul><li>static</li> <li>final</li> <li>super</li> <li>this</li> <li>native（不支持）</li> <li>strictfp（不支持）</li> <li>synchronized（不支持）</li> <li>transient（不支持）</li> <li>volatile（不支持）</li></ul> <p>其他</p> <ul><li>enum（不支持）</li> <li>assert（不支持）</li></ul> <h3 id="_3-3-基本语法"><a href="#_3-3-基本语法" aria-hidden="true" class="header-anchor">#</a> 3.3 基本语法</h3> <p>下面的语法与Java相同，只是简单列出，具体可参考Java相关文档</p> <ul><li>标识符：由字符、下划线、美元符或数字组成，以字符、下划线、美元符开头</li> <li>基本数据类型：byte short int long float double char boolean</li> <li>引用数据类型：类、接口、数组</li> <li>算术运算符：+        -        *        /        %        ++        --</li> <li>关系运算符：&gt;        &lt;        &gt;=        &lt;=        ==        !=</li> <li>逻辑运算符：!        &amp;        |        ^        &amp;&amp;        ||</li> <li>位运算符：&amp;        |        ^        ~        &gt;&gt;        &lt;&lt;        &gt;&gt;&gt;</li> <li>赋值运算符：=</li> <li>拓展赋值运算符：+        =        -=        *=        /=</li> <li>字符串链接运算符：+</li> <li>三目条件运算符          ?        :</li> <li>流程控制语句（if,switch,for,while,do...while）</li></ul> <h3 id="_3-4-支持的类"><a href="#_3-4-支持的类" aria-hidden="true" class="header-anchor">#</a> 3.4 支持的类</h3> <p>Nuls智能合约只能使用下面的类进行开发</p> <ul><li>io.nuls.contract.sdk.Address</li> <li>io.nuls.contract.sdk.Block</li> <li>io.nuls.contract.sdk.BlockHeader</li> <li>io.nuls.contract.sdk.Contract</li> <li>io.nuls.contract.sdk.Event</li> <li>io.nuls.contract.sdk.Msg</li> <li>io.nuls.contract.sdk.Utils</li> <li>io.nuls.contract.sdk.annotation.View</li> <li>io.nuls.contract.sdk.annotation.Required</li> <li>io.nuls.contract.sdk.annotation.Payable</li> <li>java.lang.Boolean</li> <li>java.lang.Byte</li> <li>java.lang.Short</li> <li>java.lang.Character</li> <li>java.lang.Integer</li> <li>java.lang.Long</li> <li>java.lang.Float</li> <li>java.lang.Double</li> <li>java.lang.String</li> <li>java.lang.StringBuilder</li> <li>java.math.BigInteger</li> <li>java.math.BigDecimal</li> <li>java.util.Collection</li> <li>java.util.List</li> <li>java.util.ArrayList</li> <li>java.util.LinkedList</li> <li>java.util.Map</li> <li>java.util.HashMap</li> <li>java.util.LinkedHashMap</li> <li>java.util.Set</li> <li>java.util.HashSet</li></ul> <h3 id="_3-5-其他限制"><a href="#_3-5-其他限制" aria-hidden="true" class="header-anchor">#</a> 3.5 其他限制</h3> <ul><li>合约类只能有一个构造方法，其他类不限制</li> <li>执行一次合约方法最大的Gas消耗是1000万，包括<code>@View</code>类型的方法调用，请保证尽可能的优化合约代码</li></ul> <h2 id="_4-nuls智能合约简单示例"><a href="#_4-nuls智能合约简单示例" aria-hidden="true" class="header-anchor">#</a> 4. NULS智能合约简单示例</h2> <p>一个简单的合约</p> <blockquote><p><strong><em>合约主类必须实现Contract接口，其他类和接口都是为这个合约提供功能的。</em></strong></p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> contracts<span class="token punctuation">.</span>examples<span class="token punctuation">;</span>

<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Contract<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Payable<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Required<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>View<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleStorage</span> <span class="token keyword">implements</span> <span class="token class-name">Contract</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> String storedData<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> String <span class="token function">getStoredData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> storedData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Payable</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStoredData</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> String storedData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>storedData <span class="token operator">=</span> storedData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>在一个合约项目中，只需要引入jar包：contract-sdk.jar，这个包提供了获取区块信息和交易信息的类。
项目中可以有多个类和接口。</p> <p>合约写好后，编译打包，部署到NULS链上时候，虚拟机会执行合约的构造方法初始化这个合约，并把这个合约状态保存在链上，合约状态是合约类的所有成员变量。
合约部署好以后，合约类的所有public方法都是能调用的，通过调用这些方法读取或修改合约状态。</p> <p>注解说明</p> <p>@View 标记@View的方法，调用后合约状态不会改变，可以通过这种方法查询合约状态。</p> <p>@Payable 标记@Payable的方法，才能在调用时候传入金额</p> <p>@Required 标记@Required的参数，调用时候必须传入值</p> <p>去github下载NULS源码，里面有一些合约示例。</p> <h2 id="_5-nuls-contract-sdk"><a href="#_5-nuls-contract-sdk" aria-hidden="true" class="header-anchor">#</a> 5. NULS Contract SDK</h2> <p>合约SDK提供了几个类，方便合约开发：</p> <h3 id="io-nuls-contract-sdk-address"><a href="#io-nuls-contract-sdk-address" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Address</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Address</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> String address<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Address</span><span class="token punctuation">(</span>String address<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">valid</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>address <span class="token operator">=</span> address<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取该地址的余额（只能获取合约地址余额）
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> BigInteger <span class="token function">balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 合约向该地址转账
     *
     * @param value 转账金额（多少Na）
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span>BigInteger value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 调用该地址的合约方法
     *
     * @param methodName 方法名
     * @param methodDesc 方法签名
     * @param args       参数
     * @param value      附带的货币量（多少Na）
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span>String methodName<span class="token punctuation">,</span> String methodDesc<span class="token punctuation">,</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
     * 调用该地址的合约方法并带有返回值(String)
     *
     * @param methodName 方法名
     * @param methodDesc 方法签名
     * @param args       参数
     * @param value      附带的货币量（多少Na）
     * @return 调用合约后的返回值
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">native</span> String <span class="token function">callWithReturnValue</span><span class="token punctuation">(</span>String methodName<span class="token punctuation">,</span> String methodDesc<span class="token punctuation">,</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * 验证地址
     *
     * @param address
     * @see io.nuls.kernel.utils.AddressTool#validAddress(String)
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">valid</span><span class="token punctuation">(</span>String address<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        Address address1 <span class="token operator">=</span> <span class="token punctuation">(</span>Address<span class="token punctuation">)</span> o<span class="token punctuation">;</span>
        <span class="token keyword">return</span> address <span class="token operator">!=</span> null <span class="token operator">?</span> address<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>address1<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token operator">:</span> address1<span class="token punctuation">.</span>address <span class="token operator">==</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> address <span class="token operator">!=</span> null <span class="token operator">?</span> address<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> address<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="io-nuls-contract-sdk-block"><a href="#io-nuls-contract-sdk-block" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Block</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Block</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 给定块的区块头
     *
     * @param blockNumber
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BlockHeader <span class="token function">getBlockHeader</span><span class="token punctuation">(</span><span class="token keyword">long</span> blockNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 当前块的区块头
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BlockHeader <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * 最新块的区块头
     *
     * @return 最新块的区块头
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BlockHeader <span class="token function">newestBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 给定块的哈希值
     * hash of the given block
     *
     * @param blockNumber
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">blockhash</span><span class="token punctuation">(</span><span class="token keyword">long</span> blockNumber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getBlockHeader</span><span class="token punctuation">(</span>blockNumber<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 当前块矿工地址
     * current block miner’s address
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> Address <span class="token function">coinbase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackingAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 当前块编号
     * current block number
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 当前块时间戳
     * current block timestamp
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre></div><h3 id="io-nuls-contract-sdk-blockheader"><a href="#io-nuls-contract-sdk-blockheader" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.BlockHeader</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlockHeader</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> String hash<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> time<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> height<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> txCount<span class="token punctuation">;</span>
    <span class="token keyword">private</span> Address packingAddress<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String stateRoot<span class="token punctuation">;</span>

    <span class="token keyword">public</span> String <span class="token function">getHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> hash<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> time<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> height<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getTxCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> txCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> Address <span class="token function">getPackingAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> packingAddress<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getStateRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> stateRoot<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        BlockHeader that <span class="token operator">=</span> <span class="token punctuation">(</span>BlockHeader<span class="token punctuation">)</span> o<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">!=</span> that<span class="token punctuation">.</span>time<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>height <span class="token operator">!=</span> that<span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>txCount <span class="token operator">!=</span> that<span class="token punctuation">.</span>txCount<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>hash <span class="token operator">!=</span> null <span class="token operator">?</span> <span class="token operator">!</span>hash<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token operator">:</span> that<span class="token punctuation">.</span>hash <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>packingAddress <span class="token operator">!=</span> null <span class="token operator">?</span> <span class="token operator">!</span>packingAddress<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>packingAddress<span class="token punctuation">)</span> <span class="token operator">:</span> that<span class="token punctuation">.</span>packingAddress <span class="token operator">!=</span> null<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> stateRoot <span class="token operator">!=</span> null <span class="token operator">?</span> stateRoot<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>stateRoot<span class="token punctuation">)</span> <span class="token operator">:</span> that<span class="token punctuation">.</span>stateRoot <span class="token operator">==</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> hash <span class="token operator">!=</span> null <span class="token operator">?</span> hash<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>time <span class="token operator">^</span> <span class="token punctuation">(</span>time <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>height <span class="token operator">^</span> <span class="token punctuation">(</span>height <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>txCount <span class="token operator">^</span> <span class="token punctuation">(</span>txCount <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span>packingAddress <span class="token operator">!=</span> null <span class="token operator">?</span> packingAddress<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token number">31</span> <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span>stateRoot <span class="token operator">!=</span> null <span class="token operator">?</span> stateRoot<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;BlockHeader{&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;hash='&quot;</span> <span class="token operator">+</span> hash <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">&quot;, time=&quot;</span> <span class="token operator">+</span> time <span class="token operator">+</span>
                <span class="token string">&quot;, height=&quot;</span> <span class="token operator">+</span> height <span class="token operator">+</span>
                <span class="token string">&quot;, txCount=&quot;</span> <span class="token operator">+</span> txCount <span class="token operator">+</span>
                <span class="token string">&quot;, packingAddress=&quot;</span> <span class="token operator">+</span> packingAddress <span class="token operator">+</span>
                <span class="token string">&quot;, stateRoot='&quot;</span> <span class="token operator">+</span> stateRoot <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="io-nuls-contract-sdk-contract"><a href="#io-nuls-contract-sdk-contract" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Contract</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * 合约接口，合约类实现这个接口
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Contract</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 直接向合约转账，会调用这个方法，默认不做任何操作，如果合约地址要接受直接转账，可以重载这个方法，并且标记`@Payable`注解。
     */</span>
    <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">_payable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="io-nuls-contract-sdk-event"><a href="#io-nuls-contract-sdk-event" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Event</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
* 事件接口，事件类实现这个接口
*/</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Event</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="io-nuls-contract-sdk-msg"><a href="#io-nuls-contract-sdk-msg" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Msg</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Msg</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 剩余Gas
     * remaining gas
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">long</span> <span class="token function">gasleft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 合约发送者地址
     * sender of the contract
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> Address <span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 合约发送者转入合约地址的Nuls数量，单位是Na，1Nuls=1亿Na
     * The number of Nuls transferred by the contract sender to the contract address, the unit is Na, 1Nuls = 1 billion Na
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BigInteger <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Gas价格
     * gas price
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">long</span> <span class="token function">gasprice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 合约地址
     * contract address
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> Address <span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="io-nuls-contract-sdk-utils"><a href="#io-nuls-contract-sdk-utils" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.Utils</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Utils</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token function">Utils</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 检查条件，如果条件不满足则回滚
     *
     * @param expression
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> expression<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>expression<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">revert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 检查条件，如果条件不满足则回滚
     *
     * @param expression
     * @param errorMessage
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> expression<span class="token punctuation">,</span> String errorMessage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>expression<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">revert</span><span class="token punctuation">(</span>errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 终止执行并还原改变的状态
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">revert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">revert</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 终止执行并还原改变的状态
     *
     * @param errorMessage
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">revert</span><span class="token punctuation">(</span>String errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 发送事件
     *
     * @param event
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">emit</span><span class="token punctuation">(</span>Event event<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
     * @param seed a private seed
     * @return pseudo random number (0 ~ 1)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">float</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span><span class="token keyword">long</span> seed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> hash1 <span class="token operator">=</span> Block<span class="token punctuation">.</span><span class="token function">currentBlockHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackingAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> hash2 <span class="token operator">=</span> Msg<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> hash3 <span class="token operator">=</span> Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null <span class="token operator">?</span> Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> hash4 <span class="token operator">=</span> Long<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>Block<span class="token punctuation">.</span><span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">long</span> hash <span class="token operator">=</span> seed <span class="token operator">^</span> hash1 <span class="token operator">^</span> hash2 <span class="token operator">^</span> hash3 <span class="token operator">^</span> hash4<span class="token punctuation">;</span>

        seed <span class="token operator">=</span> <span class="token punctuation">(</span>hash <span class="token operator">*</span> <span class="token number">0</span>x5DEECE66DL <span class="token operator">+</span> <span class="token number">0</span>xBL<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span>L <span class="token operator">&lt;&lt;</span> <span class="token number">48</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>seed <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @return pseudo random number (0 ~ 1)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">float</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">pseudoRandom</span><span class="token punctuation">(</span><span class="token number">0</span>x5DEECE66DL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     *
     * Please note that this is the SHA-3 FIPS 202 standard, not Keccak-256.
     *
     * @param src source string (hex encoding string)
     * @return sha3-256 hash (hex encoding string)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> String <span class="token function">sha3</span><span class="token punctuation">(</span>String hexString<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     *
     * Please note that this is the SHA-3 FIPS 202 standard, not Keccak-256.
     *
     * @param bytes source byte array
     * @return sha3-256 hash (hex encoding string)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> String <span class="token function">sha3</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/**
     * [Testnet]verify signature data(ECDSA)
     *
     * @param data(hex encoding string)
     * @param signature(hex encoding string)
     * @param pubkey(hex encoding string)
     * @return verify result
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">boolean</span> <span class="token function">verifySignatureData</span><span class="token punctuation">(</span>String data<span class="token punctuation">,</span> String signature<span class="token punctuation">,</span> String pubkey<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * [Testnet]根据截止高度和原始种子数量，用特定的算法生成一个随机种子
     *
     * @param endHeight 截止高度
     * @param seedCount 原始种子数量
     * @param algorithm hash算法标识
     * @return 原始种子字节数组合并后, 使用hash算法得到32位hash字节数组, 再转化为BigInteger(new BigInteger(byte[] bytes))
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BigInteger <span class="token function">getRandomSeed</span><span class="token punctuation">(</span><span class="token keyword">long</span> endHeight<span class="token punctuation">,</span> <span class="token keyword">int</span> seedCount<span class="token punctuation">,</span> String algorithm<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * [Testnet]根据截止高度和原始种子数量，用`SHA3-256`hash算法生成一个随机种子
     *
     * @param endHeight 截止高度
     * @param seedCount 原始种子数量
     * @return 原始种子字节数组合并后, 使用`SHA3-256`hash算法得到32位hash字节数组, 再转化为BigInteger(new BigInteger(byte[] bytes))
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> BigInteger <span class="token function">getRandomSeed</span><span class="token punctuation">(</span><span class="token keyword">long</span> endHeight<span class="token punctuation">,</span> <span class="token keyword">int</span> seedCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getRandomSeed</span><span class="token punctuation">(</span>endHeight<span class="token punctuation">,</span> seedCount<span class="token punctuation">,</span> <span class="token string">&quot;SHA3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * [Testnet]根据高度范围，用特定的算法生成一个随机种子
     *
     * @param startHeight 起始高度
     * @param endHeight   截止高度
     * @param algorithm   hash算法标识
     * @return 原始种子字节数组合并后, 使用hash算法得到32位hash字节数组, 再转化为BigInteger(new BigInteger(byte[] bytes))
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> BigInteger <span class="token function">getRandomSeed</span><span class="token punctuation">(</span><span class="token keyword">long</span> startHeight<span class="token punctuation">,</span> <span class="token keyword">long</span> endHeight<span class="token punctuation">,</span> String algorithm<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * [Testnet]根据高度范围，用`SHA3-256`hash算法生成一个随机种子
     *
     * @param startHeight 起始高度
     * @param endHeight   截止高度
     * @return 原始种子字节数组合并后, 使用`SHA3-256`hash算法得到32位hash字节数组, 再转化为BigInteger(new BigInteger(byte[] bytes))
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> BigInteger <span class="token function">getRandomSeed</span><span class="token punctuation">(</span><span class="token keyword">long</span> startHeight<span class="token punctuation">,</span> <span class="token keyword">long</span> endHeight<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getRandomSeed</span><span class="token punctuation">(</span>startHeight<span class="token punctuation">,</span> endHeight<span class="token punctuation">,</span> <span class="token string">&quot;SHA3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * [Testnet]根据截止高度和原始种子数量，获取原始种子的集合
     *
     * @param endHeight 截止高度
     * @param seedCount 原始种子数量
     * @return 返回原始种子的集合，元素是字节数组转化的BigInteger(new BigInteger(byte[] bytes))
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> List<span class="token generics function"><span class="token punctuation">&lt;</span>BigInteger<span class="token punctuation">&gt;</span></span> <span class="token function">getRandomSeedList</span><span class="token punctuation">(</span><span class="token keyword">long</span> endHeight<span class="token punctuation">,</span> <span class="token keyword">int</span> seedCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * [Testnet]根据高度范围，获取原始种子的集合
     *
     * @param startHeight 起始高度
     * @param endHeight   截止高度
     * @return 返回原始种子的集合，元素是字节数组转化的BigInteger(new BigInteger(byte[] bytes))
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> List<span class="token generics function"><span class="token punctuation">&lt;</span>BigInteger<span class="token punctuation">&gt;</span></span> <span class="token function">getRandomSeedList</span><span class="token punctuation">(</span><span class="token keyword">long</span> startHeight<span class="token punctuation">,</span> <span class="token keyword">long</span> endHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token punctuation">}</span>
</code></pre></div><h3 id="io-nuls-contract-sdk-annotation-payable"><a href="#io-nuls-contract-sdk-annotation-payable" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.annotation.Payable</h3> <p><code>@Payable 标记@Payable的方法，才能在调用时候转入金额</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ElementType<span class="token punctuation">.</span>METHOD<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Payable</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="io-nuls-contract-sdk-annotation-required"><a href="#io-nuls-contract-sdk-annotation-required" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.annotation.Required</h3> <p><code>@Required 标记@Required的参数，调用时候必须传入值</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ElementType<span class="token punctuation">.</span>PARAMETER<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Required</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="io-nuls-contract-sdk-annotation-view"><a href="#io-nuls-contract-sdk-annotation-view" aria-hidden="true" class="header-anchor">#</a> io.nuls.contract.sdk.annotation.View</h3> <p><code>@View 标记@View的方法，调用后合约状态不会改变，可以通过这种方法查询合约状态。</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span>ElementType<span class="token punctuation">.</span>METHOD<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_6-智能合约主要的rpc接口"><a href="#_6-智能合约主要的rpc接口" aria-hidden="true" class="header-anchor">#</a> 6. 智能合约主要的RPC接口</h2> <p>这里列举几个接口的参数结构及简单实例，其他接口请参见<a href="http://127.0.0.1:8001/docs#/" target="_blank" rel="noopener noreferrer">Swagger UI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <blockquote><p>测试网的<code>Swagger UI</code>的端口默认是8001，正式网的端口默认是6001</p></blockquote> <h3 id="_6-1-创建智能合约"><a href="#_6-1-创建智能合约" aria-hidden="true" class="header-anchor">#</a> 6.1 创建智能合约</h3> <ul><li>POST <code>/api/contract/create</code></li></ul> <table><thead><tr><th style="text-align:center">参数</th> <th style="text-align:center">类型</th> <th style="text-align:center">说明</th></tr></thead> <tbody><tr><td style="text-align:center">sender*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者</td></tr> <tr><td style="text-align:center">password*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者账户密码</td></tr> <tr><td style="text-align:center">gasLimit*</td> <td style="text-align:center">long</td> <td style="text-align:center">最大gas消耗</td></tr> <tr><td style="text-align:center">price*</td> <td style="text-align:center">long</td> <td style="text-align:center">执行合约单价</td></tr> <tr><td style="text-align:center">contractCode*</td> <td style="text-align:center">string</td> <td style="text-align:center">智能合约代码(字节码的Hex编码字符串)</td></tr> <tr><td style="text-align:center">remark</td> <td style="text-align:center">string</td> <td style="text-align:center">备注</td></tr> <tr><td style="text-align:center">args</td> <td style="text-align:center">string[][]</td> <td style="text-align:center">参数列表</td></tr></tbody></table> <ul><li>Example Value</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;gasLimit&quot;</span><span class="token operator">:</span> <span class="token number">4687</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contractCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;504b03041400080808003b5aed4c000000000000000000000000090004004d4554412d494e462ffeca00000300504b0708000000000200000000000000504b03041400080808003b5aed4c000000000000000000000000140000004d4554412d494e462f4d414e49464553542e4d46f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5722e4a4d2c494dd175aa040958e819c41b9a982868f8172526e7a42a38e71715e417259600d56bf272f1720100504b07089e7c76534400000045000000504b03040a00000800007559ed4c0000000000000000000000000d00000074657374636f6e74726163742f504b03041400080808008359ed4c0000000000000000000000001f00000074657374636f6e74726163742f54657374436f6e74726163742e636c6173737d535d53d350103d9796a684604b2cdf20c5cf365a421110f986225a2cf040c5d1b7b40d25d0264c9232e39bbfc2f147f8a03352189df107f8a31cf7b635744a310f7befeedd73f6dcdd9bdf7f7efc023083bd2e746052801ac4948824a6453cc58c8859cc75827f9f3f7de4de331e9f0fe2b9883e2c04b1c8714bdc2c0b581111c60237ab41acf1754ec0ba800d06bfa99575063973ac9d696a49338beabe6b1b66719121e07c28e7ac12434fca321d5733dd03ad54a1ec6041cf1b65ade430b0b48f44c80c425177776b5c9158bc1d9b3f6515e83494314c7db752cee97656cb956ab5adbc563ad06c83fb8da0df3d32887e24e3ea8e9bb74cd7d6f2ae9a2527d57088b28b6aee373476d37ed393e58bc5d3a429a791863c574c10d339d46dbad592611aee4a2de78041dcb72a765edf3278d5dee60293fc12120630c83074a30c868e6c56404ac2265e08d89210c34b01af24a4312e611baf25c491a1baeb6f93b3f36f2428784cd23947d63ad14d094318943082518681d6be6d548c5241b725ec609740d144b4cec210be4addcb1deb5cc89861a966a5e4a89e50a770a25e091d6c7bbee314a9535aa160eb0e752e4ad36b9bb75ecfa0b68ffeef9ccafc9b7f59738fd40da398365dbda8db848cb48bf3e958f5eb929033fec4f60ea9e5b1ed1b798662ed4ff84003dae9a96e161812b1ebcff0facb6c74781113f4aff481a11f3edad1d4f9bbe6b3a1d830ed3b282ef33179fe1802b4bf8371b2518aa8b4325a3b95ef605f6b29136403b5a082bb64a57a02eee13ead0c0f3c70a201f6c9be56e86413d4e7411fe2512b342c7f69814eb785c6bcaa330da878097f159d55045a8bcf3531881e43dc6358265e7e16228608844b745521cadd573422adc002512c3651853c2afa1d1a5456832aa95c4052e49e733045f69de3961296cf11fa89f0bb0bf42aefa9bb55c8f26d32554428eb9b576c9854032bf05367456a51989ad48f554c61ada978d22bfea4864cfc05504b070818c1191cd20200006f050000504b010214001400080808003b5aed4c0000000002000000000000000900040000000000000000000000000000004d4554412d494e462ffeca0000504b010214001400080808003b5aed4c9e7c7653440000004500000014000000000000000000000000003d0000004d4554412d494e462f4d414e49464553542e4d46504b01020a000a00000800007559ed4c0000000000000000000000000d00000000000000000000000000c300000074657374636f6e74726163742f504b010214001400080808008359ed4c18c1191cd20200006f0500001f00000000000000000000000000ee00000074657374636f6e74726163742f54657374436f6e74726163742e636c617373504b05060000000004000400050100000d0400000000&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;asd&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-2-估算创建智能合约的gas消耗"><a href="#_6-2-估算创建智能合约的gas消耗" aria-hidden="true" class="header-anchor">#</a> 6.2 估算创建智能合约的Gas消耗</h3> <ul><li>POST <code>/api/contract/imputedgas/create</code></li></ul> <table><thead><tr><th style="text-align:center">参数</th> <th style="text-align:center">类型</th> <th style="text-align:center">说明</th></tr></thead> <tbody><tr><td style="text-align:center">sender*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者</td></tr> <tr><td style="text-align:center">password*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者账户密码</td></tr> <tr><td style="text-align:center">price*</td> <td style="text-align:center">long</td> <td style="text-align:center">执行合约单价</td></tr> <tr><td style="text-align:center">contractCode*</td> <td style="text-align:center">string</td> <td style="text-align:center">智能合约代码(字节码的Hex编码字符串)</td></tr> <tr><td style="text-align:center">args</td> <td style="text-align:center">string[][]</td> <td style="text-align:center">参数列表</td></tr></tbody></table> <ul><li>Example Value</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contractCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;504b03041400080808003b5aed4c000000000000000000000000090004004d4554412d494e462ffeca00000300504b0708000000000200000000000000504b03041400080808003b5aed4c000000000000000000000000140000004d4554412d494e462f4d414e49464553542e4d46f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5722e4a4d2c494dd175aa040958e819c41b9a982868f8172526e7a42a38e71715e417259600d56bf272f1720100504b07089e7c76534400000045000000504b03040a00000800007559ed4c0000000000000000000000000d00000074657374636f6e74726163742f504b03041400080808008359ed4c0000000000000000000000001f00000074657374636f6e74726163742f54657374436f6e74726163742e636c6173737d535d53d350103d9796a684604b2cdf20c5cf365a421110f986225a2cf040c5d1b7b40d25d0264c9232e39bbfc2f147f8a03352189df107f8a31cf7b635744a310f7befeedd73f6dcdd9bdf7f7efc023083bd2e746052801ac4948824a6453cc58c8859cc75827f9f3f7de4de331e9f0fe2b9883e2c04b1c8714bdc2c0b581111c60237ab41acf1754ec0ba800d06bfa99575063973ac9d696a49338beabe6b1b66719121e07c28e7ac12434fca321d5733dd03ad54a1ec6041cf1b65ade430b0b48f44c80c425177776b5c9158bc1d9b3f6515e83494314c7db752cee97656cb956ab5adbc563ad06c83fb8da0df3d32887e24e3ea8e9bb74cd7d6f2ae9a2527d57088b28b6aee373476d37ed393e58bc5d3a429a791863c574c10d339d46dbad592611aee4a2de78041dcb72a765edf3278d5dee60293fc12120630c83074a30c868e6c56404ac2265e08d89210c34b01af24a4312e611baf25c491a1baeb6f93b3f36f2428784cd23947d63ad14d094318943082518681d6be6d548c5241b725ec609740d144b4cec210be4addcb1deb5cc89861a966a5e4a89e50a770a25e091d6c7bbee314a9535aa160eb0e752e4ad36b9bb75ecfa0b68ffeef9ccafc9b7f59738fd40da398365dbda8db848cb48bf3e958f5eb929033fec4f60ea9e5b1ed1b798662ed4ff84003dae9a96e161812b1ebcff0facb6c74781113f4aff481a11f3edad1d4f9bbe6b3a1d830ed3b282ef33179fe1802b4bf8371b2518aa8b4325a3b95ef605f6b29136403b5a082bb64a57a02eee13ead0c0f3c70a201f6c9be56e86413d4e7411fe2512b342c7f69814eb785c6bcaa330da878097f159d55045a8bcf3531881e43dc6358265e7e16228608844b745521cadd573422adc002512c3651853c2afa1d1a5456832aa95c4052e49e733045f69de3961296cf11fa89f0bb0bf42aefa9bb55c8f26d32554428eb9b576c9854032bf05367456a51989ad48f554c61ada978d22bfea4864cfc05504b070818c1191cd20200006f050000504b010214001400080808003b5aed4c0000000002000000000000000900040000000000000000000000000000004d4554412d494e462ffeca0000504b010214001400080808003b5aed4c9e7c7653440000004500000014000000000000000000000000003d0000004d4554412d494e462f4d414e49464553542e4d46504b01020a000a00000800007559ed4c0000000000000000000000000d00000000000000000000000000c300000074657374636f6e74726163742f504b010214001400080808008359ed4c18c1191cd20200006f0500001f00000000000000000000000000ee00000074657374636f6e74726163742f54657374436f6e74726163742e636c617373504b05060000000004000400050100000d0400000000&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-3-调用智能合约"><a href="#_6-3-调用智能合约" aria-hidden="true" class="header-anchor">#</a> 6.3 调用智能合约</h3> <ul><li>POST <code>/api/contract/call</code></li></ul> <table><thead><tr><th style="text-align:center">参数</th> <th style="text-align:center">类型</th> <th style="text-align:center">说明</th></tr></thead> <tbody><tr><td style="text-align:center">sender*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者</td></tr> <tr><td style="text-align:center">password*</td> <td style="text-align:center">string</td> <td style="text-align:center">交易创建者账户密码</td></tr> <tr><td style="text-align:center">contractAddress*</td> <td style="text-align:center">string</td> <td style="text-align:center">智能合约地址</td></tr> <tr><td style="text-align:center">gasLimit*</td> <td style="text-align:center">long</td> <td style="text-align:center">最大Gas消耗</td></tr> <tr><td style="text-align:center">price*</td> <td style="text-align:center">long</td> <td style="text-align:center">执行合约单价</td></tr> <tr><td style="text-align:center">value</td> <td style="text-align:center">long</td> <td style="text-align:center">交易创建者向合约地址转账的金额(Na - 100000000Na=1NULS)</td></tr> <tr><td style="text-align:center">methodName*</td> <td style="text-align:center">string</td> <td style="text-align:center">方法名</td></tr> <tr><td style="text-align:center">methodDesc</td> <td style="text-align:center">string</td> <td style="text-align:center">方法签名，如果方法名不重复，可以不传</td></tr> <tr><td style="text-align:center">remark</td> <td style="text-align:center">string</td> <td style="text-align:center">备注</td></tr> <tr><td style="text-align:center">args</td> <td style="text-align:center">string[][]</td> <td style="text-align:center">参数列表</td></tr></tbody></table> <ul><li>Example Value</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Nsdz8mKKFMehRDVRZFyXNuuenugUYM7M&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contractAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NseBvPEzerLi3p5Me8Rbm7SeHThVGv1U&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;gasLimit&quot;</span><span class="token operator">:</span> <span class="token number">8000</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;methodName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;methodDesc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;qwe&quot;</span>
  <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-4-估算调用智能合约的gas消耗-参见swagger-ui"><a href="#_6-4-估算调用智能合约的gas消耗-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.4 估算调用智能合约的Gas消耗(参见<code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/imputedgas/call</code></li></ul> <h3 id="_6-5-估算智能合约的price-参见swagger-ui"><a href="#_6-5-估算智能合约的price-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.5 估算智能合约的price(参见<code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/imputedprice</code></li></ul> <h3 id="_6-6-终止智能合约-参见swagger-ui"><a href="#_6-6-终止智能合约-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.6 终止智能合约(参见<code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/delete</code></li></ul> <h3 id="_6-7-调用不上链的智能合约函数-参见swagger-ui"><a href="#_6-7-调用不上链的智能合约函数-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.7 调用不上链的智能合约函数(参见<code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/view</code></li></ul> <h3 id="_6-8-获取智能合约执行结果-参见swagger-ui"><a href="#_6-8-获取智能合约执行结果-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.8 获取智能合约执行结果(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/result/{hash}</code></li></ul> <h3 id="_6-9-获取智能合约基本信息-参见swagger-ui"><a href="#_6-9-获取智能合约基本信息-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.9 获取智能合约基本信息(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/info/{address}</code></li></ul> <h3 id="_6-10-验证是否为合约地址-参见swagger-ui"><a href="#_6-10-验证是否为合约地址-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.10 验证是否为合约地址(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/{address}</code></li></ul> <h3 id="_6-11-获取智能合约地址的nuls余额-参见swagger-ui"><a href="#_6-11-获取智能合约地址的nuls余额-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.11 获取智能合约地址的NULS余额(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/balance/{address}</code></li></ul> <h3 id="_6-12-获取智能合约交易详情-参见swagger-ui"><a href="#_6-12-获取智能合约交易详情-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.12 获取智能合约交易详情(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/tx/{hash}</code></li></ul> <h3 id="_6-13-获取智能合约的交易列表-参见swagger-ui"><a href="#_6-13-获取智能合约的交易列表-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.13 获取智能合约的交易列表(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/tx/list/{address}</code></li></ul> <h3 id="_6-14-根据address和limit查询合约utxo-参见swagger-ui"><a href="#_6-14-根据address和limit查询合约utxo-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.14 根据address和limit查询合约UTXO(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/limit/{address}/{limit}</code></li></ul> <h3 id="_6-15-根据address和amount查询合约utxo-参见swagger-ui"><a href="#_6-15-根据address和amount查询合约utxo-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.15 根据address和amount查询合约UTXO(参见<code>Swagger UI</code>)</h3> <ul><li>GET <code>/api/contract/amount/{address}/{amount}</code></li></ul> <h3 id="_6-16-向智能合约转账-参见swagger-ui"><a href="#_6-16-向智能合约转账-参见swagger-ui" aria-hidden="true" class="header-anchor">#</a> 6.16 向智能合约转账(参见<code>Swagger UI</code>)</h3> <ul><li>POST <code>/api/contract/transfer</code></li></ul> <h2 id="_7-示例"><a href="#_7-示例" aria-hidden="true" class="header-anchor">#</a> 7. 示例</h2> <h3 id="_7-1-投票智能合约代码片段-如下"><a href="#_7-1-投票智能合约代码片段-如下" aria-hidden="true" class="header-anchor">#</a> 7.1 投票智能合约代码<code>片段</code>, 如下</h3> <blockquote><p>完整代码: <code>https://github.com/nuls-io/nuls-vote</code></p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">;</span>

<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Address<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Contract<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Utils<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Payable<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>View<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>func<span class="token punctuation">.</span>BaseVote<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>func<span class="token punctuation">.</span>VoteInterface<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>model<span class="token punctuation">.</span>VoteConfig<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>vote<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>model<span class="token punctuation">.</span>VoteEntity<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VoteContract</span> <span class="token keyword">implements</span> <span class="token class-name">Contract</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> VoteInterface baseVote<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">VoteContract</span><span class="token punctuation">(</span><span class="token keyword">long</span> minRecognizance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        baseVote <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BaseVote</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>minRecognizance<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Payable</span>
    <span class="token keyword">public</span> VoteEntity <span class="token function">create</span><span class="token punctuation">(</span>String title<span class="token punctuation">,</span> String desc<span class="token punctuation">,</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> items<span class="token punctuation">,</span> <span class="token keyword">long</span> startTime<span class="token punctuation">,</span> <span class="token keyword">long</span> endTime<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isMultipleSelect<span class="token punctuation">,</span> <span class="token keyword">int</span> maxSelectCount<span class="token punctuation">,</span> <span class="token keyword">boolean</span> voteCanModify<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        VoteEntity voteEntity <span class="token operator">=</span> baseVote<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> items<span class="token punctuation">)</span><span class="token punctuation">;</span>

        VoteConfig config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VoteConfig</span><span class="token punctuation">(</span>startTime<span class="token punctuation">,</span> endTime<span class="token punctuation">,</span> isMultipleSelect<span class="token punctuation">,</span> maxSelectCount<span class="token punctuation">,</span> voteCanModify<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> success <span class="token operator">=</span> baseVote<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>voteEntity<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>

        Utils<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> voteEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">vote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">,</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> itemIds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">vote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">,</span> itemIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">redemption</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">redemption</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canVote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">canVote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> VoteEntity <span class="token function">queryVote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">queryVote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> Map<span class="token operator">&lt;</span>Address<span class="token punctuation">,</span> List<span class="token generics function"><span class="token punctuation">&lt;</span>Long<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> <span class="token function">queryVoteResult</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">queryVoteResult</span><span class="token punctuation">(</span>voteId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">queryAddressHasVote</span><span class="token punctuation">(</span><span class="token keyword">long</span> voteId<span class="token punctuation">,</span> Address address<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> baseVote<span class="token punctuation">.</span><span class="token function">queryAddressHasVote</span><span class="token punctuation">(</span>voteId<span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>智能合约的方法中如果有<code>数组类型</code>的参数，请使用如下方式传递参数</p> <blockquote><p>参考以上投票合约代码中的<code>create</code>方法</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;sender&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;NsdtydTVWskMc7GkZzbsq2FoChqKFwMf&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;password&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;contractAddress&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;NseLt14NacjTDhXaTXUdrk6VF7aEwtW4&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;gasLimit&quot;</span><span class="token punctuation">:</span> <span class="token number">200000</span><span class="token punctuation">,</span>
  <span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span> <span class="token number">10000000000</span><span class="token punctuation">,</span>
  <span class="token string">&quot;methodName&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;create&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;methodDesc&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;remark&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;args&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;测试投票1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;第一个投票合约&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;第一个选项&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;第二个选项&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;第三个选项&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">1536044066056</span><span class="token punctuation">,</span> <span class="token number">1536184066056</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token boolean">false</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-2-standard-token-智能合约代码片段"><a href="#_7-2-standard-token-智能合约代码片段" aria-hidden="true" class="header-anchor">#</a> 7.2 Standard Token 智能合约代码<code>片段</code></h3> <blockquote><p>完整代码: <code>https://github.com/nuls-io/nuls-nrc20</code></p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>token<span class="token punctuation">;</span>

<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Address<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Contract<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Msg<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Required<span class="token punctuation">;</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>View<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>HashMap<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Map<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span>emit<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>Utils<span class="token punctuation">.</span>require<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SimpleToken</span> <span class="token keyword">implements</span> <span class="token class-name">Contract</span><span class="token punctuation">,</span> Token <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> String name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> String symbol<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> decimals<span class="token punctuation">;</span>
    <span class="token keyword">private</span> BigInteger totalSupply <span class="token operator">=</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>

    <span class="token keyword">private</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span> balances <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> Map<span class="token operator">&lt;</span>Address<span class="token punctuation">,</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span> allowed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>Address<span class="token punctuation">,</span> Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> String <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> String <span class="token function">symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> symbol<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">decimals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> decimals<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> BigInteger <span class="token function">totalSupply</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> totalSupply<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">SimpleToken</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> String name<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> String symbol<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger initialAmount<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> <span class="token keyword">int</span> decimals<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>symbol <span class="token operator">=</span> symbol<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>decimals <span class="token operator">=</span> decimals<span class="token punctuation">;</span>
        totalSupply <span class="token operator">=</span> initialAmount<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>TEN<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>decimals<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        balances<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> totalSupply<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TransferEvent</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> totalSupply<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> BigInteger <span class="token function">allowance</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address owner<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span> ownerAllowed <span class="token operator">=</span> allowed<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>owner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ownerAllowed <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        BigInteger value <span class="token operator">=</span> ownerAllowed<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>spender<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            value <span class="token operator">=</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">transferFrom</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address from<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> Address to<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">subtractAllowed</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">subtractBalance</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addBalance</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TransferEvent</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@View</span>
    <span class="token keyword">public</span> BigInteger <span class="token function">balanceOf</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address owner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>owner <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
        BigInteger balance <span class="token operator">=</span> balances<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>owner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>balance <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            balance <span class="token operator">=</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> balance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address to<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">subtractBalance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addBalance</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TransferEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> to<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">approve</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ApprovalEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">increaseApproval</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger addedValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">addAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> addedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ApprovalEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> <span class="token function">allowance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">decreaseApproval</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Required</span> Address spender<span class="token punctuation">,</span> <span class="token annotation punctuation">@Required</span> BigInteger subtractedValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>subtractedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        BigInteger oldValue <span class="token operator">=</span> <span class="token function">allowance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>subtractedValue<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>oldValue<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">subtractAllowed</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> subtractedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ApprovalEvent</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">,</span> <span class="token function">allowance</span><span class="token punctuation">(</span>Msg<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> spender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addAllowed</span><span class="token punctuation">(</span>Address address1<span class="token punctuation">,</span> Address address2<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger allowance <span class="token operator">=</span> <span class="token function">allowance</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>allowance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setAllowed</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">,</span> allowance<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">subtractAllowed</span><span class="token punctuation">(</span>Address address1<span class="token punctuation">,</span> Address address2<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger allowance <span class="token operator">=</span> <span class="token function">allowance</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>allowance<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;Insufficient approved token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setAllowed</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address2<span class="token punctuation">,</span> allowance<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">setAllowed</span><span class="token punctuation">(</span>Address address1<span class="token punctuation">,</span> Address address2<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Map<span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span> address1Allowed <span class="token operator">=</span> allowed<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>address1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>address1Allowed <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            address1Allowed <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics function"><span class="token punctuation">&lt;</span>Address<span class="token punctuation">,</span> BigInteger<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            allowed<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address1<span class="token punctuation">,</span> address1Allowed<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        address1Allowed<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address2<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addBalance</span><span class="token punctuation">(</span>Address address<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger balance <span class="token operator">=</span> <span class="token function">balanceOf</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">&quot;The value must be greater than or equal to 0.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        balances<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> balance<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">subtractBalance</span><span class="token punctuation">(</span>Address address<span class="token punctuation">,</span> BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        BigInteger balance <span class="token operator">=</span> <span class="token function">balanceOf</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>balance<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;Insufficient balance of token.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        balances<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> balance<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value1<span class="token punctuation">,</span> BigInteger value2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>BigInteger<span class="token punctuation">.</span>ZERO<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>BigInteger value1<span class="token punctuation">,</span> BigInteger value2<span class="token punctuation">,</span> String msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">check</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">require</span><span class="token punctuation">(</span>value1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>



<span class="token punctuation">}</span>

</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/nuls-io/devsite/edit/dev/docs/zh/NULS1.0/developerManual.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2019-3-28 00:38:23</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/zh/NULS1.0/startSmartContract.html" class="prev">
          快速入门
        </a></span> <span class="next"><a href="/zh/NULS1.0/GUIForSmartContract.html">
          智能合约钱包操作手册
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.15dd29f7.js" defer></script><script src="/assets/js/149.6671cebe.js" defer></script>
  </body>
</html>
