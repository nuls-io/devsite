<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Advanced Description |  </title>
    <meta name="description" content="Making It Easier To Innovate">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.601feec8.css" as="style"><link rel="preload" href="/assets/js/app.2df9194a.js" as="script"><link rel="preload" href="/assets/js/43.46a6c6ec.js" as="script"><link rel="prefetch" href="/assets/js/10.0c5e14a0.js"><link rel="prefetch" href="/assets/js/100.9bc70f99.js"><link rel="prefetch" href="/assets/js/101.e70e6488.js"><link rel="prefetch" href="/assets/js/102.36d0eeb6.js"><link rel="prefetch" href="/assets/js/103.c48f6d10.js"><link rel="prefetch" href="/assets/js/104.36753511.js"><link rel="prefetch" href="/assets/js/105.d147a0e1.js"><link rel="prefetch" href="/assets/js/106.f182ac7d.js"><link rel="prefetch" href="/assets/js/107.1969c1c9.js"><link rel="prefetch" href="/assets/js/108.c4161ad1.js"><link rel="prefetch" href="/assets/js/109.d2fc6225.js"><link rel="prefetch" href="/assets/js/11.7172d40b.js"><link rel="prefetch" href="/assets/js/110.fc717fd0.js"><link rel="prefetch" href="/assets/js/111.e520750d.js"><link rel="prefetch" href="/assets/js/112.33215634.js"><link rel="prefetch" href="/assets/js/113.9487a4e1.js"><link rel="prefetch" href="/assets/js/114.4af66897.js"><link rel="prefetch" href="/assets/js/115.ed788b3b.js"><link rel="prefetch" href="/assets/js/116.a3aa3f28.js"><link rel="prefetch" href="/assets/js/117.fbb038f5.js"><link rel="prefetch" href="/assets/js/118.410c8a90.js"><link rel="prefetch" href="/assets/js/119.e980ed78.js"><link rel="prefetch" href="/assets/js/12.b157bf5f.js"><link rel="prefetch" href="/assets/js/120.8c80d17f.js"><link rel="prefetch" href="/assets/js/121.119f8321.js"><link rel="prefetch" href="/assets/js/122.2d6bb1e9.js"><link rel="prefetch" href="/assets/js/123.b04b0728.js"><link rel="prefetch" href="/assets/js/124.c6799b6b.js"><link rel="prefetch" href="/assets/js/125.4bed92f5.js"><link rel="prefetch" href="/assets/js/126.1124084b.js"><link rel="prefetch" href="/assets/js/127.3ef53bc0.js"><link rel="prefetch" href="/assets/js/128.ec5465b4.js"><link rel="prefetch" href="/assets/js/129.fa88d4f1.js"><link rel="prefetch" href="/assets/js/13.ded8ed02.js"><link rel="prefetch" href="/assets/js/130.a59920b5.js"><link rel="prefetch" href="/assets/js/131.6f6a30ae.js"><link rel="prefetch" href="/assets/js/132.dd3264be.js"><link rel="prefetch" href="/assets/js/133.9cf69d7d.js"><link rel="prefetch" href="/assets/js/134.044ab96a.js"><link rel="prefetch" href="/assets/js/135.0039ff10.js"><link rel="prefetch" href="/assets/js/136.e2e2a54e.js"><link rel="prefetch" href="/assets/js/137.a805007d.js"><link rel="prefetch" href="/assets/js/138.f1c7f601.js"><link rel="prefetch" href="/assets/js/139.2663676f.js"><link rel="prefetch" href="/assets/js/14.518e22ea.js"><link rel="prefetch" href="/assets/js/140.71976055.js"><link rel="prefetch" href="/assets/js/141.5a61780a.js"><link rel="prefetch" href="/assets/js/142.16220828.js"><link rel="prefetch" href="/assets/js/143.ff3fcc2d.js"><link rel="prefetch" href="/assets/js/144.c59d3810.js"><link rel="prefetch" href="/assets/js/145.84df8247.js"><link rel="prefetch" href="/assets/js/146.db747b14.js"><link rel="prefetch" href="/assets/js/147.e90628dd.js"><link rel="prefetch" href="/assets/js/148.c43ff8fd.js"><link rel="prefetch" href="/assets/js/149.b937fefc.js"><link rel="prefetch" href="/assets/js/15.4b3dc8bd.js"><link rel="prefetch" href="/assets/js/150.99281254.js"><link rel="prefetch" href="/assets/js/151.c38d135d.js"><link rel="prefetch" href="/assets/js/152.754bf6a4.js"><link rel="prefetch" href="/assets/js/16.13d0211e.js"><link rel="prefetch" href="/assets/js/17.f6e10861.js"><link rel="prefetch" href="/assets/js/18.cb2593a2.js"><link rel="prefetch" href="/assets/js/19.4edbd542.js"><link rel="prefetch" href="/assets/js/2.3da0e489.js"><link rel="prefetch" href="/assets/js/20.88ddbd1c.js"><link rel="prefetch" href="/assets/js/21.faa96d43.js"><link rel="prefetch" href="/assets/js/22.38f942c3.js"><link rel="prefetch" href="/assets/js/23.3f297858.js"><link rel="prefetch" href="/assets/js/24.f60196ef.js"><link rel="prefetch" href="/assets/js/25.36c9da09.js"><link rel="prefetch" href="/assets/js/26.2019d528.js"><link rel="prefetch" href="/assets/js/27.ebe9591a.js"><link rel="prefetch" href="/assets/js/28.8a71b3ce.js"><link rel="prefetch" href="/assets/js/29.761f1315.js"><link rel="prefetch" href="/assets/js/3.3b28a50c.js"><link rel="prefetch" href="/assets/js/30.0d78fd34.js"><link rel="prefetch" href="/assets/js/31.455baee2.js"><link rel="prefetch" href="/assets/js/32.ee627427.js"><link rel="prefetch" href="/assets/js/33.ce1f9222.js"><link rel="prefetch" href="/assets/js/34.da477209.js"><link rel="prefetch" href="/assets/js/35.61d6313b.js"><link rel="prefetch" href="/assets/js/36.45ef79c2.js"><link rel="prefetch" href="/assets/js/37.8d584f1f.js"><link rel="prefetch" href="/assets/js/38.5daa3c2b.js"><link rel="prefetch" href="/assets/js/39.3fee31fb.js"><link rel="prefetch" href="/assets/js/4.9bf7c824.js"><link rel="prefetch" href="/assets/js/40.64ebbb72.js"><link rel="prefetch" href="/assets/js/41.0caac018.js"><link rel="prefetch" href="/assets/js/42.e9a0686e.js"><link rel="prefetch" href="/assets/js/44.71db9aeb.js"><link rel="prefetch" href="/assets/js/45.8420eebd.js"><link rel="prefetch" href="/assets/js/46.3ffccd37.js"><link rel="prefetch" href="/assets/js/47.0dc8e60f.js"><link rel="prefetch" href="/assets/js/48.4a25340b.js"><link rel="prefetch" href="/assets/js/49.81251dda.js"><link rel="prefetch" href="/assets/js/5.f8fa80eb.js"><link rel="prefetch" href="/assets/js/50.7a68e1b2.js"><link rel="prefetch" href="/assets/js/51.810ace8e.js"><link rel="prefetch" href="/assets/js/52.3fb11e5b.js"><link rel="prefetch" href="/assets/js/53.51e1b163.js"><link rel="prefetch" href="/assets/js/54.a193919b.js"><link rel="prefetch" href="/assets/js/55.ed77a75a.js"><link rel="prefetch" href="/assets/js/56.cf8d783d.js"><link rel="prefetch" href="/assets/js/57.0c17175b.js"><link rel="prefetch" href="/assets/js/58.3ddb5f2e.js"><link rel="prefetch" href="/assets/js/59.68a213bb.js"><link rel="prefetch" href="/assets/js/6.1c8f1000.js"><link rel="prefetch" href="/assets/js/60.a0636ebc.js"><link rel="prefetch" href="/assets/js/61.fc72f2e7.js"><link rel="prefetch" href="/assets/js/62.4fa897e2.js"><link rel="prefetch" href="/assets/js/63.2d20b2a2.js"><link rel="prefetch" href="/assets/js/64.d5daa534.js"><link rel="prefetch" href="/assets/js/65.594e30f7.js"><link rel="prefetch" href="/assets/js/66.a868f08c.js"><link rel="prefetch" href="/assets/js/67.611d69ab.js"><link rel="prefetch" href="/assets/js/68.2ecfeb2d.js"><link rel="prefetch" href="/assets/js/69.299a4679.js"><link rel="prefetch" href="/assets/js/7.6ddd6e53.js"><link rel="prefetch" href="/assets/js/70.db68d2a2.js"><link rel="prefetch" href="/assets/js/71.ce42dcd6.js"><link rel="prefetch" href="/assets/js/72.38ac2674.js"><link rel="prefetch" href="/assets/js/73.bd7f9811.js"><link rel="prefetch" href="/assets/js/74.0afd81ce.js"><link rel="prefetch" href="/assets/js/75.e3619d1c.js"><link rel="prefetch" href="/assets/js/76.2d0d598d.js"><link rel="prefetch" href="/assets/js/77.92f479e8.js"><link rel="prefetch" href="/assets/js/78.95fc9d7c.js"><link rel="prefetch" href="/assets/js/79.bfd42746.js"><link rel="prefetch" href="/assets/js/8.57bc7818.js"><link rel="prefetch" href="/assets/js/80.79249f41.js"><link rel="prefetch" href="/assets/js/81.94e759cb.js"><link rel="prefetch" href="/assets/js/82.0808b875.js"><link rel="prefetch" href="/assets/js/83.84b2875f.js"><link rel="prefetch" href="/assets/js/84.bfc04846.js"><link rel="prefetch" href="/assets/js/85.b8453670.js"><link rel="prefetch" href="/assets/js/86.53298a14.js"><link rel="prefetch" href="/assets/js/87.332e1ec8.js"><link rel="prefetch" href="/assets/js/88.eec1ee38.js"><link rel="prefetch" href="/assets/js/89.9de51cb3.js"><link rel="prefetch" href="/assets/js/9.9b98df55.js"><link rel="prefetch" href="/assets/js/90.93579a5d.js"><link rel="prefetch" href="/assets/js/91.9494f211.js"><link rel="prefetch" href="/assets/js/92.f3f4a19f.js"><link rel="prefetch" href="/assets/js/93.fb09d292.js"><link rel="prefetch" href="/assets/js/94.396b8118.js"><link rel="prefetch" href="/assets/js/95.df06706e.js"><link rel="prefetch" href="/assets/js/96.46d03f61.js"><link rel="prefetch" href="/assets/js/97.1aaa0edd.js"><link rel="prefetch" href="/assets/js/98.56c53e9d.js"><link rel="prefetch" href="/assets/js/99.09ea7286.js">
    <link rel="stylesheet" href="/assets/css/0.styles.601feec8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name"> </span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Guide/" class="nav-link">Guide</a></div><div class="nav-item"><a href="/Docs/" class="nav-link router-link-active">Develop</a></div><div class="nav-item"><a href="/ENULS/" class="nav-link">ENULS</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Docs/s_advance.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/Docs/s_advance.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/nuls-io/devsite/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Guide/" class="nav-link">Guide</a></div><div class="nav-item"><a href="/Docs/" class="nav-link router-link-active">Develop</a></div><div class="nav-item"><a href="/ENULS/" class="nav-link">ENULS</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Docs/s_advance.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/Docs/s_advance.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/nuls-io/devsite/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Module Design</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Docs/d_network.html" class="sidebar-link">Network module design document</a></li><li><a href="/Docs/d_ledger.html" class="sidebar-link">Design document of ledger module</a></li><li><a href="/Docs/d_chain_manager.html" class="sidebar-link">Chain Management Module Design Document</a></li><li><a href="/Docs/d_account.html" class="sidebar-link">Account Module Design Document</a></li><li><a href="/Docs/d_smart_contract.html" class="sidebar-link">Smart contract module design</a></li><li><a href="/Docs/d_transaction.html" class="sidebar-link">Transaction management module Design document</a></li><li><a href="/Docs/d_cross_chain.html" class="sidebar-link">Overall description</a></li><li><a href="/Docs/d_consensus.html" class="sidebar-link">Consensus Module Design Document</a></li><li><a href="/Docs/d_public_service.html" class="sidebar-link">Public-Service Module Design Document</a></li><li><a href="/Docs/d_block.html" class="sidebar-link">Block Management Module Design Document</a></li><li><a href="/Docs/d_protocol_update.html" class="sidebar-link">Upgrade module design document</a></li><li><a href="/Docs/d_address.html" class="sidebar-link">NULS Protocol Address</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Interface</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Docs/i_rpc_protocol.html" class="sidebar-link">NULS Application Interface Services</a></li><li><a href="/Docs/i_public_service.html" class="sidebar-link">Public Service</a></li><li><a href="/Docs/i_nuls-api_JSONRPC.html" class="sidebar-link">API-JSONRPC</a></li><li><a href="/Docs/i_nuls-api_RESTFUL.html" class="sidebar-link">API-RESTFUL</a></li><li><a href="/Docs/i_account.html" class="sidebar-link">Account Module</a></li><li><a href="/Docs/i_chain-manager.html" class="sidebar-link">Why should I have the Chain Management module?</a></li><li><a href="/Docs/i_cross-chain.html" class="sidebar-link">Interface List</a></li><li><a href="/Docs/i_network.html" class="sidebar-link">Why should I have &quot;Network Module&quot;?</a></li><li><a href="/Docs/i_block.html" class="sidebar-link">Block Module</a></li><li><a href="/Docs/i_transaction.html" class="sidebar-link">Transaction module</a></li><li><a href="/Docs/i_consensus.html" class="sidebar-link">poc Consensus Module</a></li><li><a href="/Docs/i_smart-contract.html" class="sidebar-link">Smart contract module</a></li><li><a href="/Docs/i_ledger.html" class="sidebar-link">Ledger Module</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>ChainBox</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Docs/c_chain_box.html" class="sidebar-link">NULS ChainBox</a></li><li><a href="/Docs/c_module.html" class="sidebar-link">Develope Module</a></li><li><a href="/Docs/c_message_module.html" class="sidebar-link">Encrypted Message Module Demo</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Smart Contract</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Docs/s_manual.html" class="sidebar-link">Development Manual</a></li><li><a href="/Docs/s_tools.html" class="sidebar-link">Development Tool</a></li><li><a href="/Docs/s_nrc20.html" class="sidebar-link">NRC-20</a></li><li><a href="/Docs/s_nrc721.html" class="sidebar-link">NRC-721</a></li><li><a href="/Docs/s_offline_assembly.html" class="sidebar-link">Smart contract offline assembly</a></li><li><a href="/Docs/s_advance.html" aria-current="page" class="active sidebar-link">Advanced Description</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#i-smart-contract-fee" class="sidebar-link">I. Smart Contract Fee</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_1-who-pays-for-the-smart-contract-fee" class="sidebar-link">1. Who pays for the smart contract fee?</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_2-how-to-charge-for-smart-contract-fees-how-to-charge-how-much-does-the-interface-caller-pay-who-received-these-fees" class="sidebar-link">2. How to charge for smart contract fees, how to charge? How much does the interface caller pay? Who received these fees?</a></li></ul></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#ii-how-to-debug-smart-contracts" class="sidebar-link">II. how to debug smart contracts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_1-debugging-way" class="sidebar-link">1. Debugging way</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_2-contract-code-example" class="sidebar-link">2. Contract code example</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_3-example-of-execution-failure" class="sidebar-link">3.  Example of execution failure</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_4-example-of-successful-execution" class="sidebar-link">4. Example of successful execution</a></li></ul></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#iii-transaction-instructions-for-transferring-contracts-to-nuls-assets" class="sidebar-link">III. Transaction instructions for transferring contracts to nuls assets</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_1-transfer-to-implementation" class="sidebar-link">1. Transfer to implementation</a></li></ul></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#iv-contract-transfers-nuls-out" class="sidebar-link">IV. Contract transfers NULS out</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_1-transfer-out-implementation" class="sidebar-link">1. Transfer out implementation</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_2-results-query" class="sidebar-link">2. Results query</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_3-complete-transaction-serialization-data-query" class="sidebar-link">3.Complete transaction serialization data query</a></li></ul></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#v-contract-execution-result-description" class="sidebar-link">V. Contract execution result description</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_1-description-of-execution-results" class="sidebar-link">1. Description of execution results</a></li></ul></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#vi-triggering-the-scene-of-the-payable-method" class="sidebar-link">VI. Triggering the scene of the payable method</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_1-the-official-wallet-transfer-function-triggered-when-the-account-address-is-transferred-to-the-contract-address" class="sidebar-link">1. the official wallet transfer function, triggered when the account address is transferred to the contract address</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_2-the-consensus-node-reward-address-is-the-contract-address-triggered-when-the-current-node-is-out-of-the-block" class="sidebar-link">2. the consensus node reward address is the contract address, triggered when the current node is out of the block.</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_3-the-entrusted-address-is-the-contract-address-which-is-triggered-when-there-is-a-current-contract-address-in-the-block-reward" class="sidebar-link">3. The entrusted address is the contract address, which is triggered when there is a current contract address in the block reward.</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_4-triggered-when-the-user-directly-calls-the-payable-method-of-the-contract" class="sidebar-link">4. Triggered when the user directly calls the _payable() method of the contract</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#note-the-payable-string-args-method-is-a-system-call-method-that-the-user-cannot-call" class="sidebar-link">Note: The _payable(String[][] args) method is a system call method that the user cannot call.</a></li></ul></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#vii-contract-call-external-command-description" class="sidebar-link">VII. Contract Call External Command Description</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_1-the-function-of-generating-contract-consensus-transactions" class="sidebar-link">1. The function of generating contract consensus transactions</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_2-query-consensus-data" class="sidebar-link">2. Query consensus data</a></li></ul></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#viii-contract-consensus-transaction-description" class="sidebar-link">VIII. Contract Consensus Transaction Description</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_1-generate-contract-consensus-transactions" class="sidebar-link">1. Generate contract consensus transactions</a></li><li class="sidebar-sub-header"><a href="/Docs/s_advance.html#_2-how-to-obtain-contract-consensus-transaction-data" class="sidebar-link">2. How to obtain contract consensus transaction data</a></li></ul></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="advanced-description"><a href="#advanced-description" class="header-anchor">#</a> Advanced Description</h1> <h2 id="i-smart-contract-fee"><a href="#i-smart-contract-fee" class="header-anchor">#</a> I. Smart Contract Fee</h2> <h3 id="_1-who-pays-for-the-smart-contract-fee"><a href="#_1-who-pays-for-the-smart-contract-fee" class="header-anchor">#</a> 1. Who pays for the smart contract fee?</h3> <p>When <code>Create Smart Contracts</code>, <code>Call Smart Contracts</code>, <code>Delete Smart Contracts</code>, the handling fee is paid by the address at which the transaction is initiated, and the contract address itself does not pay the handling fee.</p> <h3 id="_2-how-to-charge-for-smart-contract-fees-how-to-charge-how-much-does-the-interface-caller-pay-who-received-these-fees"><a href="#_2-how-to-charge-for-smart-contract-fees-how-to-charge-how-much-does-the-interface-caller-pay-who-received-these-fees" class="header-anchor">#</a> 2. How to charge for smart contract fees, how to charge? How much does the interface caller pay? Who received these fees?</h3> <p>In the main chain, there are three more types of transactions, <code>Create Smart Contracts</code>, <code>Call Smart Contracts</code>, <code>Delete Smart Contracts</code>.</p> <p>The difference between the three transactions and other transactions such as `transfer&quot; lies in the execution of one smart contract, so the execution of smart contracts is also one of the charging standards.</p> <ul><li>Smart contract charging calculation method</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> COMPARISON <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//Compare bytecode</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> CONSTANT <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//simple numeric type bytecode</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> LDC <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">/</span> <span class="token operator">/</span> numeric constant<span class="token punctuation">,</span> string constant <span class="token punctuation">(</span>length <span class="token operator">*</span> LDC<span class="token punctuation">)</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> CONTROL <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token comment">//control bytecode</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> TABLESWITCH <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// switch bytecode (size * TABLESWITCH)</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> LOOKUPSWITCH <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// switch bytecode (size * LOOKUPSWITCH)</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> CONVERSION <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//Value conversion</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> EXTENDED <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//null</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MULTIANEWARRAY <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//Multidimensional array (size * MULTIANEWARRAY)</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> LOAD <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">/</span> <span class="token operator">/</span> send local variables <span class="token keyword">to</span> <span class="token namespace">the</span> top of the stack
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> ARRAYLOAD <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token comment">//Send an item of the array to the top of the stack</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MATH <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//Mathematical operations and shift operations</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> REFERENCE <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//object related operations</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> NEWARRAY <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//One-dimensional array (size * NEWARRAY)</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> STACK <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token operator">/</span> <span class="token operator">/</span> stack operation
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> STORE <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//Save the value of the top of the stack to a local variable</span>
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> ARRAYSTORE <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token operator">/</span> <span class="token operator">/</span> store the value of the stack item into the array
<span class="token class-name">Public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> TRANSFER <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span><span class="token comment">//transfer transaction</span>

</code></pre></div><ul><li><p>One smart contract total handling fee</p> <p>The total handling fee for a contract transaction consists of three parts</p> <ul><li><p>The first part is the transaction fee generated by the transaction size, calculated according to the byte size -&gt; 0.001nuls/kb, which is 0.001 nuls per 1000 bytes, the transaction size is less than 1000 bytes, and the charge is 0.001 nuls.</p></li> <li><p>The second part is the GAS*Price consumed by the contract execution. Price is the unit price, which means how much Na is for each Gas, Na is the smallest unit of NULS, 1Nuls is 100 million Na.</p></li></ul> <blockquote><p>For example, if a contract execution consumes 20,000Gas and the set price is 30Na/Gas, then the Na consumed this time is <code>20000 * 30 = 600000</code>, which is 0.006NULS</p></blockquote> <ul><li>The third part is that the GasLimit set by the caller is not consumed by the current contract execution, and the remaining Gas will be returned by the contract GAS return transaction.</li></ul> <blockquote><p>For example, the last chestnut, the GasLimit set for the contract is 30000Gas, and the contract execution consumes 20,000Gas, then the remaining 10000Gas, the 10000Gas converted to Na is <code>10000 * 30 = 300000</code>, which is 0.003NULS, then this 0.003NULS will return the contract caller in the contract GAS return transaction of the current packaged block</p></blockquote></li> <li><p>How much does the contract caller pay?</p> <p>In the contract transaction, the contract caller pays the first, second and third parts. In fact, the contract caller pays the first and second parts, because the third part will be returned to the contract call in the contract gas return transaction of the current packaged block. By</p></li> <li><p>Who received these fees?</p> <p>The block packer receives the first and second part of the fee, and the contract caller receives the third part of the fee.</p></li></ul> <h2 id="ii-how-to-debug-smart-contracts"><a href="#ii-how-to-debug-smart-contracts" class="header-anchor">#</a> II. how to debug smart contracts</h2> <p>The contract SDK provides a DebugEvent. If the contract fails to execute, you can see the data of this event. Use it to debug the contract.</p> <h3 id="_1-debugging-way"><a href="#_1-debugging-way" class="header-anchor">#</a> 1. Debugging way</h3> <p>When writing a contract, use the <code>emit(new DebugEvent(&quot;name&quot;, &quot;desc&quot;))</code> event to send it. After the contract is released, the contract method is called.</p> <p>If the execution is successful, the debugEvent data will be displayed in the contract execution result.</p> <p>If the execution fails, the debug event data will be displayed in the returned error data.</p> <p><b style="color:red">Note: Each time you call a contract, you can display up to 10 DebugEvents, and the excess will be ignored by the Smart Contract VM. </b></p> <h3 id="_2-contract-code-example"><a href="#_2-contract-code-example" class="header-anchor">#</a> 2. Contract code example</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * Example of successful call (test network)
 */</span>
<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">clinitTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Address</span> temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Address</span><span class="token punctuation">(</span><span class="token string">&quot;tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> asd <span class="token operator">=</span> <span class="token string">&quot;tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DebugEvent</span><span class="token punctuation">(</span><span class="token string">&quot;clinitTest log&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;asd is &quot;</span> <span class="token operator">+</span> asd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> qwe <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DebugEvent</span><span class="token punctuation">(</span><span class="token string">&quot;clinitTest log 1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;temp is &quot;</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Example of call failure (test net)
 */</span>
<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">clinitTestRevert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Address</span> temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Address</span><span class="token punctuation">(</span><span class="token string">&quot;tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> asd <span class="token operator">=</span> <span class="token string">&quot;tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DebugEvent</span><span class="token punctuation">(</span><span class="token string">&quot;clinitTest log&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;asd is &quot;</span> <span class="token operator">+</span> asd<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> qwe <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DebugEvent</span><span class="token punctuation">(</span><span class="token string">&quot;clinitTest log 1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;temp is &quot;</span> <span class="token operator">+</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// failed</span>
    <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">revert</span><span class="token punctuation">(</span><span class="token string">&quot;revert&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-example-of-execution-failure"><a href="#_3-example-of-execution-failure" class="header-anchor">#</a> 3.  Example of execution failure</h3> <p>When the execution fails, the debugEvent data is displayed in the error message.</p> <p>As in the above contract, we use <code>revert(&quot;revert&quot;)</code> in the <code>clinitTestRevert</code> method to make this call fail to execute, and return the DebugEvent event data if the simulation fails.</p> <h4 id="_3-1-error-data-returned-by-page-call-failure"><a href="#_3-1-error-data-returned-by-page-call-failure" class="header-anchor">#</a> 3.1 Error data returned by page call failure</h4> <p><img src="/assets/img/debugcontract.e38fe738.png" alt></p> <h4 id="_3-2-nuls-api-restful-mode-call-failed-error-data-returned"><a href="#_3-2-nuls-api-restful-mode-call-failed-error-data-returned" class="header-anchor">#</a> 3.2 <code>NULS-API RESTFUL</code> mode call failed error data returned</h4> <p><code>http://beta.api.nuls.io/api/contract/call</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;sender&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMiKUm9zpU1bhXeaaZt2AdLgPTs3T28&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;gasLimit&quot;</span> <span class="token operator">:</span> <span class="token number">200000</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
    <span class="token property">&quot;password&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;abc123456&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;remark&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;remark-restful-call&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;contractAddress&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;tNULSeBaNA416GsttuWmWJwHrgJ8KfWzVw4LQR&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;methodName&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;clinitTestRevert&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;methodDesc&quot;</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">&quot;args&quot;</span> <span class="token operator">:</span> <span class="token null keyword">null</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;success&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;err_0014&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;contract error - revert, debugEvents: [{\&quot;contractAddress\&quot;:\&quot;tNULSeBaNA416GsttuWmWJwHrgJ8KfWzVw4LQR\&quot;,\&quot;blockNumber\&quot;:201112,\&quot;event\&quot;:\&quot;DebugEvent\&quot;,\&quot;payload\&quot;:{\&quot;name\&quot;:\&quot;clinitTest log\&quot;,\&quot;desc\&quot;:\&quot;asd is tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD\&quot;}}, {\&quot;contractAddress\&quot;:\&quot;tNULSeBaNA416GsttuWmWJwHrgJ8KfWzVw4LQR\&quot;,\&quot;blockNumber\&quot;:201112,\&quot;event\&quot;:\&quot;DebugEvent\&quot;,\&quot;payload\&quot;:{\&quot;name\&quot;:\&quot;clinitTest log 1\&quot;,\&quot;desc\&quot;:\&quot;temp is tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD\&quot;}}]&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-3-nuls-api-jsonrpc-mode-call-failed-error-data-returned"><a href="#_3-3-nuls-api-jsonrpc-mode-call-failed-error-data-returned" class="header-anchor">#</a> 3.3 <code>NULS-API JSONRPC</code> mode call failed error data returned</h4> <p><code>http://beta.api.nuls.io/jsonrpc</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;jsonrpc&quot;</span><span class="token operator">:</span><span class="token string">&quot;2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;method&quot;</span><span class="token operator">:</span><span class="token string">&quot;contractCall&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token string">&quot;tNULSeBaMiKUm9zpU1bhXeaaZt2AdLgPTs3T28&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;abc123456&quot;</span><span class="token punctuation">,</span>
                <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token number">200000</span><span class="token punctuation">,</span>
                <span class="token number">25</span><span class="token punctuation">,</span>
                <span class="token string">&quot;tNULSeBaNA416GsttuWmWJwHrgJ8KfWzVw4LQR&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;clinitTestRevert&quot;</span><span class="token punctuation">,</span>
                <span class="token null keyword">null</span><span class="token punctuation">,</span>
                <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string">&quot;remark-jsonrpc-call&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token number">1234</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;jsonrpc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1234&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;err_0014&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;contract error - revert, debugEvents: [{\&quot;contractAddress\&quot;:\&quot;tNULSeBaNA416GsttuWmWJwHrgJ8KfWzVw4LQR\&quot;,\&quot;blockNumber\&quot;:194030,\&quot;event\&quot;:\&quot;DebugEvent\&quot;,\&quot;payload\&quot;:{\&quot;name\&quot;:\&quot;clinitTest log\&quot;,\&quot;desc\&quot;:\&quot;asd is tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD\&quot;}}, {\&quot;contractAddress\&quot;:\&quot;tNULSeBaNA416GsttuWmWJwHrgJ8KfWzVw4LQR\&quot;,\&quot;blockNumber\&quot;:194030,\&quot;event\&quot;:\&quot;DebugEvent\&quot;,\&quot;payload\&quot;:{\&quot;name\&quot;:\&quot;clinitTest log 1\&quot;,\&quot;desc\&quot;:\&quot;temp is tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD\&quot;}}]&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-example-of-successful-execution"><a href="#_4-example-of-successful-execution" class="header-anchor">#</a> 4. Example of successful execution</h3> <p>In the case of successful execution, the data of the debugEvent will also be displayed in the contract execution result.</p> <p>http://beta.api.nuls.io/api/contract/result/1aaab3e9453468dd1a4569d0d6d9887b636ee2438671746332125ac6e44ae409</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;success&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;flag&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;success&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">&quot;errorMessage&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">&quot;contractAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tNULSeBaNA416GsttuWmWJwHrgJ8KfWzVw4LQR&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;gasLimit&quot;</span><span class="token operator">:</span> <span class="token number">6081</span><span class="token punctuation">,</span>
            <span class="token property">&quot;gasUsed&quot;</span><span class="token operator">:</span> <span class="token number">4054</span><span class="token punctuation">,</span>
            <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
            <span class="token property">&quot;totalFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;252025&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;txSizeFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;100000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;actualContractFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;101350&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;refundFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;50675&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;stackTrace&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">&quot;transfers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;events&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;{\&quot;contractAddress\&quot;:\&quot;tNULSeBaNA416GsttuWmWJwHrgJ8KfWzVw4LQR\&quot;,\&quot;blockNumber\&quot;:194018,\&quot;event\&quot;:\&quot;TempEvent\&quot;,\&quot;payload\&quot;:{\&quot;temp\&quot;:\&quot;123\&quot;}}&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;debugEvents&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;{\&quot;contractAddress\&quot;:\&quot;tNULSeBaNA416GsttuWmWJwHrgJ8KfWzVw4LQR\&quot;,\&quot;blockNumber\&quot;:194018,\&quot;event\&quot;:\&quot;DebugEvent\&quot;,\&quot;payload\&quot;:{\&quot;name\&quot;:\&quot;clinitTest log\&quot;,\&quot;desc\&quot;:\&quot;asd is tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD\&quot;}}&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;{\&quot;contractAddress\&quot;:\&quot;tNULSeBaNA416GsttuWmWJwHrgJ8KfWzVw4LQR\&quot;,\&quot;blockNumber\&quot;:194018,\&quot;event\&quot;:\&quot;DebugEvent\&quot;,\&quot;payload\&quot;:{\&quot;name\&quot;:\&quot;clinitTest log 1\&quot;,\&quot;desc\&quot;:\&quot;temp is tNULSeBaMnrs6JKrCy6TQdzYJZkMZJDng7QAsD\&quot;}}&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;tokenTransfers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;invokeRegisterCmds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;contractTxList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;call&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="iii-transaction-instructions-for-transferring-contracts-to-nuls-assets"><a href="#iii-transaction-instructions-for-transferring-contracts-to-nuls-assets" class="header-anchor">#</a> III. Transaction instructions for transferring contracts to nuls assets</h2> <p>Ordinary account address, to the contract into the nuls, must be achieved through the `call contract' transaction</p> <p><strong>Call contract parameter list</strong></p> <table><thead><tr><th>Parameter Name</th> <th style="text-align:center">Parameter Type</th> <th>Parameter Description</th> <th style="text-align:center">Required</th></tr></thead> <tbody><tr><td>chainId</td> <td style="text-align:center">int</td> <td>chain id</td> <td style="text-align:center">yes</td></tr> <tr><td>sender</td> <td style="text-align:center">string</td> <td>Transaction Creator Account Address</td> <td style="text-align:center">Yes</td></tr> <tr><td>password</td> <td style="text-align:center">string</td> <td>caller account password</td> <td style="text-align:center">yes</td></tr> <tr><td>value</td> <td style="text-align:center">biginteger</td> <td>The amount of the primary network asset that the caller transferred to the contract address. If there is no such service, fill BigInteger.ZERO</td> <td style="text-align:center">Yes</td></tr> <tr><td>gasLimit</td> <td style="text-align:center">long</td> <td>GAS Limit</td> <td style="text-align:center">Yes</td></tr> <tr><td>price</td> <td style="text-align:center">long</td> <td>GAS unit price</td> <td style="text-align:center">Yes</td></tr> <tr><td>contractAddress</td> <td style="text-align:center">string</td> <td>contract address</td> <td style="text-align:center">yes</td></tr> <tr><td>methodName</td> <td style="text-align:center">string</td> <td>contract method</td> <td style="text-align:center">yes</td></tr> <tr><td>methodDesc</td> <td style="text-align:center">string</td> <td>Contract method description, if the method in the contract is not overloaded, this parameter can be empty</td> <td style="text-align:center">No</td></tr> <tr><td>args</td> <td style="text-align:center">object[]</td> <td>List of parameters</td> <td style="text-align:center">No</td></tr> <tr><td>remark</td> <td style="text-align:center">string</td> <td>Transaction Notes</td> <td style="text-align:center">No</td></tr></tbody></table> <h3 id="_1-transfer-to-implementation"><a href="#_1-transfer-to-implementation" class="header-anchor">#</a> 1. Transfer to implementation</h3> <p>You can transfer the contract to NULS by filling in the corresponding amount in the <code>value</code> of the calling contract parameter.</p> <p>Example of nuls-api restful request method:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sender&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMvEtDfvZuukDf2mVyfGo3DdiN8KLRG&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;gasLimit&quot;</span> <span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;nuls123456&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;remark&quot;</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contractAddress&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMx7J2im9edmmyZofHoTWW6nCTbvy3K&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// Fill in the NULS to be transferred here, the unit is Na</span>
  <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token number">3600000000</span><span class="token punctuation">,</span>
  <span class="token property">&quot;methodName&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;transferToContractTest&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;methodDesc&quot;</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
  <span class="token property">&quot;args&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;method parameter&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the above example, the general account <code>tNULSeBaMvEtDfvZuukDf2mVyfGo3DdiN8KLRG</code> transferred 36 NULS to the contract address <code>tNULSeBaMx7J2im9edmmyZofHoTWW6nCTbvy3K</code>.</p> <p><b style="color:red">Note: The contract method invoked must be marked with a Payable annotation, otherwise the system will directly reject the transaction.</b></p> <p>Contract code - method implementation is as follows</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * Mark @Payable method to pass NULS amount when calling
 */</span>
<span class="token annotation punctuation">@Payable</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transferToContractTest</span><span class="token punctuation">(</span><span class="token class-name">String</span> storedData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The NULS that the caller transferred to the contract, the unit is Na</span>
    <span class="token class-name">BigInteger</span> value <span class="token operator">=</span> <span class="token class-name">Msg</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The contract uses the <code>Msg.value()</code> to get the NULS that the caller transferred to the contract. The unit is Na, as in the above code.</p> <h2 id="iv-contract-transfers-nuls-out"><a href="#iv-contract-transfers-nuls-out" class="header-anchor">#</a> IV. Contract transfers NULS out</h2> <p><strong>Transaction type txType = 18</strong></p> <h3 id="_1-transfer-out-implementation"><a href="#_1-transfer-out-implementation" class="header-anchor">#</a> 1. Transfer out implementation</h3> <p>In the contract SDK, there is a method in the Address object.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * Contract transfers to this address
 *
 * @param value Transfer amount (how many Na)
 */</span>
<span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">BigInteger</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>When this method is executed within the smart contract method, the contract will transfer the corresponding asset to the specified Address, as shown in the following example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Instantiate an Address object based on the account address</span>
<span class="token class-name">Address</span> recipient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Address</span><span class="token punctuation">(</span><span class="token string">&quot;NULSd6HgkSpgKw3jqgbzNZ4FPodG4LEReq8cw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Transfer 18 nuls to this account address</span>
recipient<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">BigInteger</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">1800000000L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="_2-results-query"><a href="#_2-results-query" class="header-anchor">#</a> 2. Results query</h3> <p>If NULS is transferred from the contract address, it will be reflected in the execution result of the contract. Each contract transfer is displayed in the <code>transfers</code> array object in the result. The data displayed here is only the summary information of the contract transfer transaction.</p> <p>Example: The <code>transfers</code> array object that intercepts the contract execution result is as follows</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
<span class="token property">&quot;transfers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;txHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4396f990e6a006ae6235b478dc43845ff0a6cc8ed9f8aefeebf22da2c4cc40be&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NULSd6HgxKNk8JphHPWwooweisGWWRaYdXwFB&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7300000000000&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NULSd6HgaNEJZBt2ABKA9gt6qvRTeb6aMeToV&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7300000000000&quot;</span><span class="token punctuation">,</span>
                lockTime<span class="token operator">:</span> <span class="token number">0</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;orginTxHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2b442ab01650c8848a3ad0535a28979a0cd207e84e133edc05fb391523591c57&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-complete-transaction-serialization-data-query"><a href="#_3-complete-transaction-serialization-data-query" class="header-anchor">#</a> 3.Complete transaction serialization data query</h3> <h4 id="trading-background"><a href="#trading-background" class="header-anchor">#</a> Trading background</h4> <p><b style="color:red">Note: This type of transaction is not included in <code>block</code> because it is not broadcast on the node network.</b></p> <p>Each node that receives the smart contract transaction executes the smart contract and saves the execution result on its own node. When all the contract transactions in a block are executed, a <code>stateRoot</code> will be generated. This <code>stateRoot</code> will be in the <code>block.</code>Broadcast.</p> <h4 id="inquiry-mode"><a href="#inquiry-mode" class="header-anchor">#</a> inquiry mode</h4> <p>The complete transaction serialization data is also included in the contract execution result. The <code>transfers</code> array object in the result will contain the contract NULS asset transfer data generated after the execution of the contract. In addition, the prefix of <code>1200</code> in <code>contractTxList</code> is the serialized string of the contract NULS transfer transaction.</p> <p>The following is the result of the execution of the contract nuls asset transfer transaction</p> <blockquote><p>via <code>RESTFUL</code> interface<code>/api/contract/result/{hash}</code></p> <p>or</p> <p>Request data via <code>JSONRPC</code> interface <code>getContractTxResult</code>:</p></blockquote> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
<span class="token property">&quot;jsonrpc&quot;</span><span class="token operator">:</span><span class="token string">&quot;2.0&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;method&quot;</span><span class="token operator">:</span><span class="token string">&quot;getContractTxResult&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>chainId<span class="token punctuation">,</span> hash<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token number">1234</span>
<span class="token punctuation">}</span>
</code></pre></div><p>eg.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;jsonrpc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1234&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;success&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;errorMessage&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;contractAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NULSd6HgxKNk8JphHPWwooweisGWWRaYdXwFB&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;gasLimit&quot;</span><span class="token operator">:</span> <span class="token number">23943</span><span class="token punctuation">,</span>
        <span class="token property">&quot;gasUsed&quot;</span><span class="token operator">:</span> <span class="token number">15962</span><span class="token punctuation">,</span>
        <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
        <span class="token property">&quot;totalFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;698575&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;txSizeFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;100000&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;actualContractFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;399050&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;refundFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;199525&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;stackTrace&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">&quot;transfers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;txHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4396f990e6a006ae6235b478dc43845ff0a6cc8ed9f8aefeebf22da2c4cc40be&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NULSd6HgxKNk8JphHPWwooweisGWWRaYdXwFB&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7300000000000&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                        <span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NULSd6HgaNEJZBt2ABKA9gt6qvRTeb6aMeToV&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7300000000000&quot;</span><span class="token punctuation">,</span>
                        <span class="token property">&quot;lockTime&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token property">&quot;orginTxHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2b442ab01650c8848a3ad0535a28979a0cd207e84e133edc05fb391523591c57&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;multyAssetTransfers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;events&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;{\&quot;contractAddress\&quot;:\&quot;NULSd6HgxKNk8JphHPWwooweisGWWRaYdXwFB\&quot;,\&quot;blockNumber\&quot;:8783354,\&quot;event\&quot;:\&quot;TransferFunds\&quot;,\&quot;payload\&quot;:{\&quot;to\&quot;:\&quot;NULSd6HgaNEJZBt2ABKA9gt6qvRTeb6aMeToV\&quot;,\&quot;amount\&quot;:\&quot;7300000000000\&quot;,\&quot;transactionId\&quot;:\&quot;2\&quot;}}&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;debugEvents&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;tokenTransfers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;token721Transfers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;invokeRegisterCmds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;contractTxList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;12003af6bc6200372b442ab01650c8848a3ad0535a28979a0cd207e84e133edc05fb391523591c57010002cea54e160723e1ff9650b4b58f066b5fd0403d838c0117010002cea54e160723e1ff9650b4b58f066b5fd0403d83010001000028e8a9a306000000000000000000000000000000000000000000000000000008667f77683a8db0c200011701000169ac629528b8c6c7f1b9f4f11ca90474e4f9220c010001000028e8a9a3060000000000000000000000000000000000000000000000000000000000000000000000&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;call&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;internalCreates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="v-contract-execution-result-description"><a href="#v-contract-execution-result-description" class="header-anchor">#</a> V. Contract execution result description</h2> <h3 id="_1-description-of-execution-results"><a href="#_1-description-of-execution-results" class="header-anchor">#</a> 1. Description of execution results</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;success&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//Contract execution is successful,</span>
    <span class="token property">&quot;errorMessage&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> <span class="token comment">//failure reason - string, eg. not enough gas,</span>
    <span class="token property">&quot;contractAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tNULSeBaN1rhd9k9eqNkvwC9HXBWLQ79dRuy81&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;multyForAddress: 888634777633&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;gasLimit&quot;</span><span class="token operator">:</span> <span class="token number">200000</span><span class="token punctuation">,</span>
    <span class="token property">&quot;gasUsed&quot;</span><span class="token operator">:</span> <span class="token number">20038</span><span class="token punctuation">,</span>
    <span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
    <span class="token property">&quot;totalFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5100000&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;txSizeFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;100000&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;actualContractFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;500950&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;refundFee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4499050&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">10000000000</span><span class="token punctuation">,</span> <span class="token comment">//The NULS that the contract caller transferred to the contract address, 0 if there is no such service.</span>
    <span class="token property">&quot;stackTrace&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> <span class="token comment">//failed exception stack information - string, execution failure does not necessarily have ,</span>
    <span class="token property">&quot;transfers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">//This refers to the transaction information of the contract address transferred out of the main network currency (NULS), which has nothing to do with the token, has nothing to do with the token, and has nothing to do with the token. Under normal circumstances, the contract transaction of the token transfer will not have such a transaction. The following is an example. </span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;txHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4877f6a865dea5b4ac82a8370d73e62da15bc7acb2145a03822dddfdab329d2b&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tNULSeBaN1rhd9k9eqNkvwC9HXBWLQ79dRuy81&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;200000000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;outputs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMp9wC9PcWEcfesY7YmWrPfeQzkN1xL&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;100000000&quot;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    <span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMshNPEnuqiDhMdSA4iNs6LMgjY6tcL&quot;</span><span class="token punctuation">,</span>
                    <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;100000000&quot;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;orginTxHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;b5473eefecd1c70ac4276f70062a92bdbfe8f779cbe48de2d0315686cc7e6789&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;events&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">//Event information sent within the contract - According to the token contract standard, a contract token transfer will send a corresponding event message called TransferEvent, which supports multiple token transfer within one contract call transaction.</span>
        <span class="token comment">//The event content structure returned is the json structure.</span>
        <span class="token string">&quot;{\&quot;contractAddress\&quot;:\&quot;TTb1LZLo6izPGmXa9dGPmb5D2vpLpNqA\&quot;,\&quot;blockNumber\&quot;:1343847,\&quot;event\&quot;:\&quot;TransferEvent\&quot;,\&quot;payload\&quot;:{\&quot;from\&quot;:\&quot;TTasNs8MGGGaFT9hd9DLmkammYYv69vs\&quot;,\&quot;to\&quot;:\&quot;TTau7kAxyhc4yMomVJ2QkMVECKKZK1uG\&quot;,\&quot;value\&quot;:\&quot;1000\&quot;}}&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;tokenTransfers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">//Data processing for the above token transfer event (TransferEvent), supplementing the basic information of the contract in which the token transfer occurred - name, symbol, decimals</span>
        <span class="token comment">//Note 1: The value here is the decimal value storage value after the conversion of the contract token value, with the Ethereum token method.</span>
        <span class="token comment">//Note 2: The contract address of the generated token transfer is not necessarily the contract currently called, so there is a contractAddress attribute in this data structure, which is not a redundant field.</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;contractAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TTb1LZLo6izPGmXa9dGPmb5D2vpLpNqA&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;from&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TTasNs8MGGGaFT9hd9DLmkammYYv69vs&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;to&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TTau7kAxyhc4yMomVJ2QkMVECKKZK1uG&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;symbol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;decimals&quot;</span><span class="token operator">:</span> <span class="token number">8</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;invokeRegisterCmds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">//Contract to create consensus, call external command record</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;cmdName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cs_createContractAgent&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;contractBalance&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2030000000000&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;commissionRate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;100&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;chainId&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">&quot;deposit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2000000000000&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;contractAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMzZedU4D3xym1JcyNa5sqtuFku8AKm&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;contractNonce&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0000000000000000&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;blockTime&quot;</span><span class="token operator">:</span> <span class="token number">1562564381</span><span class="token punctuation">,</span>
                <span class="token property">&quot;packingAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMtEPLXxUgyfnBt9bpb5Xv84dyJV98p&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;contractSender&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMvEtDfvZuukDf2mVyfGo3DdiN8KLRG&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;cmdRegisterMode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NEW_TX&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;newTxHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a8eae11b52990e39c9d3233ba1d2c8827336d261c0f14aca43dd4f06435dfaba&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;contractTxList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">//The transaction generated after the current execution of the smart contract</span>
        <span class="token string">&quot;12002fbb225d0037b5473eefecd1c70ac4276f70062a92bdbfe8f779cbe48de2d0315686cc7e678902000253472f4702eb83b71871a4c4e0c71526bb86b8afd0011702000253472f4702eb83b71871a4c4e0c71526bb86b8af0200010000c2eb0b0000000000000000000000000000000000000000000000000000000008000000000000000000021702000194f6239c075d184e265eaea97a67eeced51725160200010000e1f50500000000000000000000000000000000000000000000000000000000000000000000000017020001ce8ffa95606f0bfd2778cff2eff8fe8999e20c440200010000e1f50500000000000000000000000000000000000000000000000000000000000000000000000000&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;1400bf6b285d006600204aa9d1010000000000000000000000000000000000000000000000000000020002f246b18e8c697f00ed9bd22696998e469d3f824b020001d7424d91c83566eb94233b5416f2aa77709c03e1020002f246b18e8c697f00ed9bd22696998e469d3f824b648c0117020002f246b18e8c697f00ed9bd22696998e469d3f824b0200010000204aa9d1010000000000000000000000000000000000000000000000000000080000000000000000000117020002f246b18e8c697f00ed9bd22696998e469d3f824b0200010000204aa9d1010000000000000000000000000000000000000000000000000000ffffffffffffffff00&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;call&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="vi-triggering-the-scene-of-the-payable-method"><a href="#vi-triggering-the-scene-of-the-payable-method" class="header-anchor">#</a> VI. Triggering the scene of the payable method</h2> <p>In <code>vm-sdk</code>, there is such a description for <code>Contract#payable</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">io<span class="token punctuation">.</span>nuls<span class="token punctuation">.</span>contract<span class="token punctuation">.</span>sdk</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Contract interface, contract class implements this interface
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Contract</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * Directly transfer to the contract, this method will be triggered, the default is to do nothing, you can override this method.
     * Prerequisite: This method needs to be overloaded and marked with the `@Payable` annotation.
     */</span>
    <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">_payable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 1. This method is triggered when the consensus node reward address is the contract address. The parameter is the block reward address detail eg. [[address, amount], [address, amount], ...]
     * 2. This method is triggered when the delegate node address is a contract address. The parameter is the contract address and the bonus amount eg. [[address, amount]]
     * Prerequisite: This method needs to be overloaded and marked with the `@Payable` annotation.
     */</span>
    <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">_payable</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p><code>mm-sdk``maven</code> depends on the following</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.nuls.sdk<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sdk-contract-vm<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>LATEST<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_1-the-official-wallet-transfer-function-triggered-when-the-account-address-is-transferred-to-the-contract-address"><a href="#_1-the-official-wallet-transfer-function-triggered-when-the-account-address-is-transferred-to-the-contract-address" class="header-anchor">#</a> 1. the official wallet transfer function, triggered when the account address is transferred to the contract address</h3> <p>Trigger <code>payable()</code> no argument method</p> <p><strong>System underlying implementation principle:</strong></p> <p>Assembled into a call contract transaction, the default call to the contract's <code>_payable()</code> method</p> <h3 id="_2-the-consensus-node-reward-address-is-the-contract-address-triggered-when-the-current-node-is-out-of-the-block"><a href="#_2-the-consensus-node-reward-address-is-the-contract-address-triggered-when-the-current-node-is-out-of-the-block" class="header-anchor">#</a> 2. the consensus node reward address is the contract address, triggered when the current node is out of the block.</h3> <p>Trigger <code>_payable(String[][] args)</code> has a parameter method, the parameter is the current block <em><strong>all</strong></em> reward address details eg. [[address, amount], [address, amount], ...]</p> <p><strong>System underlying implementation principle:</strong></p> <p>When the consensus module determines that the reward address in the CoinBase transaction has a contract address, the <code>_payable(String[][] args)</code> method of the contract is invoked, and the corresponding revenue amount is transferred to the contract address.</p> <h3 id="_3-the-entrusted-address-is-the-contract-address-which-is-triggered-when-there-is-a-current-contract-address-in-the-block-reward"><a href="#_3-the-entrusted-address-is-the-contract-address-which-is-triggered-when-there-is-a-current-contract-address-in-the-block-reward" class="header-anchor">#</a> 3. The entrusted address is the contract address, which is triggered when there is a current contract address in the block reward.</h3> <p>Trigger <code>_payable(String[][] args)</code> has a parameter method, the parameter <em><strong>is and is only</strong></em> current contract address and bonus amount (only this one element) eg. [[address, amount]]</p> <p><strong>System underlying implementation principle:</strong></p> <p>When the consensus module determines that the reward address in the CoinBase transaction has a contract address, the <code>_payable(String[][] args)</code> method of the contract is invoked, and the corresponding revenue amount is transferred to the contract address.</p> <h3 id="_4-triggered-when-the-user-directly-calls-the-payable-method-of-the-contract"><a href="#_4-triggered-when-the-user-directly-calls-the-payable-method-of-the-contract" class="header-anchor">#</a> 4. Triggered when the user directly calls the <code>_payable()</code> method of the contract</h3> <h3 id="note-the-payable-string-args-method-is-a-system-call-method-that-the-user-cannot-call"><a href="#note-the-payable-string-args-method-is-a-system-call-method-that-the-user-cannot-call" class="header-anchor">#</a> Note: The <code>_payable(String[][] args)</code> method is a system call method that the user cannot call.</h3> <h2 id="vii-contract-call-external-command-description"><a href="#vii-contract-call-external-command-description" class="header-anchor">#</a> VII. Contract Call External Command Description</h2> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Utils</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * Commands that call other modules on the chain
     *
     * @param cmdName command name
     * @param args command parameter
     * @return command returns a value (depending on the return type of the registration command, it can return a string, a string array, a two-dimensional array of strings)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token class-name">Object</span> <span class="token function">invokeExternalCmd</span><span class="token punctuation">(</span><span class="token class-name">String</span> cmdName<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_1-the-function-of-generating-contract-consensus-transactions"><a href="#_1-the-function-of-generating-contract-consensus-transactions" class="header-anchor">#</a> 1. The function of generating contract consensus transactions</h3> <h4 id="_1-1-creating-a-consensus-node"><a href="#_1-1-creating-a-consensus-node" class="header-anchor">#</a> 1.1 Creating a consensus node</h4> <ul><li><p>Command name</p> <p><strong><code>cs_createContractAgent</code></strong></p></li> <li><p>Transaction Type</p> <p><strong>txType = <code>20</code></strong></p></li> <li><p>Method parameter specification</p> <blockquote><p>When the contract calls this method, the parameter types passed are <code>String</code> type</p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Contract Conversion <code>String</code> Logic</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">packingAddress</td> <td style="text-align:center">Package Address</td> <td style="text-align:center">String</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td> <td style="text-align:center">Slightly</td></tr> <tr><td style="text-align:center">deposit</td> <td style="text-align:center">Margin</td> <td style="text-align:center">String</td> <td style="text-align:center">BigInteger - toString</td> <td style="text-align:center">Slightly</td></tr> <tr><td style="text-align:center">commissionRate</td> <td style="text-align:center">Commission Ratio</td> <td style="text-align:center">String</td> <td style="text-align:center">Byte - toString</td> <td style="text-align:center">Range [10,100]</td></tr></tbody></table></li> <li><p>Return value description</p> <blockquote><p>Return value type is <strong><code>String</code></strong> string type</p></blockquote> <table><thead><tr><th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">transaction hash</td> <td style="text-align:center">slightly</td></tr></tbody></table></li> <li><p>example</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// String packingAddress, BigInteger depositNa, String commissionRate</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>packingAddress<span class="token punctuation">,</span> depositNa<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> commissionRate<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> txHash <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">invokeExternalCmd</span><span class="token punctuation">(</span><span class="token string">&quot;cs_createContractAgent&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>        
</code></pre></div></li></ul> <h4 id="_1-2-contract-delegation-consensus-node"><a href="#_1-2-contract-delegation-consensus-node" class="header-anchor">#</a> 1.2 Contract delegation consensus node</h4> <ul><li><p>Command name</p> <p><strong><code>cs_contractDeposit</code></strong></p></li> <li><p>Transaction Type</p> <p><strong>txType = <code>21</code></strong></p></li> <li><p>Method parameter specification</p> <blockquote><p>When the contract calls this method, the parameter types passed are <code>String</code> type</p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Contract Conversion <code>String</code> Logic</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">agentHash</td> <td style="text-align:center">Create contract consensus node transaction hash</td> <td style="text-align:center">String</td> <td style="text-align:center">略</td> <td style="text-align:center">略</td></tr> <tr><td style="text-align:center">deposit</td> <td style="text-align:center">trust amount</td> <td style="text-align:center">String</td> <td style="text-align:center">BigInteger - toString</td> <td style="text-align:center">略</td></tr></tbody></table></li> <li><p>Return value description</p> <blockquote><p>Return value type is <strong><code>String</code></strong> string type</p></blockquote> <table><thead><tr><th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">transaction hash</td> <td style="text-align:center">slightly</td></tr></tbody></table></li> <li><p>example</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// String agentHash, BigInteger depositNa</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>agentHash<span class="token punctuation">,</span> depositNa<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> txHash <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">invokeExternalCmd</span><span class="token punctuation">(</span><span class="token string">&quot;cs_contractDeposit&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>       
</code></pre></div></li></ul> <h4 id="_1-3-contract-exit-consensus-node"><a href="#_1-3-contract-exit-consensus-node" class="header-anchor">#</a> 1.3 Contract Exit Consensus Node</h4> <ul><li><p>Command name</p> <p><strong><code>cs_contractWithdraw</code></strong></p></li> <li><p>Transaction Type</p> <p><strong>txType = <code>22</code></strong></p></li> <li><p>Method parameter specification</p> <blockquote><p>When the contract calls this method, the parameter types passed are <code>String</code> type</p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Contract Conversion <code>String</code> Logic</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">joinAgentHash</td> <td style="text-align:center">Trading when joining consensus = hash</td> <td style="text-align:center">slightly</td> <td style="text-align:center">slightly</td> <td style="text-align:center"></td></tr></tbody></table></li> <li><p>Return value description</p> <blockquote><p>Return value type is <strong><code>String</code></strong> string type</p></blockquote> <table><thead><tr><th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">transaction hash</td> <td style="text-align:center">slightly</td></tr></tbody></table></li> <li><p>example</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// String joinAgentHash</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>joinAgentHash<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> txHash <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">invokeExternalCmd</span><span class="token punctuation">(</span><span class="token string">&quot;cs_contractWithdraw&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>       
</code></pre></div></li></ul> <h4 id="_1-4-contract-cancellation-consensus-node"><a href="#_1-4-contract-cancellation-consensus-node" class="header-anchor">#</a> 1.4 Contract cancellation consensus node</h4> <ul><li><p>Command name</p> <p><strong><code>cs_stopContractAgent</code></strong></p></li> <li><p>Transaction Type</p> <p><strong>txType = <code>23</code></strong></p></li> <li><p>Method parameter specification</p> <blockquote><p>When the contract calls this method, the parameter types passed are <code>String</code> type</p></blockquote> <p>No parameters</p></li> <li><p>Return value description</p> <blockquote><p>Return value type is <strong><code>String</code></strong> string type</p></blockquote> <table><thead><tr><th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">transaction hash</td> <td style="text-align:center">slightly</td></tr></tbody></table></li> <li><p>example</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> txHash <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">invokeExternalCmd</span><span class="token punctuation">(</span><span class="token string">&quot;cs_stopContractAgent&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      
</code></pre></div></li></ul> <h3 id="_2-query-consensus-data"><a href="#_2-query-consensus-data" class="header-anchor">#</a> 2. Query consensus data</h3> <h4 id="_2-1-according-to-join-the-consensus-transaction-hash-query-delegate-consensus-information"><a href="#_2-1-according-to-join-the-consensus-transaction-hash-query-delegate-consensus-information" class="header-anchor">#</a> 2.1 According to <em><code>join the consensus transaction hash</code></em> query delegate consensus information</h4> <ul><li><p>Command name</p> <p><strong><code>cs_getContractDepositInfo</code></strong></p></li> <li><p>Method parameter specification</p> <blockquote><p>When the contract calls this method, the parameter types passed are <code>String</code> type</p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Contract Conversion <code>String</code> Logic</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">joinAgentHash</td> <td style="text-align:center">Trading when joining consensus = hash</td> <td style="text-align:center">slightly</td> <td style="text-align:center">slightly</td> <td style="text-align:center"></td></tr></tbody></table></li> <li><p>Return value description</p> <blockquote><p>Return value type is <strong><code>String[]</code></strong> string array type</p></blockquote> <table><thead><tr><th style="text-align:center">index</th> <th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">0</td> <td style="text-align:center">agentHash</td> <td style="text-align:center">Slightly</td></tr> <tr><td style="text-align:center">1</td> <td style="text-align:center">agentAddress</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td></tr> <tr><td style="text-align:center">2</td> <td style="text-align:center">joinAddress</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td></tr> <tr><td style="text-align:center">3</td> <td style="text-align:center">deposit</td> <td style="text-align:center">BigInteger - toString</td></tr> <tr><td style="text-align:center">4</td> <td style="text-align:center">time</td> <td style="text-align:center">Long - toString</td></tr> <tr><td style="text-align:center">5</td> <td style="text-align:center">blockHeight</td> <td style="text-align:center">Long - toString</td></tr> <tr><td style="text-align:center">6</td> <td style="text-align:center">delHeight</td> <td style="text-align:center">Long - toString</td></tr> <tr><td style="text-align:center">7</td> <td style="text-align:center">status(0-to-consult 1 - consensus)</td> <td style="text-align:center">Integer - toString</td></tr></tbody></table></li> <li><p>example</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// String joinAgentHash</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>joinAgentHash<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> contractDepositInfo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">invokeExternalCmd</span><span class="token punctuation">(</span><span class="token string">&quot;cs_getContractDepositInfo&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token comment">// Commission amount</span>
<span class="token class-name">BigInteger</span> deposit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span>contractDepositInfo<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 0 - to be consensus 1 - consensus</span>
<span class="token class-name">String</span> status <span class="token operator">=</span> contractDepositInfo<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     
</code></pre></div></li></ul> <h4 id="_2-2-creating-a-node-s-transaction-hash-query-node-information-according-to"><a href="#_2-2-creating-a-node-s-transaction-hash-query-node-information-according-to" class="header-anchor">#</a> 2.2 Creating a node's transaction hash<code>_ query node information according to _</code></h4> <ul><li><p>Command name</p> <p><strong><code>cs_getContractAgentInfo</code></strong></p></li> <li><p>Method parameter specification</p> <blockquote><p>When the contract calls this method, the parameter types passed are <code>String</code> type</p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Contract Conversion <code>String</code> Logic</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">agentHash</td> <td style="text-align:center">Create contract consensus node transaction hash</td> <td style="text-align:center">String</td> <td style="text-align:center">略</td> <td style="text-align:center">略</td></tr></tbody></table></li> <li><p>Return value description</p> <blockquote><p>Return value type is <strong><code>String[]</code></strong> string array type</p></blockquote> <table><thead><tr><th style="text-align:center">index</th> <th style="text-align:center">Description</th> <th style="text-align:center">Chinese description</th> <th style="text-align:center">String conversion logic</th></tr></thead> <tbody><tr><td style="text-align:center">0</td> <td style="text-align:center">agentAddress</td> <td style="text-align:center">Create node address</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td></tr> <tr><td style="text-align:center">1</td> <td style="text-align:center">packingAddress</td> <td style="text-align:center">Package Address</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td></tr> <tr><td style="text-align:center">2</td> <td style="text-align:center">rewardAddress</td> <td style="text-align:center">Reward Address</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td></tr> <tr><td style="text-align:center">3</td> <td style="text-align:center">deposit</td> <td style="text-align:center">Margin</td> <td style="text-align:center">BigInteger - toString</td></tr> <tr><td style="text-align:center">4</td> <td style="text-align:center">totalDeposit</td> <td style="text-align:center">Total Delegate Amount</td> <td style="text-align:center">BigInteger - toString</td></tr> <tr><td style="text-align:center">5</td> <td style="text-align:center">commissionRate</td> <td style="text-align:center">Commission Ratio</td> <td style="text-align:center">Integer - toString</td></tr> <tr><td style="text-align:center">6</td> <td style="text-align:center">time</td> <td style="text-align:center">Create Node Time</td> <td style="text-align:center">Long - toString</td></tr> <tr><td style="text-align:center">7</td> <td style="text-align:center">blockHeight</td> <td style="text-align:center">Create node height</td> <td style="text-align:center">Long - toString</td></tr> <tr><td style="text-align:center">8</td> <td style="text-align:center">delHeight</td> <td style="text-align:center">The height of the logout node</td> <td style="text-align:center">Long - toString</td></tr> <tr><td style="text-align:center">9</td> <td style="text-align:center">status</td> <td style="text-align:center">Status (0 - Consensus 1 - Consensus)</td> <td style="text-align:center">Integer - toString</td></tr></tbody></table></li> <li><p>example</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// String agentHash</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>agentHash<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> contractAgentInfo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token class-name">Utils</span><span class="token punctuation">.</span><span class="token function">invokeExternalCmd</span><span class="token punctuation">(</span><span class="token string">&quot;cs_getContractAgentInfo&quot;</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token comment">// The contract node has commissioned the amount</span>
<span class="token class-name">BigInteger</span> totalDepositOfContractAgent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span>contractAgentInfo<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 0 - to be consensus 1 - consensus</span>
<span class="token class-name">String</span> statusOfContractAgent <span class="token operator">=</span> contractAgentInfo<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     
</code></pre></div></li></ul> <h2 id="viii-contract-consensus-transaction-description"><a href="#viii-contract-consensus-transaction-description" class="header-anchor">#</a> VIII. Contract Consensus Transaction Description</h2> <p>The Consensus Module provides four contract-related consensus transactions. When the module starts, it registers with the contract module to create four contract consensus transactions, so that the contract module can be called, so that it can create and cancel the consensus node, delegate and cancel the delegation consensus. node</p> <h3 id="_1-generate-contract-consensus-transactions"><a href="#_1-generate-contract-consensus-transactions" class="header-anchor">#</a> 1. Generate contract consensus transactions</h3> <h4 id="_1-1-creating-a-consensus-node-2"><a href="#_1-1-creating-a-consensus-node-2" class="header-anchor">#</a> 1.1 Creating a consensus node</h4> <ul><li><p>Original parameter list</p> <blockquote><p><strong><code>Create consensus node address</code>, <code>consensus reward address</code> fixed to <code>current contract address</code></strong></p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Optional</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">packingAddress</td> <td style="text-align:center">package address</td> <td style="text-align:center">byte[]</td> <td style="text-align:center">y</td> <td style="text-align:center">method call required</td></tr> <tr><td style="text-align:center">deposit</td> <td style="text-align:center">margin</td> <td style="text-align:center">BigInteger</td> <td style="text-align:center">yes</td> <td style="text-align:center">method call required</td></tr> <tr><td style="text-align:center">commissionRate</td> <td style="text-align:center">commission ratio</td> <td style="text-align:center">byte</td> <td style="text-align:center">yes</td> <td style="text-align:center">method call required - range [10,100]</td></tr> <tr><td style="text-align:center">agentAddress</td> <td style="text-align:center">Create Node Address</td> <td style="text-align:center">byte[]</td> <td style="text-align:center"><strong>No</strong></td> <td style="text-align:center">The underlying default is <strong><code>current contract address</code></strong></td></tr> <tr><td style="text-align:center">rewardAddress</td> <td style="text-align:center">Reward Address</td> <td style="text-align:center">byte[]</td> <td style="text-align:center"><strong>No</strong></td> <td style="text-align:center">The underlying default is <strong><code>current contract address</code></strong></td></tr></tbody></table></li> <li><p>registration message</p> <blockquote><p><strong>Consensus module registration command information for the contract consensus node registered with the smart contract module</strong></p></blockquote> <table><thead><tr><th style="text-align:center">Module Code</th> <th style="text-align:center">cmd Name</th> <th style="text-align:center">Registration Type</th> <th style="text-align:center">Parameter Name List</th> <th style="text-align:center">Return Value Type</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">consensus</td> <td style="text-align:center">cs_createContractAgent</td> <td style="text-align:center">0(NEW_TX)</td> <td style="text-align:center">List.of(&quot;packingAddress&quot;,&quot;deposit&quot;,&quot;commissionRate&quot;)</td> <td style="text-align:center">1(STRING_ARRAY)</td> <td style="text-align:center">Create Consensus Node</td></tr></tbody></table></li> <li><p>Transaction Type</p> <p><strong>txType = <code>20</code></strong></p></li> <li><p>Method parameter specification</p> <blockquote><p>When the contract calls this method, the parameter types passed are <code>String</code> type</p> <p>When calling this method, the consensus module will receive the following parameters for this command</p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Contract Conversion <code>String</code> Logic</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">packingAddress</td> <td style="text-align:center">Package Address</td> <td style="text-align:center">String</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td> <td style="text-align:center">Slightly</td></tr> <tr><td style="text-align:center">deposit</td> <td style="text-align:center">Margin</td> <td style="text-align:center">String</td> <td style="text-align:center">BigInteger - toString</td> <td style="text-align:center">Slightly</td></tr> <tr><td style="text-align:center">commissionRate</td> <td style="text-align:center">Commission Ratio</td> <td style="text-align:center">String</td> <td style="text-align:center">Byte - toString</td> <td style="text-align:center">Range [10,100]</td></tr> <tr><td style="text-align:center">chainId</td> <td style="text-align:center">current chain ID</td> <td style="text-align:center">int</td> <td style="text-align:center">-</td> <td style="text-align:center">lower layer provides parameters</td></tr> <tr><td style="text-align:center">contractAddress</td> <td style="text-align:center">Contract Address</td> <td style="text-align:center">String</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td> <td style="text-align:center">The underlying provides parameters</td></tr> <tr><td style="text-align:center">contractSender</td> <td style="text-align:center">Contract caller address</td> <td style="text-align:center">String</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td> <td style="text-align:center">The underlying provides parameters</td></tr> <tr><td style="text-align:center">contractBalance</td> <td style="text-align:center">Current balance of contract address</td> <td style="text-align:center">String</td> <td style="text-align:center">BigInteger -toString</td> <td style="text-align:center">Bottom providing parameters - use this value to check balance when generating transactions</td></tr> <tr><td style="text-align:center">contractNonce</td> <td style="text-align:center">The current nonce value of the contract address</td> <td style="text-align:center">String</td> <td style="text-align:center">RPCUtil.encode(byte[])</td> <td style="text-align:center">The underlying provides the parameters - use this nonce to assemble the transaction when generating the transaction</td></tr> <tr><td style="text-align:center">blockTime</td> <td style="text-align:center">currently packaged block time</td> <td style="text-align:center">long</td> <td style="text-align:center">-</td> <td style="text-align:center">lower layer provides parameters - use this as transaction time when generating transactions</td></tr></tbody></table></li> <li><p>Return value description</p> <ul><li><p>The smart contract virtual machine receives the <strong><code>String[]</code></strong> string array type</p> <table><thead><tr><th style="text-align:center">index</th> <th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">0</td> <td style="text-align:center">Trading hash</td> <td style="text-align:center">Slightly</td></tr> <tr><td style="text-align:center">1</td> <td style="text-align:center">Transaction Serialization String</td> <td style="text-align:center">RPCUtil.encode(byte[])</td></tr></tbody></table></li> <li><p>The caller receives a <strong><code>String</code></strong> string type</p> <table><thead><tr><th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">transaction hash</td> <td style="text-align:center">slightly</td></tr></tbody></table></li></ul></li></ul> <h4 id="_1-2-contract-delegation-consensus-node-2"><a href="#_1-2-contract-delegation-consensus-node-2" class="header-anchor">#</a> 1.2 Contract delegation consensus node</h4> <ul><li><p>original parameters</p> <blockquote><p><strong><code>Delegation Address</code> is fixed to <code>current contract address</code></strong></p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Optional</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">agentHash</td> <td style="text-align:center">Create contract consensus node transaction hash</td> <td style="text-align:center">String</td> <td style="text-align:center">Yes</td> <td style="text-align:center">Method call required</td></tr> <tr><td style="text-align:center">deposit</td> <td style="text-align:center">dealer amount</td> <td style="text-align:center">BigInteger</td> <td style="text-align:center">yes</td> <td style="text-align:center">method call required</td></tr> <tr><td style="text-align:center">address</td> <td style="text-align:center">trust address</td> <td style="text-align:center">byte[]</td> <td style="text-align:center"><strong>no</strong></td> <td style="text-align:center">The underlying default is <strong><code>current contract address</code></strong></td></tr></tbody></table></li> <li><p>registration message</p> <blockquote><p><strong>Consensus module registration command information for the contract creation consensus node registered with the smart contract module</strong></p></blockquote> <table><thead><tr><th style="text-align:center">Module Code</th> <th style="text-align:center">cmd Name</th> <th style="text-align:center">Registration Type</th> <th style="text-align:center">Parameter Name List</th> <th style="text-align:center">Return Value Type</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">consensus</td> <td style="text-align:center">cs_contractDeposit</td> <td style="text-align:center">0(NEW_TX)</td> <td style="text-align:center">List.of(&quot;agentHash&quot;,&quot;deposit&quot;)</td> <td style="text-align:center">1(STRING_ARRAY)</td> <td style="text-align:center">Delegate Consensus Node</td></tr></tbody></table></li> <li><p>Transaction Type</p> <p><strong>txType = <code>21</code></strong></p></li> <li><p>Method parameter specification</p> <blockquote><p>When the contract calls this method, the parameter types passed are <code>String</code> type</p> <p>When calling this method, the consensus module will receive the following parameters for this command</p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Contract Conversion <code>String</code> Logic</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">agentHash</td> <td style="text-align:center">Create contract consensus node transaction hash</td> <td style="text-align:center">String</td> <td style="text-align:center">略</td> <td style="text-align:center">略</td></tr> <tr><td style="text-align:center">deposit</td> <td style="text-align:center">trust amount</td> <td style="text-align:center">String</td> <td style="text-align:center">BigInteger - toString</td> <td style="text-align:center">略</td></tr> <tr><td style="text-align:center">chainId</td> <td style="text-align:center">current chain ID</td> <td style="text-align:center">int</td> <td style="text-align:center">-</td> <td style="text-align:center">lower layer provides parameters</td></tr> <tr><td style="text-align:center">contractAddress</td> <td style="text-align:center">Contract Address</td> <td style="text-align:center">String</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td> <td style="text-align:center">The underlying provides parameters</td></tr> <tr><td style="text-align:center">contractSender</td> <td style="text-align:center">Contract caller address</td> <td style="text-align:center">String</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td> <td style="text-align:center">The underlying provides parameters</td></tr> <tr><td style="text-align:center">contractBalance</td> <td style="text-align:center">Current balance of contract address</td> <td style="text-align:center">String</td> <td style="text-align:center">BigInteger - toString</td> <td style="text-align:center">Bottom providing parameters - use this value to check balance when generating transactions</td></tr> <tr><td style="text-align:center">contractNonce</td> <td style="text-align:center">The current nonce value of the contract address</td> <td style="text-align:center">String</td> <td style="text-align:center">RPCUtil.encode(byte[])</td> <td style="text-align:center">The underlying provides the parameters - use this nonce to assemble the transaction when generating the transaction</td></tr> <tr><td style="text-align:center">blockTime</td> <td style="text-align:center">currently packaged block time</td> <td style="text-align:center">long</td> <td style="text-align:center">-</td> <td style="text-align:center">lower layer provides parameters - use this as transaction time when generating transactions</td></tr></tbody></table></li> <li><p>Return value description</p> <ul><li><p>The smart contract virtual machine receives the <strong><code>String[]</code></strong> string array type</p> <table><thead><tr><th style="text-align:center">index</th> <th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">0</td> <td style="text-align:center">Trading hash</td> <td style="text-align:center">Slightly</td></tr> <tr><td style="text-align:center">1</td> <td style="text-align:center">Transaction Serialization String</td> <td style="text-align:center">RPCUtil.encode(byte[])</td></tr></tbody></table></li> <li><p>The caller receives a <strong><code>String</code></strong> string type</p> <table><thead><tr><th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">transaction hash</td> <td style="text-align:center">slightly</td></tr></tbody></table></li></ul></li></ul> <h4 id="_1-3-contract-exit-consensus-node-2"><a href="#_1-3-contract-exit-consensus-node-2" class="header-anchor">#</a> 1.3 Contract Exit Consensus Node</h4> <ul><li><p>original parameters</p> <blockquote><p><strong><code>Create node's address</code> is fixed to <code>current contract address</code></strong></p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Optional</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">joinAgentHash</td> <td style="text-align:center">Transaction hash when joining consensus</td> <td style="text-align:center">String</td> <td style="text-align:center">Yes</td> <td style="text-align:center">Method call required</td></tr> <tr><td style="text-align:center">agentAddress</td> <td style="text-align:center">Create node address</td> <td style="text-align:center">byte[]</td> <td style="text-align:center"><strong>No</strong></td> <td style="text-align:center">The underlying default is <strong><code>current contract address</code></strong></td></tr></tbody></table></li> <li><p>registration message</p> <blockquote><p><strong>Consensus module registration contract information registered with the smart contract module to exit the consensus node</strong></p></blockquote> <table><thead><tr><th style="text-align:center">Module Code</th> <th style="text-align:center">cmd Name</th> <th style="text-align:center">Registration Type</th> <th style="text-align:center">Parameter Name List</th> <th style="text-align:center">Return Value Type</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">consensus</td> <td style="text-align:center">cs_contractWithdraw</td> <td style="text-align:center">0(NEW_TX)</td> <td style="text-align:center">List.of(&quot;joinAgentHash&quot;)</td> <td style="text-align:center">1(STRING_ARRAY)</td> <td style="text-align:center">Exit the delegate consensus node</td></tr></tbody></table></li> <li><p>Transaction Type</p> <p><strong>txType = <code>22</code></strong></p></li> <li><p>Method parameter specification</p> <blockquote><p>When the contract calls this method, the parameter types passed are <code>String</code> type</p> <p>When calling this method, the consensus module will receive the following parameters for this command</p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Contract Conversion <code>String</code> Logic</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">joinAgentHash</td> <td style="text-align:center">Trading when joining consensus = hash</td> <td style="text-align:center">slightly</td> <td style="text-align:center">slightly</td> <td style="text-align:center"></td></tr> <tr><td style="text-align:center">chainId</td> <td style="text-align:center">current chain ID</td> <td style="text-align:center">int</td> <td style="text-align:center">-</td> <td style="text-align:center">lower layer provides parameters</td></tr> <tr><td style="text-align:center">contractAddress</td> <td style="text-align:center">Contract Address</td> <td style="text-align:center">String</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td> <td style="text-align:center">The underlying provides parameters</td></tr> <tr><td style="text-align:center">contractSender</td> <td style="text-align:center">Contract caller address</td> <td style="text-align:center">String</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td> <td style="text-align:center">The underlying provides parameters</td></tr> <tr><td style="text-align:center">blockTime</td> <td style="text-align:center">currently packaged block time</td> <td style="text-align:center">long</td> <td style="text-align:center">-</td> <td style="text-align:center">lower layer provides parameters - use this as transaction time when generating transactions</td></tr></tbody></table></li> <li><p>Return value description</p> <ul><li><p>The smart contract virtual machine receives the <strong><code>String[]</code></strong> string array type</p> <table><thead><tr><th style="text-align:center">index</th> <th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">0</td> <td style="text-align:center">Trading hash</td> <td style="text-align:center">Slightly</td></tr> <tr><td style="text-align:center">1</td> <td style="text-align:center">Transaction Serialization String</td> <td style="text-align:center">RPCUtil.encode(byte[])</td></tr></tbody></table></li> <li><p>The caller receives a <strong><code>String</code></strong> string type</p> <table><thead><tr><th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">transaction hash</td> <td style="text-align:center">slightly</td></tr></tbody></table></li></ul></li></ul> <h4 id="_1-4-contract-cancellation-consensus-node-2"><a href="#_1-4-contract-cancellation-consensus-node-2" class="header-anchor">#</a> 1.4 Contract cancellation consensus node</h4> <ul><li><p>original parameters</p> <blockquote><p><strong><code>Create node's address</code> is fixed to <code>current contract address</code></strong></p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Optional</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">agentAddress</td> <td style="text-align:center">Create node address</td> <td style="text-align:center">byte[]</td> <td style="text-align:center"><strong>No</strong></td> <td style="text-align:center">The underlying default is <strong><code>current contract address</code></strong></td></tr></tbody></table></li> <li><p>registration message</p> <blockquote><p><strong>Consultation module registration contract cancellation agreement node transaction command information registered with the smart contract module</strong></p></blockquote> <table><thead><tr><th style="text-align:center">Module Code</th> <th style="text-align:center">cmd Name</th> <th style="text-align:center">Registration Type</th> <th style="text-align:center">Parameter Name List</th> <th style="text-align:center">Return Value Type</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">consensus</td> <td style="text-align:center">cs_stopContractAgent</td> <td style="text-align:center">0(NEW_TX)</td> <td style="text-align:center"><code>empty list</code></td> <td style="text-align:center">1(STRING_ARRAY)</td> <td style="text-align:center">Logout Consensus Node</td></tr></tbody></table></li> <li><p>Transaction Type</p> <p><strong>txType = <code>23</code></strong></p></li> <li><p>Method parameter specification</p> <blockquote><p>When the contract calls this method, the parameter types passed are <code>String</code> type</p> <p>When calling this method, the consensus module will receive the following parameters for this command</p></blockquote> <table><thead><tr><th style="text-align:center">Name</th> <th style="text-align:center">Description</th> <th style="text-align:center">Type</th> <th style="text-align:center">Contract Conversion <code>String</code> Logic</th> <th style="text-align:center">Remarks</th></tr></thead> <tbody><tr><td style="text-align:center">chainId</td> <td style="text-align:center">current chain ID</td> <td style="text-align:center">int</td> <td style="text-align:center">-</td> <td style="text-align:center">lower layer provides parameters</td></tr> <tr><td style="text-align:center">contractAddress</td> <td style="text-align:center">Contract Address</td> <td style="text-align:center">String</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td> <td style="text-align:center">The underlying provides parameters</td></tr> <tr><td style="text-align:center">contractSender</td> <td style="text-align:center">Contract caller address</td> <td style="text-align:center">String</td> <td style="text-align:center">AddressTool.getStringAddressByBytes(byte[])</td> <td style="text-align:center">The underlying provides parameters</td></tr> <tr><td style="text-align:center">blockTime</td> <td style="text-align:center">currently packaged block time</td> <td style="text-align:center">long</td> <td style="text-align:center">-</td> <td style="text-align:center">lower layer provides parameters - use this as transaction time when generating transactions</td></tr></tbody></table></li> <li><p>Return value description</p> <ul><li><p>The smart contract virtual machine receives the <strong><code>String[]</code></strong> string array type</p> <table><thead><tr><th style="text-align:center">index</th> <th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">0</td> <td style="text-align:center">Trading hash</td> <td style="text-align:center">Slightly</td></tr> <tr><td style="text-align:center">1</td> <td style="text-align:center">Transaction Serialization String</td> <td style="text-align:center">RPCUtil.encode(byte[])</td></tr></tbody></table></li> <li><p>The caller receives a <strong><code>String</code></strong> string type</p> <table><thead><tr><th style="text-align:center">Description</th> <th style="text-align:center">String Conversion Logic</th></tr></thead> <tbody><tr><td style="text-align:center">transaction hash</td> <td style="text-align:center">slightly</td></tr></tbody></table></li></ul></li></ul> <h3 id="_2-how-to-obtain-contract-consensus-transaction-data"><a href="#_2-how-to-obtain-contract-consensus-transaction-data" class="header-anchor">#</a> 2. How to obtain contract consensus transaction data</h3> <p>Contract consensus transactions are not signed, and such transactions are generated when each node verifies the block. In addition, such transactions are not in the scope of broadcast data, and need to be retrieved from another interface. Please refer to the following interface for detailed data** To get the _serialized string_data of the transaction.</p> <p>The following is the result of the execution of the contract internal transfer transaction.</p> <blockquote><p>via <code>RESTFUL</code> interface<code>/api/contract/result/{hash}</code></p> <p>or</p> <p>Request data via <code>JSONRPC</code> interface <code>getContractTxResult</code>:</p></blockquote> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
<span class="token property">&quot;jsonrpc&quot;</span><span class="token operator">:</span><span class="token string">&quot;2.0&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;method&quot;</span><span class="token operator">:</span><span class="token string">&quot;getContractTxResult&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>chainId<span class="token punctuation">,</span> hash<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token number">1234</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Get the execution result of the contract</p></blockquote> <p>In the following results, <code>contractTxList</code> is the transaction generated after the execution of this contract. Note: This structure is not limited to contract consensus transactions, and different contract internal transactions will be generated according to different business, such as contract NULS asset transfer transaction-- &gt; <a href="/Docs/assetsOff.html">Smart Contract NULS Asset Transfer Transaction Instructions</a></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;success&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;flag&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;success&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">&quot;errorMessage&quot;</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">&quot;contractAddress&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;tNULSeBaNBdmatSnyhbgwm2gdkJHzKtpR2nGbQ&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;result&quot;</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">&quot;gasLimit&quot;</span> <span class="token operator">:</span> <span class="token number">200000</span><span class="token punctuation">,</span>
            <span class="token property">&quot;gasUsed&quot;</span> <span class="token operator">:</span> <span class="token number">13766</span><span class="token punctuation">,</span>
            <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
            <span class="token property">&quot;totalFee&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;5100000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;txSizeFee&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;100000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;actualContractFee&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;344150&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;refundFee&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;4655850&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2000000000000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;stackTrace&quot;</span> <span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">&quot;transfers&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;events&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;tokenTransfers&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;invokeRegisterCmds&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;cmdName&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;cs_createContractAgent&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;args&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;contractBalance&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2000000000000&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;commissionRate&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;100&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;chainId&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token property">&quot;deposit&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2000000000000&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;contractAddress&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;tNULSeBaNBdmatSnyhbgwm2gdkJHzKtpR2nGbQ&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;contractNonce&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;0000000000000000&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;blockTime&quot;</span> <span class="token operator">:</span> <span class="token number">1562930111</span><span class="token punctuation">,</span>
                <span class="token property">&quot;packingAddress&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMtEPLXxUgyfnBt9bpb5Xv84dyJV98p&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;contractSender&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;tNULSeBaMvEtDfvZuukDf2mVyfGo3DdiN8KLRG&quot;</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token property">&quot;cmdRegisterMode&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;NEW_TX&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;newTxHash&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;6278df86951ef140b98a57a27ff764453ae437d8aea2888ded886eb70ee11348&quot;</span>
            <span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;contractTxList&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> 
            <span class="token string">&quot;1400bf6b285d006600204aa9d1010000000000000000000000000000000000000000000000000000020002f246b18e8c697f00ed9bd22696998e469d3f824b020001d7424d91c83566eb94233b5416f2aa77709c03e1020002f246b18e8c697f00ed9bd22696998e469d3f824b648c0117020002f246b18e8c697f00ed9bd22696998e469d3f824b0200010000204aa9d1010000000000000000000000000000000000000000000000000000080000000000000000000117020002f246b18e8c697f00ed9bd22696998e469d3f824b0200010000204aa9d1010000000000000000000000000000000000000000000000000000ffffffffffffffff00&quot;</span> 
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;remark&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;call&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/nuls-io/devsite/edit/master/docs/Docs/s_advance.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">8/1/2022, 4:43:14 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Docs/s_offline_assembly.html" class="prev">
          Smart contract offline assembly
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.2df9194a.js" defer></script><script src="/assets/js/43.46a6c6ec.js" defer></script>
  </body>
</html>
